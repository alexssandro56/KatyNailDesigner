(()=>{var exports={};exports.id=931,exports.ids=[931],exports.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},49114:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>a.a,__next_app__:()=>h,originalPathname:()=>d,pages:()=>c,routeModule:()=>f,tree:()=>u}),n(90908),n(11506),n(35866);var r=n(23191),i=n(88716),s=n(37922),a=n.n(s),o=n(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);n.d(t,l);let u=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,90908)),"C:\\Users\\04jee\\meu-salao-de-beleza\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(n.bind(n,11506)),"C:\\Users\\04jee\\meu-salao-de-beleza\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\04jee\\meu-salao-de-beleza\\app\\page.tsx"],d="/page",h={require:n,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},97316:()=>{},51868:(e,t,n)=>{Promise.resolve().then(n.bind(n,37908))},31119:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,12994,23)),Promise.resolve().then(n.t.bind(n,96114,23)),Promise.resolve().then(n.t.bind(n,9727,23)),Promise.resolve().then(n.t.bind(n,79671,23)),Promise.resolve().then(n.t.bind(n,41868,23)),Promise.resolve().then(n.t.bind(n,84759,23))},37908:(e,t,n)=>{"use strict";let r,i,s;n.r(t),n.d(t,{default:()=>_R});var a,o,l,u,c,d,h,f,p=n(10326),m=n(17577),g=n.t(m,2),y=n(62881);let v=(0,y.Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),b=(0,y.Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var w=n(90772),S=n(33071),T=n(77863);let C=m.forwardRef(({className:e,type:t,...n},r)=>p.jsx("input",{type:t,className:(0,T.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));C.displayName="Input";var E=n(60962),x=n(34214),_=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let n=m.forwardRef((e,n)=>{let{asChild:r,...i}=e,s=r?x.g7:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,p.jsx)(s,{...i,ref:n})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function I(e,t){e&&E.flushSync(()=>e.dispatchEvent(t))}var k="Label",D=m.forwardRef((e,t)=>(0,p.jsx)(_.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));D.displayName=k;var R=D;let N=(0,n(79360).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),A=m.forwardRef(({className:e,...t},n)=>p.jsx(R,{ref:n,className:(0,T.cn)(N(),e),...t}));function O(e,[t,n]){return Math.min(n,Math.max(t,e))}function M(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e?.(r),!1===n||!r.defaultPrevented)return t?.(r)}}function P(e,t=[]){let n=[];function r(t,r){let i=m.createContext(r),s=n.length;n=[...n,r];let a=t=>{let{scope:n,children:r,...a}=t,o=n?.[e]?.[s]||i,l=m.useMemo(()=>a,Object.values(a));return(0,p.jsx)(o.Provider,{value:l,children:r})};return a.displayName=t+"Provider",[a,function(n,a){let o=a?.[e]?.[s]||i,l=m.useContext(o);if(l)return l;if(void 0!==r)return r;throw Error(`\`${n}\` must be used within \`${t}\``)}]}let i=()=>{let t=n.map(e=>m.createContext(e));return function(n){let r=n?.[e]||t;return m.useMemo(()=>({[`__scope${e}`]:{...n,[e]:r}}),[n,r])}};return i.scopeName=e,[r,L(i,...t)]}function L(...e){let t=e[0];if(1===e.length)return t;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=n.reduce((t,{useScope:n,scopeName:r})=>{let i=n(e)[`__scope${r}`];return{...t,...i}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return n.scopeName=t.scopeName,n}A.displayName=R.displayName;var B=n(48051);function F(e){let t=e+"CollectionProvider",[n,r]=P(t),[i,s]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=e=>{let{scope:t,children:n}=e,r=m.useRef(null),s=m.useRef(new Map).current;return(0,p.jsx)(i,{scope:t,itemMap:s,collectionRef:r,children:n})};a.displayName=t;let o=e+"CollectionSlot",l=m.forwardRef((e,t)=>{let{scope:n,children:r}=e,i=s(o,n),a=(0,B.e)(t,i.collectionRef);return(0,p.jsx)(x.g7,{ref:a,children:r})});l.displayName=o;let u=e+"CollectionItemSlot",c="data-radix-collection-item",d=m.forwardRef((e,t)=>{let{scope:n,children:r,...i}=e,a=m.useRef(null),o=(0,B.e)(t,a),l=s(u,n);return m.useEffect(()=>(l.itemMap.set(a,{ref:a,...i}),()=>void l.itemMap.delete(a))),(0,p.jsx)(x.g7,{[c]:"",ref:o,children:r})});return d.displayName=u,[{Provider:a,Slot:l,ItemSlot:d},function(t){let n=s(e+"CollectionConsumer",t);return m.useCallback(()=>{let e=n.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${c}]`));return Array.from(n.itemMap.values()).sort((e,n)=>t.indexOf(e.ref.current)-t.indexOf(n.ref.current))},[n.collectionRef,n.itemMap])},r]}var j=m.createContext(void 0);function V(e){let t=m.useContext(j);return e||t||"ltr"}function U(e){let t=m.useRef(e);return m.useEffect(()=>{t.current=e}),m.useMemo(()=>(...e)=>t.current?.(...e),[])}function z(e,t=globalThis?.document){let n=U(e);m.useEffect(()=>{let e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[n,t])}var q="DismissableLayer",W="dismissableLayer.update",$="dismissableLayer.pointerDownOutside",H="dismissableLayer.focusOutside",G=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),K=m.forwardRef((e,t)=>{let{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:o,onDismiss:l,...u}=e,c=m.useContext(G),[d,h]=m.useState(null),f=d?.ownerDocument??globalThis?.document,[,g]=m.useState({}),y=(0,B.e)(t,e=>h(e)),v=Array.from(c.layers),[b]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),w=v.indexOf(b),S=d?v.indexOf(d):-1,T=c.layersWithOutsidePointerEventsDisabled.size>0,C=S>=w,E=Y(e=>{let t=e.target,n=[...c.branches].some(e=>e.contains(t));!C||n||(i?.(e),o?.(e),e.defaultPrevented||l?.())},f),x=J(e=>{let t=e.target;[...c.branches].some(e=>e.contains(t))||(s?.(e),o?.(e),e.defaultPrevented||l?.())},f);return z(e=>{S!==c.layers.size-1||(r?.(e),!e.defaultPrevented&&l&&(e.preventDefault(),l()))},f),m.useEffect(()=>{if(d)return n&&(0===c.layersWithOutsidePointerEventsDisabled.size&&(a=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),X(),()=>{n&&1===c.layersWithOutsidePointerEventsDisabled.size&&(f.body.style.pointerEvents=a)}},[d,f,n,c]),m.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),X())},[d,c]),m.useEffect(()=>{let e=()=>g({});return document.addEventListener(W,e),()=>document.removeEventListener(W,e)},[]),(0,p.jsx)(_.div,{...u,ref:y,style:{pointerEvents:T?C?"auto":"none":void 0,...e.style},onFocusCapture:M(e.onFocusCapture,x.onFocusCapture),onBlurCapture:M(e.onBlurCapture,x.onBlurCapture),onPointerDownCapture:M(e.onPointerDownCapture,E.onPointerDownCapture)})});K.displayName=q;var Q="DismissableLayerBranch";function Y(e,t=globalThis?.document){let n=U(e),r=m.useRef(!1),i=m.useRef(()=>{});return m.useEffect(()=>{let e=e=>{if(e.target&&!r.current){let r=function(){Z($,n,s,{discrete:!0})},s={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",i.current),i.current=r,t.addEventListener("click",i.current,{once:!0})):r()}else t.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",e),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function J(e,t=globalThis?.document){let n=U(e),r=m.useRef(!1);return m.useEffect(()=>{let e=e=>{e.target&&!r.current&&Z(H,n,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function X(){let e=new CustomEvent(W);document.dispatchEvent(e)}function Z(e,t,n,{discrete:r}){let i=n.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?I(i,s):i.dispatchEvent(s)}m.forwardRef((e,t)=>{let n=m.useContext(G),r=m.useRef(null),i=(0,B.e)(t,r);return m.useEffect(()=>{let e=r.current;if(e)return n.branches.add(e),()=>{n.branches.delete(e)}},[n.branches]),(0,p.jsx)(_.div,{...e,ref:i})}).displayName=Q;var ee=0;function et(){m.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??en()),document.body.insertAdjacentElement("beforeend",e[1]??en()),ee++,()=>{1===ee&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),ee--}},[])}function en(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var er="focusScope.autoFocusOnMount",ei="focusScope.autoFocusOnUnmount",es={bubbles:!1,cancelable:!0},ea="FocusScope",eo=m.forwardRef((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=e,[o,l]=m.useState(null),u=U(i),c=U(s),d=m.useRef(null),h=(0,B.e)(t,e=>l(e)),f=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(r){let e=function(e){if(f.paused||!o)return;let t=e.target;o.contains(t)?d.current=t:ep(d.current,{select:!0})},t=function(e){if(f.paused||!o)return;let t=e.relatedTarget;null===t||o.contains(t)||ep(d.current,{select:!0})},n=function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&ep(o)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let r=new MutationObserver(n);return o&&r.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}},[r,o,f.paused]),m.useEffect(()=>{if(o){em.add(f);let e=document.activeElement;if(!o.contains(e)){let t=new CustomEvent(er,es);o.addEventListener(er,u),o.dispatchEvent(t),t.defaultPrevented||(el(ev(ec(o)),{select:!0}),document.activeElement===e&&ep(o))}return()=>{o.removeEventListener(er,u),setTimeout(()=>{let t=new CustomEvent(ei,es);o.addEventListener(ei,c),o.dispatchEvent(t),t.defaultPrevented||ep(e??document.body,{select:!0}),o.removeEventListener(ei,c),em.remove(f)},0)}}},[o,u,c,f]);let g=m.useCallback(e=>{if(!n&&!r||f.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,i=document.activeElement;if(t&&i){let t=e.currentTarget,[r,s]=eu(t);r&&s?e.shiftKey||i!==s?e.shiftKey&&i===r&&(e.preventDefault(),n&&ep(s,{select:!0})):(e.preventDefault(),n&&ep(r,{select:!0})):i===t&&e.preventDefault()}},[n,r,f.paused]);return(0,p.jsx)(_.div,{tabIndex:-1,...a,ref:h,onKeyDown:g})});function el(e,{select:t=!1}={}){let n=document.activeElement;for(let r of e)if(ep(r,{select:t}),document.activeElement!==n)return}function eu(e){let t=ec(e);return[ed(t,e),ed(t.reverse(),e)]}function ec(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function ed(e,t){for(let n of e)if(!eh(n,{upTo:t}))return n}function eh(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function ef(e){return e instanceof HTMLInputElement&&"select"in e}function ep(e,{select:t=!1}={}){if(e&&e.focus){let n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&ef(e)&&t&&e.select()}}eo.displayName=ea;var em=eg();function eg(){let e=[];return{add(t){let n=e[0];t!==n&&n?.pause(),(e=ey(e,t)).unshift(t)},remove(t){e=ey(e,t),e[0]?.resume()}}}function ey(e,t){let n=[...e],r=n.indexOf(t);return -1!==r&&n.splice(r,1),n}function ev(e){return e.filter(e=>"A"!==e.tagName)}var eb=globalThis?.document?m.useLayoutEffect:()=>{},ew=g["useId".toString()]||(()=>void 0),eS=0;function eT(e){let[t,n]=m.useState(ew());return eb(()=>{e||n(e=>e??String(eS++))},[e]),e||(t?`radix-${t}`:"")}let eC=["top","right","bottom","left"],eE=Math.min,ex=Math.max,e_=Math.round,eI=Math.floor,ek=e=>({x:e,y:e}),eD={left:"right",right:"left",bottom:"top",top:"bottom"},eR={start:"end",end:"start"};function eN(e,t,n){return ex(e,eE(t,n))}function eA(e,t){return"function"==typeof e?e(t):e}function eO(e){return e.split("-")[0]}function eM(e){return e.split("-")[1]}function eP(e){return"x"===e?"y":"x"}function eL(e){return"y"===e?"height":"width"}function eB(e){return["top","bottom"].includes(eO(e))?"y":"x"}function eF(e){return eP(eB(e))}function ej(e,t,n){void 0===n&&(n=!1);let r=eM(e),i=eF(e),s=eL(i),a="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=eW(a)),[a,eW(a)]}function eV(e){let t=eW(e);return[eU(e),t,eU(t)]}function eU(e){return e.replace(/start|end/g,e=>eR[e])}function ez(e,t,n){let r=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":if(n)return t?i:r;return t?r:i;case"left":case"right":return t?s:a;default:return[]}}function eq(e,t,n,r){let i=eM(e),s=ez(eO(e),"start"===n,r);return i&&(s=s.map(e=>e+"-"+i),t&&(s=s.concat(s.map(eU)))),s}function eW(e){return e.replace(/left|right|bottom|top/g,e=>eD[e])}function e$(e){return{top:0,right:0,bottom:0,left:0,...e}}function eH(e){return"number"!=typeof e?e$(e):{top:e,right:e,bottom:e,left:e}}function eG(e){let{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function eK(e,t,n){let r,{reference:i,floating:s}=e,a=eB(t),o=eF(t),l=eL(o),u=eO(t),c="y"===a,d=i.x+i.width/2-s.width/2,h=i.y+i.height/2-s.height/2,f=i[l]/2-s[l]/2;switch(u){case"top":r={x:d,y:i.y-s.height};break;case"bottom":r={x:d,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:h};break;case"left":r={x:i.x-s.width,y:h};break;default:r={x:i.x,y:i.y}}switch(eM(t)){case"start":r[o]-=f*(n&&c?-1:1);break;case"end":r[o]+=f*(n&&c?-1:1)}return r}let eQ=async(e,t,n)=>{let{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await (null==a.isRTL?void 0:a.isRTL(t)),u=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:d}=eK(u,r,l),h=r,f={},p=0;for(let n=0;n<o.length;n++){let{name:s,fn:m}=o[n],{x:g,y:y,data:v,reset:b}=await m({x:c,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:u,platform:a,elements:{reference:e,floating:t}});c=null!=g?g:c,d=null!=y?y:d,f={...f,[s]:{...f[s],...v}},b&&p<=50&&(p++,"object"==typeof b&&(b.placement&&(h=b.placement),b.rects&&(u=!0===b.rects?await a.getElementRects({reference:e,floating:t,strategy:i}):b.rects),{x:c,y:d}=eK(u,h,l)),n=-1)}return{x:c,y:d,placement:h,strategy:i,middlewareData:f}};async function eY(e,t){var n;void 0===t&&(t={});let{x:r,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=eA(t,e),p=eH(f),m="floating"===d?"reference":"floating",g=o[h?m:d],y=eG(await s.getClippingRect({element:null==(n=await (null==s.isElement?void 0:s.isElement(g)))||n?g:g.contextElement||await (null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),v="floating"===d?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,b=await (null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),w=await (null==s.isElement?void 0:s.isElement(b))&&await (null==s.getScale?void 0:s.getScale(b))||{x:1,y:1},S=eG(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:b,strategy:l}):v);return{top:(y.top-S.top+p.top)/w.y,bottom:(S.bottom-y.bottom+p.bottom)/w.y,left:(y.left-S.left+p.left)/w.x,right:(S.right-y.right+p.right)/w.x}}let eJ=e=>({name:"arrow",options:e,async fn(t){let{x:n,y:r,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:u,padding:c=0}=eA(e,t)||{};if(null==u)return{};let d=eH(c),h={x:n,y:r},f=eF(i),p=eL(f),m=await a.getDimensions(u),g="y"===f,y=g?"top":"left",v=g?"bottom":"right",b=g?"clientHeight":"clientWidth",w=s.reference[p]+s.reference[f]-h[f]-s.floating[p],S=h[f]-s.reference[f],T=await (null==a.getOffsetParent?void 0:a.getOffsetParent(u)),C=T?T[b]:0;C&&await (null==a.isElement?void 0:a.isElement(T))||(C=o.floating[b]||s.floating[p]);let E=w/2-S/2,x=C/2-m[p]/2-1,_=eE(d[y],x),I=eE(d[v],x),k=_,D=C-m[p]-I,R=C/2-m[p]/2+E,N=eN(k,R,D),A=!l.arrow&&null!=eM(i)&&R!==N&&s.reference[p]/2-(R<k?_:I)-m[p]/2<0,O=A?R<k?R-k:R-D:0;return{[f]:h[f]+O,data:{[f]:N,centerOffset:R-N-O,...A&&{alignmentOffset:O}},reset:A}}}),eX=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r,i,s,a;let{placement:o,middlewareData:l,rects:u,initialPlacement:c,platform:d,elements:h}=t,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:v=!0,...b}=eA(e,t);if(null!=(n=l.arrow)&&n.alignmentOffset)return{};let w=eO(o),S=eB(c),T=eO(c)===c,C=await (null==d.isRTL?void 0:d.isRTL(h.floating)),E=m||(T||!v?[eW(c)]:eV(c)),x="none"!==y;!m&&x&&E.push(...eq(c,v,y,C));let _=[c,...E],I=await eY(t,b),k=[],D=(null==(r=l.flip)?void 0:r.overflows)||[];if(f&&k.push(I[w]),p){let e=ej(o,u,C);k.push(I[e[0]],I[e[1]])}if(D=[...D,{placement:o,overflows:k}],!k.every(e=>e<=0)){let e=((null==(i=l.flip)?void 0:i.index)||0)+1,t=_[e];if(t)return{data:{index:e,overflows:D},reset:{placement:t}};let n=null==(s=D.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:s.placement;if(!n)switch(g){case"bestFit":{let e=null==(a=D.filter(e=>{if(x){let t=eB(e.placement);return t===S||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:a[0];e&&(n=e);break}case"initialPlacement":n=c}if(o!==n)return{reset:{placement:n}}}return{}}}};function eZ(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function e0(e){return eC.some(t=>e[t]>=0)}let e1=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){let{rects:n}=t,{strategy:r="referenceHidden",...i}=eA(e,t);switch(r){case"referenceHidden":{let e=eZ(await eY(t,{...i,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:e0(e)}}}case"escaped":{let e=eZ(await eY(t,{...i,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:e0(e)}}}default:return{}}}}};async function e2(e,t){let{placement:n,platform:r,elements:i}=e,s=await (null==r.isRTL?void 0:r.isRTL(i.floating)),a=eO(n),o=eM(n),l="y"===eB(n),u=["left","top"].includes(a)?-1:1,c=s&&l?-1:1,d=eA(t,e),{mainAxis:h,crossAxis:f,alignmentAxis:p}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&"number"==typeof p&&(f="end"===o?-1*p:p),l?{x:f*c,y:h*u}:{x:h*u,y:f*c}}let e4=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;let{x:i,y:s,placement:a,middlewareData:o}=t,l=await e2(t,e);return a===(null==(n=o.offset)?void 0:n.placement)&&null!=(r=o.arrow)&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},e3=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){let{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=eA(e,t),u={x:n,y:r},c=await eY(t,l),d=eB(eO(i)),h=eP(d),f=u[h],p=u[d];if(s){let e="y"===h?"top":"left",t="y"===h?"bottom":"right",n=f+c[e],r=f-c[t];f=eN(n,f,r)}if(a){let e="y"===d?"top":"left",t="y"===d?"bottom":"right",n=p+c[e],r=p-c[t];p=eN(n,p,r)}let m=o.fn({...t,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[h]:s,[d]:a}}}}}},e6=function(e){return void 0===e&&(e={}),{options:e,fn(t){let{x:n,y:r,placement:i,rects:s,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=eA(e,t),c={x:n,y:r},d=eB(i),h=eP(d),f=c[h],p=c[d],m=eA(o,t),g="number"==typeof m?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){let e="y"===h?"height":"width",t=s.reference[h]-s.floating[e]+g.mainAxis,n=s.reference[h]+s.reference[e]-g.mainAxis;f<t?f=t:f>n&&(f=n)}if(u){var y,v;let e="y"===h?"width":"height",t=["top","left"].includes(eO(i)),n=s.reference[d]-s.floating[e]+(t&&(null==(y=a.offset)?void 0:y[d])||0)+(t?0:g.crossAxis),r=s.reference[d]+s.reference[e]+(t?0:(null==(v=a.offset)?void 0:v[d])||0)-(t?g.crossAxis:0);p<n?p=n:p>r&&(p=r)}return{[h]:f,[d]:p}}}},e5=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var n,r;let i,s;let{placement:a,rects:o,platform:l,elements:u}=t,{apply:c=()=>{},...d}=eA(e,t),h=await eY(t,d),f=eO(a),p=eM(a),m="y"===eB(a),{width:g,height:y}=o.floating;"top"===f||"bottom"===f?(i=f,s=p===(await (null==l.isRTL?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(s=f,i="end"===p?"top":"bottom");let v=y-h.top-h.bottom,b=g-h.left-h.right,w=eE(y-h[i],v),S=eE(g-h[s],b),T=!t.middlewareData.shift,C=w,E=S;if(null!=(n=t.middlewareData.shift)&&n.enabled.x&&(E=b),null!=(r=t.middlewareData.shift)&&r.enabled.y&&(C=v),T&&!p){let e=ex(h.left,0),t=ex(h.right,0),n=ex(h.top,0),r=ex(h.bottom,0);m?E=g-2*(0!==e||0!==t?e+t:ex(h.left,h.right)):C=y-2*(0!==n||0!==r?n+r:ex(h.top,h.bottom))}await c({...t,availableWidth:E,availableHeight:C});let x=await l.getDimensions(u.floating);return g!==x.width||y!==x.height?{reset:{rects:!0}}:{}}}};function e9(){return"undefined"!=typeof window}function e7(e){return tt(e)?(e.nodeName||"").toLowerCase():"#document"}function e8(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function te(e){var t;return null==(t=(tt(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function tt(e){return!!e9()&&(e instanceof Node||e instanceof e8(e).Node)}function tn(e){return!!e9()&&(e instanceof Element||e instanceof e8(e).Element)}function tr(e){return!!e9()&&(e instanceof HTMLElement||e instanceof e8(e).HTMLElement)}function ti(e){return!!e9()&&"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof e8(e).ShadowRoot)}function ts(e){let{overflow:t,overflowX:n,overflowY:r,display:i}=th(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function ta(e){return["table","td","th"].includes(e7(e))}function to(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch(e){return!1}})}function tl(e){let t=tc(),n=tn(e)?th(e):e;return["transform","translate","scale","rotate","perspective"].some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some(e=>(n.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(n.contain||"").includes(e))}function tu(e){let t=tp(e);for(;tr(t)&&!td(t);){if(tl(t))return t;if(to(t))break;t=tp(t)}return null}function tc(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function td(e){return["html","body","#document"].includes(e7(e))}function th(e){return e8(e).getComputedStyle(e)}function tf(e){return tn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function tp(e){if("html"===e7(e))return e;let t=e.assignedSlot||e.parentNode||ti(e)&&e.host||te(e);return ti(t)?t.host:t}function tm(e){let t=tp(e);return td(t)?e.ownerDocument?e.ownerDocument.body:e.body:tr(t)&&ts(t)?t:tm(t)}function tg(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);let i=tm(e),s=i===(null==(r=e.ownerDocument)?void 0:r.body),a=e8(i);if(s){let e=ty(a);return t.concat(a,a.visualViewport||[],ts(i)?i:[],e&&n?tg(e):[])}return t.concat(i,tg(i,[],n))}function ty(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function tv(e){let t=th(e),n=parseFloat(t.width)||0,r=parseFloat(t.height)||0,i=tr(e),s=i?e.offsetWidth:n,a=i?e.offsetHeight:r,o=e_(n)!==s||e_(r)!==a;return o&&(n=s,r=a),{width:n,height:r,$:o}}function tb(e){return tn(e)?e:e.contextElement}function tw(e){let t=tb(e);if(!tr(t))return ek(1);let n=t.getBoundingClientRect(),{width:r,height:i,$:s}=tv(t),a=(s?e_(n.width):n.width)/r,o=(s?e_(n.height):n.height)/i;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}let tS=ek(0);function tT(e){let t=e8(e);return tc()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:tS}function tC(e,t,n){return void 0===t&&(t=!1),!!n&&(!t||n===e8(e))&&t}function tE(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);let i=e.getBoundingClientRect(),s=tb(e),a=ek(1);t&&(r?tn(r)&&(a=tw(r)):a=tw(e));let o=tC(s,n,r)?tT(s):ek(0),l=(i.left+o.x)/a.x,u=(i.top+o.y)/a.y,c=i.width/a.x,d=i.height/a.y;if(s){let e=e8(s),t=r&&tn(r)?e8(r):r,n=e,i=ty(n);for(;i&&r&&t!==n;){let e=tw(i),t=i.getBoundingClientRect(),r=th(i),s=t.left+(i.clientLeft+parseFloat(r.paddingLeft))*e.x,a=t.top+(i.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,u*=e.y,c*=e.x,d*=e.y,l+=s,u+=a,i=ty(n=e8(i))}}return eG({width:c,height:d,x:l,y:u})}function tx(e,t){let n=tf(e).scrollLeft;return t?t.left+n:tE(te(e)).left+n}function t_(e,t,n){void 0===n&&(n=!1);let r=e.getBoundingClientRect();return{x:r.left+t.scrollLeft-(n?0:tx(e,r)),y:r.top+t.scrollTop}}function tI(e){let t=te(e),n=tf(e),r=e.ownerDocument.body,i=ex(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=ex(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),a=-n.scrollLeft+tx(e),o=-n.scrollTop;return"rtl"===th(r).direction&&(a+=ex(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:o}}function tk(e,t){let n=e8(e),r=te(e),i=n.visualViewport,s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;let e=tc();(!e||e&&"fixed"===t)&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function tD(e,t){let n=tE(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=tr(e)?tw(e):ek(1),a=e.clientWidth*s.x;return{width:a,height:e.clientHeight*s.y,x:i*s.x,y:r*s.y}}function tR(e,t,n){let r;if("viewport"===t)r=tk(e,n);else if("document"===t)r=tI(te(e));else if(tn(t))r=tD(t,n);else{let n=tT(e);r={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return eG(r)}function tN(e,t){let n=tp(e);return!(n===t||!tn(n)||td(n))&&("fixed"===th(n).position||tN(n,t))}function tA(e,t){let n=t.get(e);if(n)return n;let r=tg(e,[],!1).filter(e=>tn(e)&&"body"!==e7(e)),i=null,s="fixed"===th(e).position,a=s?tp(e):e;for(;tn(a)&&!td(a);){let t=th(a),n=tl(a);n||"fixed"!==t.position||(i=null),(s?!n&&!i:!n&&"static"===t.position&&!!i&&["absolute","fixed"].includes(i.position)||ts(a)&&!n&&tN(e,a))?r=r.filter(e=>e!==a):i=t,a=tp(a)}return t.set(e,r),r}function tO(e,t,n){let r=tr(t),i=te(t),s="fixed"===n,a=tE(e,!0,s,t),o={scrollLeft:0,scrollTop:0},l=ek(0);if(r||!r&&!s){if(("body"!==e7(t)||ts(i))&&(o=tf(t)),r){let e=tE(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else i&&(l.x=tx(i))}let u=!i||r||s?ek(0):t_(i,o);return{x:a.left+o.scrollLeft-l.x-u.x,y:a.top+o.scrollTop-l.y-u.y,width:a.width,height:a.height}}function tM(e){return"static"===th(e).position}function tP(e,t){if(!tr(e)||"fixed"===th(e).position)return null;if(t)return t(e);let n=e.offsetParent;return te(e)===n&&(n=n.ownerDocument.body),n}function tL(e,t){let n=e8(e);if(to(e))return n;if(!tr(e)){let t=tp(e);for(;t&&!td(t);){if(tn(t)&&!tM(t))return t;t=tp(t)}return n}let r=tP(e,t);for(;r&&ta(r)&&tM(r);)r=tP(r,t);return r&&td(r)&&tM(r)&&!tl(r)?n:r||tu(e)||n}let tB=async function(e){let t=this.getOffsetParent||tL,n=this.getDimensions,r=await n(e.floating);return{reference:tO(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},tF={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e,s="fixed"===i,a=te(r),o=!!t&&to(t.floating);if(r===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},u=ek(1),c=ek(0),d=tr(r);if((d||!d&&!s)&&(("body"!==e7(r)||ts(a))&&(l=tf(r)),tr(r))){let e=tE(r);u=tw(r),c.x=e.x+r.clientLeft,c.y=e.y+r.clientTop}let h=!a||d||s?ek(0):t_(a,l,!0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x+h.x,y:n.y*u.y-l.scrollTop*u.y+c.y+h.y}},getDocumentElement:te,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e,s=[..."clippingAncestors"===n?to(t)?[]:tA(t,this._c):[].concat(n),r],a=s[0],o=s.reduce((e,n)=>{let r=tR(t,n,i);return e.top=ex(r.top,e.top),e.right=eE(r.right,e.right),e.bottom=eE(r.bottom,e.bottom),e.left=ex(r.left,e.left),e},tR(t,a,i));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:tL,getElementRects:tB,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:n}=tv(e);return{width:t,height:n}},getScale:tw,isElement:tn,isRTL:function(e){return"rtl"===th(e).direction}};function tj(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function tV(e,t){let n,r=null,i=te(e);function s(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();let u=e.getBoundingClientRect(),{left:c,top:d,width:h,height:f}=u;if(o||t(),!h||!f)return;let p=eI(d),m={rootMargin:-p+"px "+-eI(i.clientWidth-(c+h))+"px "+-eI(i.clientHeight-(d+f))+"px "+-eI(c)+"px",threshold:ex(0,eE(1,l))||1},g=!0;function y(t){let r=t[0].intersectionRatio;if(r!==l){if(!g)return a();r?a(!1,r):n=setTimeout(()=>{a(!1,1e-7)},1e3)}1!==r||tj(u,e.getBoundingClientRect())||a(),g=!1}try{r=new IntersectionObserver(y,{...m,root:i.ownerDocument})}catch(e){r=new IntersectionObserver(y,m)}r.observe(e)}return a(!0),s}function tU(e,t,n,r){let i;void 0===r&&(r={});let{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:u=!1}=r,c=tb(e),d=s||a?[...c?tg(c):[],...tg(t)]:[];d.forEach(e=>{s&&e.addEventListener("scroll",n,{passive:!0}),a&&e.addEventListener("resize",n)});let h=c&&l?tV(c,n):null,f=-1,p=null;o&&(p=new ResizeObserver(e=>{let[r]=e;r&&r.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),n()}),c&&!u&&p.observe(c),p.observe(t));let m=u?tE(e):null;function g(){let t=tE(e);m&&!tj(m,t)&&n(),m=t,i=requestAnimationFrame(g)}return u&&g(),n(),()=>{var e;d.forEach(e=>{s&&e.removeEventListener("scroll",n),a&&e.removeEventListener("resize",n)}),null==h||h(),null==(e=p)||e.disconnect(),p=null,u&&cancelAnimationFrame(i)}}let tz=e4,tq=e3,tW=eX,t$=e5,tH=e1,tG=eJ,tK=e6,tQ=(e,t,n)=>{let r=new Map,i={platform:tF,...n},s={...i.platform,_c:r};return eQ(e,t,{...i,platform:s})};var tY="undefined"!=typeof document?m.useLayoutEffect:m.useEffect;function tJ(e,t){let n,r,i;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((n=e.length)!==t.length)return!1;for(r=n;0!=r--;)if(!tJ(e[r],t[r]))return!1;return!0}if((n=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!({}).hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!=r--;){let n=i[r];if(("_owner"!==n||!e.$$typeof)&&!tJ(e[n],t[n]))return!1}return!0}return e!=e&&t!=t}function tX(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function tZ(e,t){let n=tX(e);return Math.round(t*n)/n}function t0(e){let t=m.useRef(e);return tY(()=>{t.current=e}),t}function t1(e){void 0===e&&(e={});let{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:u}=e,[c,d]=m.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,f]=m.useState(r);tJ(h,r)||f(r);let[p,g]=m.useState(null),[y,v]=m.useState(null),b=m.useCallback(e=>{e!==C.current&&(C.current=e,g(e))},[]),w=m.useCallback(e=>{e!==x.current&&(x.current=e,v(e))},[]),S=s||p,T=a||y,C=m.useRef(null),x=m.useRef(null),_=m.useRef(c),I=null!=l,k=t0(l),D=t0(i),R=t0(u),N=m.useCallback(()=>{if(!C.current||!x.current)return;let e={placement:t,strategy:n,middleware:h};D.current&&(e.platform=D.current),tQ(C.current,x.current,e).then(e=>{let t={...e,isPositioned:!1!==R.current};A.current&&!tJ(_.current,t)&&(_.current=t,E.flushSync(()=>{d(t)}))})},[h,t,n,D,R]);tY(()=>{!1===u&&_.current.isPositioned&&(_.current.isPositioned=!1,d(e=>({...e,isPositioned:!1})))},[u]);let A=m.useRef(!1);tY(()=>(A.current=!0,()=>{A.current=!1}),[]),tY(()=>{if(S&&(C.current=S),T&&(x.current=T),S&&T){if(k.current)return k.current(S,T,N);N()}},[S,T,N,k,I]);let O=m.useMemo(()=>({reference:C,floating:x,setReference:b,setFloating:w}),[b,w]),M=m.useMemo(()=>({reference:S,floating:T}),[S,T]),P=m.useMemo(()=>{let e={position:n,left:0,top:0};if(!M.floating)return e;let t=tZ(M.floating,c.x),r=tZ(M.floating,c.y);return o?{...e,transform:"translate("+t+"px, "+r+"px)",...tX(M.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:r}},[n,o,M.floating,c.x,c.y]);return m.useMemo(()=>({...c,update:N,refs:O,elements:M,floatingStyles:P}),[c,N,O,M,P])}let t2=e=>{function t(e){return({}).hasOwnProperty.call(e,"current")}return{name:"arrow",options:e,fn(n){let{element:r,padding:i}="function"==typeof e?e(n):e;return r&&t(r)?null!=r.current?tG({element:r.current,padding:i}).fn(n):{}:r?tG({element:r,padding:i}).fn(n):{}}}},t4=(e,t)=>({...tz(e),options:[e,t]}),t3=(e,t)=>({...tq(e),options:[e,t]}),t6=(e,t)=>({...tK(e),options:[e,t]}),t5=(e,t)=>({...tW(e),options:[e,t]}),t9=(e,t)=>({...t$(e),options:[e,t]}),t7=(e,t)=>({...tH(e),options:[e,t]}),t8=(e,t)=>({...t2(e),options:[e,t]});var ne="Arrow",nt=m.forwardRef((e,t)=>{let{children:n,width:r=10,height:i=5,...s}=e;return(0,p.jsx)(_.svg,{...s,ref:t,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:(0,p.jsx)("polygon",{points:"0,0 30,0 15,10"})})});nt.displayName=ne;var nn=nt;function nr(e){let[t,n]=m.useState(void 0);return eb(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,i;if(!Array.isArray(t)||!t.length)return;let s=t[0];if("borderBoxSize"in s){let e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,i=t.blockSize}else r=e.offsetWidth,i=e.offsetHeight;n({width:r,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}var ni="Popper",[ns,na]=P(ni),[no,nl]=ns(ni),nu=e=>{let{__scopePopper:t,children:n}=e,[r,i]=m.useState(null);return(0,p.jsx)(no,{scope:t,anchor:r,onAnchorChange:i,children:n})};nu.displayName=ni;var nc="PopperAnchor",nd=m.forwardRef((e,t)=>{let{__scopePopper:n,virtualRef:r,...i}=e,s=nl(nc,n),a=m.useRef(null),o=(0,B.e)(t,a);return m.useEffect(()=>{s.onAnchorChange(r?.current||a.current)}),r?null:(0,p.jsx)(_.div,{...i,ref:o})});nd.displayName=nc;var nh="PopperContent",[nf,np]=ns(nh),nm=m.forwardRef((e,t)=>{let{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:g,...y}=e,v=nl(nh,n),[b,w]=m.useState(null),S=(0,B.e)(t,e=>w(e)),[T,C]=m.useState(null),E=nr(T),x=E?.width??0,I=E?.height??0,k=r+("center"!==s?"-"+s:""),D="number"==typeof c?c:{top:0,right:0,bottom:0,left:0,...c},R=Array.isArray(u)?u:[u],N=R.length>0,A={padding:D,boundary:R.filter(nb),altBoundary:N},{refs:O,floatingStyles:M,placement:P,isPositioned:L,middlewareData:F}=t1({strategy:"fixed",placement:k,whileElementsMounted:(...e)=>tU(...e,{animationFrame:"always"===f}),elements:{reference:v.anchor},middleware:[t4({mainAxis:i+I,alignmentAxis:a}),l&&t3({mainAxis:!0,crossAxis:!1,limiter:"partial"===d?t6():void 0,...A}),l&&t5({...A}),t9({...A,apply:({elements:e,rects:t,availableWidth:n,availableHeight:r})=>{let{width:i,height:s}=t.reference,a=e.floating.style;a.setProperty("--radix-popper-available-width",`${n}px`),a.setProperty("--radix-popper-available-height",`${r}px`),a.setProperty("--radix-popper-anchor-width",`${i}px`),a.setProperty("--radix-popper-anchor-height",`${s}px`)}}),T&&t8({element:T,padding:o}),nw({arrowWidth:x,arrowHeight:I}),h&&t7({strategy:"referenceHidden",...A})]}),[j,V]=nS(P),z=U(g);eb(()=>{L&&z?.()},[L,z]);let q=F.arrow?.x,W=F.arrow?.y,$=F.arrow?.centerOffset!==0,[H,G]=m.useState();return eb(()=>{b&&G(window.getComputedStyle(b).zIndex)},[b]),(0,p.jsx)("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...M,transform:L?M.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:H,"--radix-popper-transform-origin":[F.transformOrigin?.x,F.transformOrigin?.y].join(" "),...F.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:(0,p.jsx)(nf,{scope:n,placedSide:j,onArrowChange:C,arrowX:q,arrowY:W,shouldHideArrow:$,children:(0,p.jsx)(_.div,{"data-side":j,"data-align":V,...y,ref:S,style:{...y.style,animation:L?void 0:"none"}})})})});nm.displayName=nh;var ng="PopperArrow",ny={top:"bottom",right:"left",bottom:"top",left:"right"},nv=m.forwardRef(function(e,t){let{__scopePopper:n,...r}=e,i=np(ng,n),s=ny[i.placedSide];return(0,p.jsx)("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:(0,p.jsx)(nn,{...r,ref:t,style:{...r.style,display:"block"}})})});function nb(e){return null!==e}nv.displayName=ng;var nw=e=>({name:"transformOrigin",options:e,fn(t){let{placement:n,rects:r,middlewareData:i}=t,s=i.arrow?.centerOffset!==0,a=s?0:e.arrowWidth,o=s?0:e.arrowHeight,[l,u]=nS(n),c={start:"0%",center:"50%",end:"100%"}[u],d=(i.arrow?.x??0)+a/2,h=(i.arrow?.y??0)+o/2,f="",p="";return"bottom"===l?(f=s?c:`${d}px`,p=`${-o}px`):"top"===l?(f=s?c:`${d}px`,p=`${r.floating.height+o}px`):"right"===l?(f=`${-o}px`,p=s?c:`${h}px`):"left"===l&&(f=`${r.floating.width+o}px`,p=s?c:`${h}px`),{data:{x:f,y:p}}}});function nS(e){let[t,n="center"]=e.split("-");return[t,n]}var nT=nu,nC=nd,nE=nm,nx=nv,n_="Portal",nI=m.forwardRef((e,t)=>{let{container:n,...r}=e,[i,s]=m.useState(!1);eb(()=>s(!0),[]);let a=n||i&&globalThis?.document?.body;return a?E.createPortal((0,p.jsx)(_.div,{...r,ref:t}),a):null});function nk({prop:e,defaultProp:t,onChange:n=()=>{}}){let[r,i]=nD({defaultProp:t,onChange:n}),s=void 0!==e,a=s?e:r,o=U(n);return[a,m.useCallback(t=>{if(s){let n=t,r="function"==typeof t?n(e):t;r!==e&&o(r)}else i(t)},[s,e,i,o])]}function nD({defaultProp:e,onChange:t}){let n=m.useState(e),[r]=n,i=m.useRef(r),s=U(t);return m.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),n}function nR(e){let t=m.useRef({value:e,previous:e});return m.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}nI.displayName=n_;var nN="VisuallyHidden",nA=m.forwardRef((e,t)=>(0,p.jsx)(_.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));nA.displayName=nN;var nO=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},nM=new WeakMap,nP=new WeakMap,nL={},nB=0,nF=function(e){return e&&(e.host||nF(e.parentNode))},nj=function(e,t){return t.map(function(t){if(e.contains(t))return t;var n=nF(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(e){return!!e})},nV=function(e,t,n,r){var i=nj(t,Array.isArray(e)?e:[e]);nL[n]||(nL[n]=new WeakMap);var s=nL[n],a=[],o=new Set,l=new Set(i),u=function(e){!e||o.has(e)||(o.add(e),u(e.parentNode))};i.forEach(u);var c=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(o.has(e))c(e);else try{var t=e.getAttribute(r),i=null!==t&&"false"!==t,l=(nM.get(e)||0)+1,u=(s.get(e)||0)+1;nM.set(e,l),s.set(e,u),a.push(e),1===l&&i&&nP.set(e,!0),1===u&&e.setAttribute(n,"true"),i||e.setAttribute(r,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return c(t),o.clear(),nB++,function(){a.forEach(function(e){var t=nM.get(e)-1,i=s.get(e)-1;nM.set(e,t),s.set(e,i),t||(nP.has(e)||e.removeAttribute(r),nP.delete(e)),i||e.removeAttribute(n)}),--nB||(nM=new WeakMap,nM=new WeakMap,nP=new WeakMap,nL={})}},nU=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=t||nO(e);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),nV(r,i,n,"aria-hidden")):function(){return null}},nz=function(){return(nz=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function nq(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Object.create;function nW(e,t,n){if(n||2==arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;var n$=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),nH="width-before-scroll-bar",nG="with-scroll-bars-hidden",nK="--removed-body-scroll-bar-size";function nQ(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}function nY(e,t){var n=(0,m.useState)(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(value){var r=n.value;r!==value&&(n.value=value,n.callback(value,r))}}}})[0];return n.callback=t,n.facade}var nJ="undefined"!=typeof window?m.useLayoutEffect:m.useEffect,nX=new WeakMap;function nZ(e,t){var n=nY(t||null,function(t){return e.forEach(function(e){return nQ(e,t)})});return nJ(function(){var t=nX.get(n);if(t){var r=new Set(t),i=new Set(e),s=n.current;r.forEach(function(e){i.has(e)||nQ(e,null)}),i.forEach(function(e){r.has(e)||nQ(e,s)})}nX.set(n,e)},[e]),n}function n0(e){return e}function n1(e,t){void 0===t&&(t=n0);var n=[],r=!1;return{read:function(){if(r)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var i=t(e,r);return n.push(i),function(){n=n.filter(function(e){return e!==i})}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var i=n;n=[],i.forEach(e),t=n}var s=function(){var n=t;t=[],n.forEach(e)},a=function(){return Promise.resolve().then(s)};a(),n={push:function(e){t.push(e),a()},filter:function(e){return t=t.filter(e),n}}}}}var n2=function(e){void 0===e&&(e={});var t=n1(null);return t.options=nz({async:!0,ssr:!1},e),t}(),n4=function(){},n3=m.forwardRef(function(e,t){var n=m.useRef(null),r=m.useState({onScrollCapture:n4,onWheelCapture:n4,onTouchMoveCapture:n4}),i=r[0],s=r[1],a=e.forwardProps,o=e.children,l=e.className,u=e.removeScrollBar,c=e.enabled,d=e.shards,h=e.sideCar,f=e.noIsolation,p=e.inert,g=e.allowPinchZoom,y=e.as,v=void 0===y?"div":y,b=e.gapMode,w=nq(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=h,T=nZ([n,t]),C=nz(nz({},w),i);return m.createElement(m.Fragment,null,c&&m.createElement(S,{sideCar:n2,removeScrollBar:u,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!g,lockRef:n,gapMode:b}),a?m.cloneElement(m.Children.only(o),nz(nz({},C),{ref:T})):m.createElement(v,nz({},C,{className:l,ref:T}),o))});n3.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},n3.classNames={fullWidth:nH,zeroRight:n$};var n6=function(e){var t=e.sideCar,n=nq(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw Error("Sidecar medium not found");return m.createElement(r,nz({},n))};function n5(e,t){return e.useMedium(t),n6}n6.isSideCarExport=!0;var n9=function(){return o||n.nc};function n7(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=n9();return t&&e.setAttribute("nonce",t),e}function n8(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function re(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}var rt=function(){var e=0,t=null;return{add:function(n){0==e&&(t=n7())&&(n8(t,n),re(t)),e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},rn=function(){var e=rt();return function(t,n){m.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},rr=function(){var e=rn();return function(t){return e(t.styles,t.dynamic),null}},ri={left:0,top:0,right:0,gap:0},rs=function(e){return parseInt(e||"",10)||0},ra=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],i=t["padding"===e?"paddingRight":"marginRight"];return[rs(n),rs(r),rs(i)]},ro=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return ri;var t=ra(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},rl=rr(),ru="data-scroll-locked",rc=function(e,t,n,r){var i=e.left,s=e.top,a=e.right,o=e.gap;return void 0===n&&(n="margin"),"\n  .".concat(nG," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(o,"px ").concat(r,";\n  }\n  body[").concat(ru,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(i,"px;\n    padding-top: ").concat(s,"px;\n    padding-right: ").concat(a,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(n$," {\n    right: ").concat(o,"px ").concat(r,";\n  }\n  \n  .").concat(nH," {\n    margin-right: ").concat(o,"px ").concat(r,";\n  }\n  \n  .").concat(n$," .").concat(n$," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(nH," .").concat(nH," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(ru,"] {\n    ").concat(nK,": ").concat(o,"px;\n  }\n")},rd=function(){var e=parseInt(document.body.getAttribute(ru)||"0",10);return isFinite(e)?e:0},rh=function(){m.useEffect(function(){return document.body.setAttribute(ru,(rd()+1).toString()),function(){var e=rd()-1;e<=0?document.body.removeAttribute(ru):document.body.setAttribute(ru,e.toString())}},[])},rf=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,i=void 0===r?"margin":r;rh();var s=m.useMemo(function(){return ro(i)},[i]);return m.createElement(rl,{styles:rc(s,!t,i,n?"":"!important")})},rp=!1;if("undefined"!=typeof window)try{var rm=Object.defineProperty({},"passive",{get:function(){return rp=!0,!0}});window.addEventListener("test",rm,rm),window.removeEventListener("test",rm,rm)}catch(e){rp=!1}var rg=!!rp&&{passive:!1},ry=function(e){return"TEXTAREA"===e.tagName},rv=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&!ry(e)&&"visible"===n[t])},rb=function(e){return rv(e,"overflowY")},rw=function(e){return rv(e,"overflowX")},rS=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),rE(e,r)){var i=rx(e,r);if(i[1]>i[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},rT=function(e){return[e.scrollTop,e.scrollHeight,e.clientHeight]},rC=function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]},rE=function(e,t){return"v"===e?rb(t):rw(t)},rx=function(e,t){return"v"===e?rT(t):rC(t)},r_=function(e,t){return"h"===e&&"rtl"===t?-1:1},rI=function(e,t,n,r,i){var s=r_(e,window.getComputedStyle(t).direction),a=s*r,o=n.target,l=t.contains(o),u=!1,c=a>0,d=0,h=0;do{var f=rx(e,o),p=f[0],m=f[1]-f[2]-s*p;(p||m)&&rE(e,o)&&(d+=m,h+=p),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return c&&(i&&1>Math.abs(d)||!i&&a>d)?u=!0:!c&&(i&&1>Math.abs(h)||!i&&-a>h)&&(u=!0),u},rk=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},rD=function(e){return[e.deltaX,e.deltaY]},rR=function(e){return e&&"current"in e?e.current:e},rN=function(e,t){return e[0]===t[0]&&e[1]===t[1]},rA=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},rO=0,rM=[];function rP(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}let rL=n5(n2,function(e){var t=m.useRef([]),n=m.useRef([0,0]),r=m.useRef(),i=m.useState(rO++)[0],s=m.useState(rr)[0],a=m.useRef(e);m.useEffect(function(){a.current=e},[e]),m.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var t=nW([e.lockRef.current],(e.shards||[]).map(rR),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=m.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!a.current.allowPinchZoom;var i,s=rk(e),o=n.current,l="deltaX"in e?e.deltaX:o[0]-s[0],u="deltaY"in e?e.deltaY:o[1]-s[1],c=e.target,d=Math.abs(l)>Math.abs(u)?"h":"v";if("touches"in e&&"h"===d&&"range"===c.type)return!1;var h=rS(d,c);if(!h)return!0;if(h?i=d:(i="v"===d?"h":"v",h=rS(d,c)),!h)return!1;if(!r.current&&"changedTouches"in e&&(l||u)&&(r.current=i),!i)return!0;var f=r.current||i;return rI(f,t,e,"h"===f?l:u,!0)},[]),l=m.useCallback(function(e){var n=e;if(rM.length&&rM[rM.length-1]===s){var r="deltaY"in n?rD(n):rk(n),i=t.current.filter(function(e){return e.name===n.type&&(e.target===n.target||n.target===e.shadowParent)&&rN(e.delta,r)})[0];if(i&&i.should){n.cancelable&&n.preventDefault();return}if(!i){var l=(a.current.shards||[]).map(rR).filter(Boolean).filter(function(e){return e.contains(n.target)});(l.length>0?o(n,l[0]):!a.current.noIsolation)&&n.cancelable&&n.preventDefault()}}},[]),u=m.useCallback(function(e,n,r,i){var s={name:e,delta:n,target:r,should:i,shadowParent:rP(r)};t.current.push(s),setTimeout(function(){t.current=t.current.filter(function(e){return e!==s})},1)},[]),c=m.useCallback(function(e){n.current=rk(e),r.current=void 0},[]),d=m.useCallback(function(t){u(t.type,rD(t),t.target,o(t,e.lockRef.current))},[]),h=m.useCallback(function(t){u(t.type,rk(t),t.target,o(t,e.lockRef.current))},[]);m.useEffect(function(){return rM.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,rg),document.addEventListener("touchmove",l,rg),document.addEventListener("touchstart",c,rg),function(){rM=rM.filter(function(e){return e!==s}),document.removeEventListener("wheel",l,rg),document.removeEventListener("touchmove",l,rg),document.removeEventListener("touchstart",c,rg)}},[]);var f=e.removeScrollBar,p=e.inert;return m.createElement(m.Fragment,null,p?m.createElement(s,{styles:rA(i)}):null,f?m.createElement(rf,{gapMode:e.gapMode}):null)});var rB=m.forwardRef(function(e,t){return m.createElement(n3,nz({},e,{ref:t,sideCar:rL}))});rB.classNames=n3.classNames;let rF=rB;var rj=[" ","Enter","ArrowUp","ArrowDown"],rV=[" ","Enter"],rU="Select",[rz,rq,rW]=F(rU),[r$,rH]=P(rU,[rW,na]),rG=na(),[rK,rQ]=r$(rU),[rY,rJ]=r$(rU),rX=e=>{let{__scopeSelect:t,children:n,open:r,defaultOpen:i,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:u,name:c,autoComplete:d,disabled:h,required:f,form:g}=e,y=rG(t),[v,b]=m.useState(null),[w,S]=m.useState(null),[T,C]=m.useState(!1),E=V(u),[x=!1,_]=nk({prop:r,defaultProp:i,onChange:s}),[I,k]=nk({prop:a,defaultProp:o,onChange:l}),D=m.useRef(null),R=!v||g||!!v.closest("form"),[N,A]=m.useState(new Set),O=Array.from(N).map(e=>e.props.value).join(";");return(0,p.jsx)(nT,{...y,children:(0,p.jsxs)(rK,{required:f,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:T,onValueNodeHasChildrenChange:C,contentId:eT(),value:I,onValueChange:k,open:x,onOpenChange:_,dir:E,triggerPointerDownPosRef:D,disabled:h,children:[(0,p.jsx)(rz.Provider,{scope:t,children:(0,p.jsx)(rY,{scope:e.__scopeSelect,onNativeOptionAdd:m.useCallback(e=>{A(t=>new Set(t).add(e))},[]),onNativeOptionRemove:m.useCallback(e=>{A(t=>{let n=new Set(t);return n.delete(e),n})},[]),children:n})}),R?(0,p.jsxs)(iL,{"aria-hidden":!0,required:f,tabIndex:-1,name:c,autoComplete:d,value:I,onChange:e=>k(e.target.value),disabled:h,form:g,children:[void 0===I?(0,p.jsx)("option",{value:""}):null,Array.from(N)]},O):null]})})};rX.displayName=rU;var rZ="SelectTrigger",r0=m.forwardRef((e,t)=>{let{__scopeSelect:n,disabled:r=!1,...i}=e,s=rG(n),a=rQ(rZ,n),o=a.disabled||r,l=(0,B.e)(t,a.onTriggerChange),u=rq(n),c=m.useRef("touch"),[d,h,f]=iB(e=>{let t=u().filter(e=>!e.disabled),n=t.find(e=>e.value===a.value),r=iF(t,e,n);void 0!==r&&a.onValueChange(r.value)}),g=e=>{o||(a.onOpenChange(!0),f()),e&&(a.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return(0,p.jsx)(nC,{asChild:!0,...s,children:(0,p.jsx)(_.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":iP(a.value)?"":void 0,...i,ref:l,onClick:M(i.onClick,e=>{e.currentTarget.focus(),"mouse"!==c.current&&g(e)}),onPointerDown:M(i.onPointerDown,e=>{c.current=e.pointerType;let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(g(e),e.preventDefault())}),onKeyDown:M(i.onKeyDown,e=>{let t=""!==d.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||h(e.key),(!t||" "!==e.key)&&rj.includes(e.key)&&(g(),e.preventDefault())})})})});r0.displayName=rZ;var r1="SelectValue",r2=m.forwardRef((e,t)=>{let{__scopeSelect:n,className:r,style:i,children:s,placeholder:a="",...o}=e,l=rQ(r1,n),{onValueNodeHasChildrenChange:u}=l,c=void 0!==s,d=(0,B.e)(t,l.onValueNodeChange);return eb(()=>{u(c)},[u,c]),(0,p.jsx)(_.span,{...o,ref:d,style:{pointerEvents:"none"},children:iP(l.value)?(0,p.jsx)(p.Fragment,{children:a}):s})});r2.displayName=r1;var r4="SelectIcon",r3=m.forwardRef((e,t)=>{let{__scopeSelect:n,children:r,...i}=e;return(0,p.jsx)(_.span,{"aria-hidden":!0,...i,ref:t,children:r||""})});r3.displayName=r4;var r6="SelectPortal",r5=e=>(0,p.jsx)(nI,{asChild:!0,...e});r5.displayName=r6;var r9="SelectContent",r7=m.forwardRef((e,t)=>{let n=rQ(r9,e.__scopeSelect),[r,i]=m.useState();if(eb(()=>{i(new DocumentFragment)},[]),!n.open){let t=r;return t?E.createPortal((0,p.jsx)(ie,{scope:e.__scopeSelect,children:(0,p.jsx)(rz.Slot,{scope:e.__scopeSelect,children:(0,p.jsx)("div",{children:e.children})})}),t):null}return(0,p.jsx)(ii,{...e,ref:t})});r7.displayName=r9;var r8=10,[ie,it]=r$(r9),ir="SelectContentImpl",ii=m.forwardRef((e,t)=>{let{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:g,hideWhenDetached:y,avoidCollisions:v,...b}=e,w=rQ(r9,n),[S,T]=m.useState(null),[C,E]=m.useState(null),_=(0,B.e)(t,e=>T(e)),[I,k]=m.useState(null),[D,R]=m.useState(null),N=rq(n),[A,O]=m.useState(!1),P=m.useRef(!1);m.useEffect(()=>{if(S)return nU(S)},[S]),et();let L=m.useCallback(e=>{let[t,...n]=N().map(e=>e.ref.current),[r]=n.slice(-1),i=document.activeElement;for(let n of e)if(n===i||(n?.scrollIntoView({block:"nearest"}),n===t&&C&&(C.scrollTop=0),n===r&&C&&(C.scrollTop=C.scrollHeight),n?.focus(),document.activeElement!==i))return},[N,C]),F=m.useCallback(()=>L([I,S]),[L,I,S]);m.useEffect(()=>{A&&F()},[A,F]);let{onOpenChange:j,triggerPointerDownPosRef:V}=w;m.useEffect(()=>{if(S){let e={x:0,y:0},t=t=>{e={x:Math.abs(Math.round(t.pageX)-(V.current?.x??0)),y:Math.abs(Math.round(t.pageY)-(V.current?.y??0))}},n=n=>{e.x<=10&&e.y<=10?n.preventDefault():S.contains(n.target)||j(!1),document.removeEventListener("pointermove",t),V.current=null};return null!==V.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",n,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",n,{capture:!0})}}},[S,j,V]),m.useEffect(()=>{let e=()=>j(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[j]);let[U,z]=iB(e=>{let t=N().filter(e=>!e.disabled),n=t.find(e=>e.ref.current===document.activeElement),r=iF(t,e,n);r&&setTimeout(()=>r.ref.current.focus())}),q=m.useCallback((e,t,n)=>{let r=!P.current&&!n;(void 0!==w.value&&w.value===t||r)&&(k(e),r&&(P.current=!0))},[w.value]),W=m.useCallback(()=>S?.focus(),[S]),$=m.useCallback((e,t,n)=>{let r=!P.current&&!n;(void 0!==w.value&&w.value===t||r)&&R(e)},[w.value]),H="popper"===r?il:ia,G=H===il?{side:o,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:g,hideWhenDetached:y,avoidCollisions:v}:{};return(0,p.jsx)(ie,{scope:n,content:S,viewport:C,onViewportChange:E,itemRefCallback:q,selectedItem:I,onItemLeave:W,itemTextRefCallback:$,focusSelectedItem:F,selectedItemText:D,position:r,isPositioned:A,searchRef:U,children:(0,p.jsx)(rF,{as:x.g7,allowPinchZoom:!0,children:(0,p.jsx)(eo,{asChild:!0,trapped:w.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:M(i,e=>{w.trigger?.focus({preventScroll:!0}),e.preventDefault()}),children:(0,p.jsx)(K,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:(0,p.jsx)(H,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:e=>e.preventDefault(),...b,...G,onPlaced:()=>O(!0),ref:_,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:M(b.onKeyDown,e=>{let t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||z(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=N().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){let n=e.target,r=t.indexOf(n);t=t.slice(r+1)}setTimeout(()=>L(t)),e.preventDefault()}})})})})})})});ii.displayName=ir;var is="SelectItemAlignedPosition",ia=m.forwardRef((e,t)=>{let{__scopeSelect:n,onPlaced:r,...i}=e,s=rQ(r9,n),a=it(r9,n),[o,l]=m.useState(null),[u,c]=m.useState(null),d=(0,B.e)(t,e=>c(e)),h=rq(n),f=m.useRef(!1),g=m.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=a,S=m.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&u&&y&&v&&b){let e=s.trigger.getBoundingClientRect(),t=u.getBoundingClientRect(),n=s.valueNode.getBoundingClientRect(),i=b.getBoundingClientRect();if("rtl"!==s.dir){let r=i.left-t.left,s=n.left-r,a=e.left-s,l=e.width+a,u=Math.max(l,t.width),c=window.innerWidth-r8,d=O(s,[r8,Math.max(r8,c-u)]);o.style.minWidth=l+"px",o.style.left=d+"px"}else{let r=t.right-i.right,s=window.innerWidth-n.right-r,a=window.innerWidth-e.right-s,l=e.width+a,u=Math.max(l,t.width),c=window.innerWidth-r8,d=O(s,[r8,Math.max(r8,c-u)]);o.style.minWidth=l+"px",o.style.right=d+"px"}let a=h(),l=window.innerHeight-2*r8,c=y.scrollHeight,d=window.getComputedStyle(u),p=parseInt(d.borderTopWidth,10),m=parseInt(d.paddingTop,10),g=parseInt(d.borderBottomWidth,10),w=p+m+c+parseInt(d.paddingBottom,10)+g,S=Math.min(5*v.offsetHeight,w),T=window.getComputedStyle(y),C=parseInt(T.paddingTop,10),E=parseInt(T.paddingBottom,10),x=e.top+e.height/2-r8,_=l-x,I=v.offsetHeight/2,k=p+m+(v.offsetTop+I),D=w-k;if(k<=x){let e=a.length>0&&v===a[a.length-1].ref.current;o.style.bottom="0px";let t=k+Math.max(_,I+(e?E:0)+(u.clientHeight-y.offsetTop-y.offsetHeight)+g);o.style.height=t+"px"}else{let e=a.length>0&&v===a[0].ref.current;o.style.top="0px";let t=Math.max(x,p+y.offsetTop+(e?C:0)+I)+D;o.style.height=t+"px",y.scrollTop=k-x+y.offsetTop}o.style.margin=`${r8}px 0`,o.style.minHeight=S+"px",o.style.maxHeight=l+"px",r?.(),requestAnimationFrame(()=>f.current=!0)}},[h,s.trigger,s.valueNode,o,u,y,v,b,s.dir,r]);eb(()=>S(),[S]);let[T,C]=m.useState();eb(()=>{u&&C(window.getComputedStyle(u).zIndex)},[u]);let E=m.useCallback(e=>{e&&!0===g.current&&(S(),w?.(),g.current=!1)},[S,w]);return(0,p.jsx)(iu,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:f,onScrollButtonChange:E,children:(0,p.jsx)("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:(0,p.jsx)(_.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});ia.displayName=is;var io="SelectPopperPosition",il=m.forwardRef((e,t)=>{let{__scopeSelect:n,align:r="start",collisionPadding:i=r8,...s}=e,a=rG(n);return(0,p.jsx)(nE,{...a,...s,ref:t,align:r,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});il.displayName=io;var[iu,ic]=r$(r9,{}),id="SelectViewport",ih=m.forwardRef((e,t)=>{let{__scopeSelect:n,nonce:r,...i}=e,s=it(id,n),a=ic(id,n),o=(0,B.e)(t,s.onViewportChange),l=m.useRef(0);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),(0,p.jsx)(rz.Slot,{scope:n,children:(0,p.jsx)(_.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:M(i.onScroll,e=>{let t=e.currentTarget,{contentWrapper:n,shouldExpandOnScrollRef:r}=a;if(r?.current&&n){let e=Math.abs(l.current-t.scrollTop);if(e>0){let r=window.innerHeight-2*r8,i=Math.max(parseFloat(n.style.minHeight),parseFloat(n.style.height));if(i<r){let s=i+e,a=Math.min(r,s),o=s-a;n.style.height=a+"px","0px"===n.style.bottom&&(t.scrollTop=o>0?o:0,n.style.justifyContent="flex-end")}}}l.current=t.scrollTop})})})]})});ih.displayName=id;var ip="SelectGroup",[im,ig]=r$(ip);m.forwardRef((e,t)=>{let{__scopeSelect:n,...r}=e,i=eT();return(0,p.jsx)(im,{scope:n,id:i,children:(0,p.jsx)(_.div,{role:"group","aria-labelledby":i,...r,ref:t})})}).displayName=ip;var iy="SelectLabel",iv=m.forwardRef((e,t)=>{let{__scopeSelect:n,...r}=e,i=ig(iy,n);return(0,p.jsx)(_.div,{id:i.id,...r,ref:t})});iv.displayName=iy;var ib="SelectItem",[iw,iS]=r$(ib),iT=m.forwardRef((e,t)=>{let{__scopeSelect:n,value:r,disabled:i=!1,textValue:s,...a}=e,o=rQ(ib,n),l=it(ib,n),u=o.value===r,[c,d]=m.useState(s??""),[h,f]=m.useState(!1),g=(0,B.e)(t,e=>l.itemRefCallback?.(e,r,i)),y=eT(),v=m.useRef("touch"),b=()=>{i||(o.onValueChange(r),o.onOpenChange(!1))};if(""===r)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,p.jsx)(iw,{scope:n,value:r,disabled:i,textId:y,isSelected:u,onItemTextChange:m.useCallback(e=>{d(t=>t||(e?.textContent??"").trim())},[]),children:(0,p.jsx)(rz.ItemSlot,{scope:n,value:r,disabled:i,textValue:c,children:(0,p.jsx)(_.div,{role:"option","aria-labelledby":y,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:g,onFocus:M(a.onFocus,()=>f(!0)),onBlur:M(a.onBlur,()=>f(!1)),onClick:M(a.onClick,()=>{"mouse"!==v.current&&b()}),onPointerUp:M(a.onPointerUp,()=>{"mouse"===v.current&&b()}),onPointerDown:M(a.onPointerDown,e=>{v.current=e.pointerType}),onPointerMove:M(a.onPointerMove,e=>{v.current=e.pointerType,i?l.onItemLeave?.():"mouse"===v.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:M(a.onPointerLeave,e=>{e.currentTarget===document.activeElement&&l.onItemLeave?.()}),onKeyDown:M(a.onKeyDown,e=>{l.searchRef?.current!==""&&" "===e.key||(rV.includes(e.key)&&b()," "===e.key&&e.preventDefault())})})})})});iT.displayName=ib;var iC="SelectItemText",iE=m.forwardRef((e,t)=>{let{__scopeSelect:n,className:r,style:i,...s}=e,a=rQ(iC,n),o=it(iC,n),l=iS(iC,n),u=rJ(iC,n),[c,d]=m.useState(null),h=(0,B.e)(t,e=>d(e),l.onItemTextChange,e=>o.itemTextRefCallback?.(e,l.value,l.disabled)),f=c?.textContent,g=m.useMemo(()=>(0,p.jsx)("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=u;return eb(()=>(y(g),()=>v(g)),[y,v,g]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(_.span,{id:l.textId,...s,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?E.createPortal(s.children,a.valueNode):null]})});iE.displayName=iC;var ix="SelectItemIndicator",i_=m.forwardRef((e,t)=>{let{__scopeSelect:n,...r}=e;return iS(ix,n).isSelected?(0,p.jsx)(_.span,{"aria-hidden":!0,...r,ref:t}):null});i_.displayName=ix;var iI="SelectScrollUpButton",ik=m.forwardRef((e,t)=>{let n=it(iI,e.__scopeSelect),r=ic(iI,e.__scopeSelect),[i,s]=m.useState(!1),a=(0,B.e)(t,r.onScrollButtonChange);return eb(()=>{if(n.viewport&&n.isPositioned){let e=function(){s(t.scrollTop>0)},t=n.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[n.viewport,n.isPositioned]),i?(0,p.jsx)(iN,{...e,ref:a,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=n;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});ik.displayName=iI;var iD="SelectScrollDownButton",iR=m.forwardRef((e,t)=>{let n=it(iD,e.__scopeSelect),r=ic(iD,e.__scopeSelect),[i,s]=m.useState(!1),a=(0,B.e)(t,r.onScrollButtonChange);return eb(()=>{if(n.viewport&&n.isPositioned){let e=function(){let e=t.scrollHeight-t.clientHeight;s(Math.ceil(t.scrollTop)<e)},t=n.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[n.viewport,n.isPositioned]),i?(0,p.jsx)(iN,{...e,ref:a,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=n;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});iR.displayName=iD;var iN=m.forwardRef((e,t)=>{let{__scopeSelect:n,onAutoScroll:r,...i}=e,s=it("SelectScrollButton",n),a=m.useRef(null),o=rq(n),l=m.useCallback(()=>{null!==a.current&&(window.clearInterval(a.current),a.current=null)},[]);return m.useEffect(()=>()=>l(),[l]),eb(()=>{let e=o().find(e=>e.ref.current===document.activeElement);e?.ref.current?.scrollIntoView({block:"nearest"})},[o]),(0,p.jsx)(_.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:M(i.onPointerDown,()=>{null===a.current&&(a.current=window.setInterval(r,50))}),onPointerMove:M(i.onPointerMove,()=>{s.onItemLeave?.(),null===a.current&&(a.current=window.setInterval(r,50))}),onPointerLeave:M(i.onPointerLeave,()=>{l()})})}),iA="SelectSeparator",iO=m.forwardRef((e,t)=>{let{__scopeSelect:n,...r}=e;return(0,p.jsx)(_.div,{"aria-hidden":!0,...r,ref:t})});iO.displayName=iA;var iM="SelectArrow";function iP(e){return""===e||void 0===e}m.forwardRef((e,t)=>{let{__scopeSelect:n,...r}=e,i=rG(n),s=rQ(iM,n),a=it(iM,n);return s.open&&"popper"===a.position?(0,p.jsx)(nx,{...i,...r,ref:t}):null}).displayName=iM;var iL=m.forwardRef((e,t)=>{let{value:n,...r}=e,i=m.useRef(null),s=(0,B.e)(t,i),a=nR(n);return m.useEffect(()=>{let e=i.current,t=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(a!==n&&t){let r=new Event("change",{bubbles:!0});t.call(e,n),e.dispatchEvent(r)}},[a,n]),(0,p.jsx)(nA,{asChild:!0,children:(0,p.jsx)("select",{...r,ref:s,defaultValue:n})})});function iB(e){let t=U(e),n=m.useRef(""),r=m.useRef(0),i=m.useCallback(e=>{let i=n.current+e;t(i),function e(t){n.current=t,window.clearTimeout(r.current),""!==t&&(r.current=window.setTimeout(()=>e(""),1e3))}(i)},[t]),s=m.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return m.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,s]}function iF(e,t,n){let r=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,i=n?e.indexOf(n):-1,s=ij(e,Math.max(i,0));1===r.length&&(s=s.filter(e=>e!==n));let a=s.find(e=>e.textValue.toLowerCase().startsWith(r.toLowerCase()));return a!==n?a:void 0}function ij(e,t){return e.map((n,r)=>e[(t+r)%e.length])}iL.displayName="BubbleSelect";var iV=rX,iU=r0,iz=r2,iq=r3,iW=r5,i$=r7,iH=ih,iG=iv,iK=iT,iQ=iE,iY=i_,iJ=ik,iX=iR,iZ=iO;let i0=(0,y.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),i1=(0,y.Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),i2=(0,y.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),i4=iV,i3=iz,i6=m.forwardRef(({className:e,children:t,...n},r)=>(0,p.jsxs)(iU,{ref:r,className:(0,T.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,p.jsx(iq,{asChild:!0,children:p.jsx(i0,{className:"h-4 w-4 opacity-50"})})]}));i6.displayName=iU.displayName;let i5=m.forwardRef(({className:e,...t},n)=>p.jsx(iJ,{ref:n,className:(0,T.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:p.jsx(i1,{className:"h-4 w-4"})}));i5.displayName=iJ.displayName;let i9=m.forwardRef(({className:e,...t},n)=>p.jsx(iX,{ref:n,className:(0,T.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:p.jsx(i0,{className:"h-4 w-4"})}));i9.displayName=iX.displayName;let i7=m.forwardRef(({className:e,children:t,position:n="popper",...r},i)=>p.jsx(iW,{children:(0,p.jsxs)(i$,{ref:i,className:(0,T.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[p.jsx(i5,{}),p.jsx(iH,{className:(0,T.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),p.jsx(i9,{})]})}));i7.displayName=i$.displayName,m.forwardRef(({className:e,...t},n)=>p.jsx(iG,{ref:n,className:(0,T.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=iG.displayName;let i8=m.forwardRef(({className:e,children:t,...n},r)=>(0,p.jsxs)(iK,{ref:r,className:(0,T.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(iY,{children:p.jsx(i2,{className:"h-4 w-4"})})}),p.jsx(iQ,{children:t})]}));i8.displayName=iK.displayName,m.forwardRef(({className:e,...t},n)=>p.jsx(iZ,{ref:n,className:(0,T.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=iZ.displayName;var se=n(44064),st=n.n(se);function sn(){return(0,p.jsxs)("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:"text-2xl font-bold text-pink-600",children:"Katy Silva"}),p.jsx("span",{className:"text-lg font-semibold text-gray-600",children:"Nail Designer"})]})}let sr=(0,y.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),si=(0,y.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ss={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},sa=(e,t,n)=>{let r;let i=ss[e];return(r="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),n?.addSuffix)?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function so(e){return (t={})=>{let n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}let sl={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},su={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},sc={date:so({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:so({formats:sl,defaultWidth:"full"}),dateTime:so({formats:su,defaultWidth:"full"})},sd={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},sh=(e,t,n,r)=>sd[e];function sf(e){return(t,n)=>{let r;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){let t=e.defaultFormattingWidth||e.defaultWidth,i=n?.width?String(n.width):t;r=e.formattingValues[i]||e.formattingValues[t]}else{let t=e.defaultWidth,i=n?.width?String(n.width):e.defaultWidth;r=e.values[i]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}let sp={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},sm={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},sg={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sy={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},sv={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},sb={ordinalNumber:(e,t)=>{let n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:sf({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:sf({values:sp,defaultWidth:"wide",argumentCallback:e=>e-1}),month:sf({values:sm,defaultWidth:"wide"}),day:sf({values:sg,defaultWidth:"wide"}),dayPeriod:sf({values:sy,defaultWidth:"wide",formattingValues:sv,defaultFormattingWidth:"wide"})};function sw(e){return(t,n={})=>{let r;let i=n.width,s=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;let o=a[0],l=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(l)?sT(l,e=>e.test(o)):sS(l,e=>e.test(o));return r=e.valueCallback?e.valueCallback(u):u,{value:r=n.valueCallback?n.valueCallback(r):r,rest:t.slice(o.length)}}}function sS(e,t){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function sT(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}let sC={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},sE={any:[/^b/i,/^(a|c)/i]},sx={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},s_={any:[/1/i,/2/i,/3/i,/4/i]},sI={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},sk={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},sD={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sR={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},sN={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},sA={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},sO={code:"en-US",formatDistance:sa,formatLong:sc,formatRelative:sh,localize:sb,match:{ordinalNumber:function(e){return(t,n={})=>{let r=t.match(e.matchPattern);if(!r)return null;let i=r[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];return{value:a=n.valueCallback?n.valueCallback(a):a,rest:t.slice(i.length)}}}({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:sw({matchPatterns:sC,defaultMatchWidth:"wide",parsePatterns:sE,defaultParseWidth:"any"}),quarter:sw({matchPatterns:sx,defaultMatchWidth:"wide",parsePatterns:s_,defaultParseWidth:"any",valueCallback:e=>e+1}),month:sw({matchPatterns:sI,defaultMatchWidth:"wide",parsePatterns:sk,defaultParseWidth:"any"}),day:sw({matchPatterns:sD,defaultMatchWidth:"wide",parsePatterns:sR,defaultParseWidth:"any"}),dayPeriod:sw({matchPatterns:sN,defaultMatchWidth:"any",parsePatterns:sA,defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},sM={};function sP(){return sM}let sL=6048e5,sB=864e5;function sF(e){let t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):new Date("number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?e:NaN)}function sj(e){let t=sF(e);return t.setHours(0,0,0,0),t}function sV(e){let t=sF(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function sU(e,t){let n=sj(e),r=sj(t);return Math.round((+n-sV(n)-(+r-sV(r)))/sB)}function sz(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function sq(e){let t=sF(e),n=sz(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function sW(e){let t=sF(e);return sU(t,sq(t))+1}function s$(e,t){let n=sP(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,i=sF(e),s=i.getDay(),a=(s<r?7:0)+s-r;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function sH(e){return s$(e,{weekStartsOn:1})}function sG(e){let t=sF(e),n=t.getFullYear(),r=sz(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);let i=sH(r),s=sz(e,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);let a=sH(s);return t.getTime()>=i.getTime()?n+1:t.getTime()>=a.getTime()?n:n-1}function sK(e){let t=sG(e),n=sz(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),sH(n)}function sQ(e){let t=sF(e);return Math.round((+sH(t)-+sK(t))/sL)+1}function sY(e,t){let n=sF(e),r=n.getFullYear(),i=sP(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,a=sz(e,0);a.setFullYear(r+1,0,s),a.setHours(0,0,0,0);let o=s$(a,t),l=sz(e,0);l.setFullYear(r,0,s),l.setHours(0,0,0,0);let u=s$(l,t);return n.getTime()>=o.getTime()?r+1:n.getTime()>=u.getTime()?r:r-1}function sJ(e,t){let n=sP(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,i=sY(e,t),s=sz(e,0);return s.setFullYear(i,0,r),s.setHours(0,0,0,0),s$(s,t)}function sX(e,t){let n=sF(e);return Math.round((+s$(n,t)-+sJ(n,t))/sL)+1}function sZ(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}let s0={y(e,t){let n=e.getFullYear(),r=n>0?n:1-n;return sZ("yy"===t?r%100:r,t.length)},M(e,t){let n=e.getMonth();return"M"===t?String(n+1):sZ(n+1,2)},d:(e,t)=>sZ(e.getDate(),t.length),a(e,t){let n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>sZ(e.getHours()%12||12,t.length),H:(e,t)=>sZ(e.getHours(),t.length),m:(e,t)=>sZ(e.getMinutes(),t.length),s:(e,t)=>sZ(e.getSeconds(),t.length),S(e,t){let n=t.length;return sZ(Math.trunc(e.getMilliseconds()*Math.pow(10,n-3)),t.length)}},s1={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},s2={G:function(e,t,n){let r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){let t=e.getFullYear(),r=t>0?t:1-t;return n.ordinalNumber(r,{unit:"year"})}return s0.y(e,t)},Y:function(e,t,n,r){let i=sY(e,r),s=i>0?i:1-i;return"YY"===t?sZ(s%100,2):"Yo"===t?n.ordinalNumber(s,{unit:"year"}):sZ(s,t.length)},R:function(e,t){return sZ(sG(e),t.length)},u:function(e,t){return sZ(e.getFullYear(),t.length)},Q:function(e,t,n){let r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return sZ(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){let r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return sZ(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){let r=e.getMonth();switch(t){case"M":case"MM":return s0.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){let r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return sZ(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){let i=sX(e,r);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):sZ(i,t.length)},I:function(e,t,n){let r=sQ(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):sZ(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):s0.d(e,t)},D:function(e,t,n){let r=sW(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):sZ(r,t.length)},E:function(e,t,n){let r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){let i=e.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return sZ(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){let i=e.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return sZ(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){let r=e.getDay(),i=0===r?7:r;switch(t){case"i":return String(i);case"ii":return sZ(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){let r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){let r;let i=e.getHours();switch(r=12===i?s1.noon:0===i?s1.midnight:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){let r;let i=e.getHours();switch(r=i>=17?s1.evening:i>=12?s1.afternoon:i>=4?s1.morning:s1.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return s0.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):s0.H(e,t)},K:function(e,t,n){let r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):sZ(r,t.length)},k:function(e,t,n){let r=e.getHours();return(0===r&&(r=24),"ko"===t)?n.ordinalNumber(r,{unit:"hour"}):sZ(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):s0.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):s0.s(e,t)},S:function(e,t){return s0.S(e,t)},X:function(e,t,n){let r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return s3(r);case"XXXX":case"XX":return s6(r);default:return s6(r,":")}},x:function(e,t,n){let r=e.getTimezoneOffset();switch(t){case"x":return s3(r);case"xxxx":case"xx":return s6(r);default:return s6(r,":")}},O:function(e,t,n){let r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+s4(r,":");default:return"GMT"+s6(r,":")}},z:function(e,t,n){let r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+s4(r,":");default:return"GMT"+s6(r,":")}},t:function(e,t,n){return sZ(Math.trunc(e.getTime()/1e3),t.length)},T:function(e,t,n){return sZ(e.getTime(),t.length)}};function s4(e,t=""){let n=e>0?"-":"+",r=Math.abs(e),i=Math.trunc(r/60),s=r%60;return 0===s?n+String(i):n+String(i)+t+sZ(s,2)}function s3(e,t){return e%60==0?(e>0?"-":"+")+sZ(Math.abs(e)/60,2):s6(e,t)}function s6(e,t=""){let n=e>0?"-":"+",r=Math.abs(e);return n+sZ(Math.trunc(r/60),2)+t+sZ(r%60,2)}let s5=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},s9=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},s7=(e,t)=>{let n;let r=e.match(/(P+)(p+)?/)||[],i=r[1],s=r[2];if(!s)return s5(e,t);switch(i){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",s5(i,t)).replace("{{time}}",s9(s,t))},s8={p:s9,P:s7},ae=/^D+$/,at=/^Y+$/,an=["D","DD","YY","YYYY"];function ar(e){return ae.test(e)}function ai(e){return at.test(e)}function as(e,t,n){let r=aa(e,t,n);if(console.warn(r),an.includes(e))throw RangeError(r)}function aa(e,t,n){let r="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function ao(e){return e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function al(e){return(!!ao(e)||"number"==typeof e)&&!isNaN(Number(sF(e)))}let au=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ac=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ad=/^'([^]*?)'?$/,ah=/''/g,af=/[a-zA-Z]/;function ap(e,t,n){let r=sP(),i=n?.locale??r.locale??sO,s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=sF(e);if(!al(o))throw RangeError("Invalid time value");let l=t.match(ac).map(e=>{let t=e[0];return"p"===t||"P"===t?(0,s8[t])(e,i.formatLong):e}).join("").match(au).map(e=>{if("''"===e)return{isToken:!1,value:"'"};let t=e[0];if("'"===t)return{isToken:!1,value:am(e)};if(s2[t])return{isToken:!0,value:e};if(t.match(af))throw RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));let u={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return l.map(r=>{if(!r.isToken)return r.value;let s=r.value;return(!n?.useAdditionalWeekYearTokens&&ai(s)||!n?.useAdditionalDayOfYearTokens&&ar(s))&&as(s,t,String(e)),(0,s2[s[0]])(o,s,i.localize,u)}).join("")}function am(e){let t=e.match(ad);return t?t[1].replace(ah,"'"):e}function ag(e){let t=sF(e);return t.setDate(1),t.setHours(0,0,0,0),t}function ay(e){let t=sF(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function av(e,t){let n=sF(e),r=sF(t);return n.getFullYear()===r.getFullYear()}function ab(e){let t=sF(e),n=t.getFullYear(),r=t.getMonth(),i=sz(e,0);return i.setFullYear(n,r+1,0),i.setHours(0,0,0,0),i.getDate()}function aw(e,t){let n=sF(e),r=n.getFullYear(),i=n.getDate(),s=sz(e,0);s.setFullYear(r,t,15),s.setHours(0,0,0,0);let a=ab(s);return n.setMonth(t,Math.min(i,a)),n}function aS(e,t){let n=sF(e);return isNaN(+n)?sz(e,NaN):(n.setFullYear(t),n)}function aT(e,t){let n=sF(e),r=sF(t);return 12*(n.getFullYear()-r.getFullYear())+(n.getMonth()-r.getMonth())}function aC(e,t){let n=sF(e);if(isNaN(t))return sz(e,NaN);if(!t)return n;let r=n.getDate(),i=sz(e,n.getTime());return(i.setMonth(n.getMonth()+t+1,0),r>=i.getDate())?i:(n.setFullYear(i.getFullYear(),i.getMonth(),r),n)}function aE(e,t){let n=sF(e),r=sF(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function ax(e,t){return+sF(e)<+sF(t)}function a_(e,t){let n=sF(e);return isNaN(t)?sz(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function aI(e,t){return+sj(e)==+sj(t)}function ak(e,t){let n=sF(e),r=sF(t);return n.getTime()>r.getTime()}function aD(e,t){return a_(e,-t)}function aR(e,t){return a_(e,7*t)}function aN(e,t){return aC(e,12*t)}function aA(e,t){let n=sP(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,i=sF(e),s=i.getDay(),a=(s<r?-7:0)+6-(s-r);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}function aO(e){return aA(e,{weekStartsOn:1})}function aM(e){let t;return e.forEach(function(e){let n=sF(e);(void 0===t||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function aP(e){let t;return e.forEach(e=>{let n=sF(e);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function aL(e){return Math.trunc(+sF(e)/1e3)}function aB(e,t,n){let r=s$(e,n),i=s$(t,n);return Math.round((+r-sV(r)-(+i-sV(i)))/sL)}function aF(e){let t=sF(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function aj(e,t){return aB(aF(e),ag(e),t)+1}var aV=function(){return(aV=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function aU(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function az(e,t,n){if(n||2==arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function aq(e){return"multiple"===e.mode}function aW(e){return"range"===e.mode}function a$(e){return"single"===e.mode}"function"==typeof SuppressedError&&SuppressedError;var aH={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"},aG=Object.freeze({__proto__:null,formatCaption:function(e,t){return ap(e,"LLLL y",t)},formatDay:function(e,t){return ap(e,"d",t)},formatMonthCaption:function(e,t){return ap(e,"LLLL",t)},formatWeekNumber:function(e){return"".concat(e)},formatWeekdayName:function(e,t){return ap(e,"cccccc",t)},formatYearCaption:function(e,t){return ap(e,"yyyy",t)}}),aK=Object.freeze({__proto__:null,labelDay:function(e,t,n){return ap(e,"do MMMM (EEEE)",n)},labelMonthDropdown:function(){return"Month: "},labelNext:function(){return"Go to next month"},labelPrevious:function(){return"Go to previous month"},labelWeekNumber:function(e){return"Week n. ".concat(e)},labelWeekday:function(e,t){return ap(e,"cccc",t)},labelYearDropdown:function(){return"Year: "}});function aQ(){return{captionLayout:"buttons",classNames:aH,formatters:aG,labels:aK,locale:sO,modifiersClassNames:{},modifiers:{},numberOfMonths:1,styles:{},today:new Date,mode:"default"}}function aY(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,i=e.toMonth,s=e.fromDate,a=e.toDate;return r?s=ag(r):t&&(s=new Date(t,0,1)),i?a=ay(i):n&&(a=new Date(n,11,31)),{fromDate:s?sj(s):void 0,toDate:a?sj(a):void 0}}var aJ=(0,m.createContext)(void 0);function aX(e){var t,n,r=e.initialProps,i=aQ(),s=aY(r),a=s.fromDate,o=s.toDate,l=null!==(t=r.captionLayout)&&void 0!==t?t:i.captionLayout;"buttons"===l||a&&o||(l="buttons"),(a$(r)||aq(r)||aW(r))&&(n=r.onSelect);var u=aV(aV(aV({},i),r),{captionLayout:l,classNames:aV(aV({},i.classNames),r.classNames),components:aV({},r.components),formatters:aV(aV({},i.formatters),r.formatters),fromDate:a,labels:aV(aV({},i.labels),r.labels),mode:r.mode||i.mode,modifiers:aV(aV({},i.modifiers),r.modifiers),modifiersClassNames:aV(aV({},i.modifiersClassNames),r.modifiersClassNames),onSelect:n,styles:aV(aV({},i.styles),r.styles),toDate:o});return(0,p.jsx)(aJ.Provider,{value:u,children:e.children})}function aZ(){var e=(0,m.useContext)(aJ);if(!e)throw Error("useDayPicker must be used within a DayPickerProvider.");return e}function a0(e){var t=aZ(),n=t.locale,r=t.classNames,i=t.styles,s=t.formatters.formatCaption;return(0,p.jsx)("div",{className:r.caption_label,style:i.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:n})})}function a1(e){return(0,p.jsx)("svg",aV({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:(0,p.jsx)("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function a2(e){var t,n,r=e.onChange,i=e.value,s=e.children,a=e.caption,o=e.className,l=e.style,u=aZ(),c=null!==(n=null===(t=u.components)||void 0===t?void 0:t.IconDropdown)&&void 0!==n?n:a1;return(0,p.jsxs)("div",{className:o,style:l,children:[(0,p.jsx)("span",{className:u.classNames.vhidden,children:e["aria-label"]}),(0,p.jsx)("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:i,onChange:r,children:s}),(0,p.jsxs)("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[a,(0,p.jsx)(c,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function a4(e){var t,n=aZ(),r=n.fromDate,i=n.toDate,s=n.styles,a=n.locale,o=n.formatters.formatMonthCaption,l=n.classNames,u=n.components,c=n.labels.labelMonthDropdown;if(!r||!i)return(0,p.jsx)(p.Fragment,{});var d=[];if(av(r,i))for(var h=ag(r),f=r.getMonth();f<=i.getMonth();f++)d.push(aw(h,f));else for(var h=ag(new Date),f=0;f<=11;f++)d.push(aw(h,f));var m=function(t){var n=Number(t.target.value),r=aw(ag(e.displayMonth),n);e.onChange(r)},g=null!==(t=null==u?void 0:u.Dropdown)&&void 0!==t?t:a2;return(0,p.jsx)(g,{name:"months","aria-label":c(),className:l.dropdown_month,style:s.dropdown_month,onChange:m,value:e.displayMonth.getMonth(),caption:o(e.displayMonth,{locale:a}),children:d.map(function(e){return(0,p.jsx)("option",{value:e.getMonth(),children:o(e,{locale:a})},e.getMonth())})})}function a3(e){var t,n=e.displayMonth,r=aZ(),i=r.fromDate,s=r.toDate,a=r.locale,o=r.styles,l=r.classNames,u=r.components,c=r.formatters.formatYearCaption,d=r.labels.labelYearDropdown,h=[];if(!i||!s)return(0,p.jsx)(p.Fragment,{});for(var f=i.getFullYear(),m=s.getFullYear(),g=f;g<=m;g++)h.push(aS(sq(new Date),g));var y=function(t){var r=aS(ag(n),Number(t.target.value));e.onChange(r)},v=null!==(t=null==u?void 0:u.Dropdown)&&void 0!==t?t:a2;return(0,p.jsx)(v,{name:"years","aria-label":d(),className:l.dropdown_year,style:o.dropdown_year,onChange:y,value:n.getFullYear(),caption:c(n,{locale:a}),children:h.map(function(e){return(0,p.jsx)("option",{value:e.getFullYear(),children:c(e,{locale:a})},e.getFullYear())})})}function a6(e,t){var n=(0,m.useState)(e),r=n[0];return[void 0===t?r:t,n[1]]}function a5(e){var t=e.month,n=e.defaultMonth,r=e.today,i=t||n||r||new Date,s=e.toDate,a=e.fromDate,o=e.numberOfMonths,l=void 0===o?1:o;return s&&0>aT(s,i)&&(i=aC(s,-1*(l-1))),a&&0>aT(i,a)&&(i=a),ag(i)}function a9(){var e=aZ(),t=a6(a5(e),e.month),n=t[0],r=t[1];return[n,function(t){if(!e.disableNavigation){var n,i=ag(t);r(i),null===(n=e.onMonthChange)||void 0===n||n.call(e,i)}}]}function a7(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,i=ag(e),s=aT(ag(aC(i,r)),i),a=[],o=0;o<s;o++){var l=aC(i,o);a.push(l)}return n&&(a=a.reverse()),a}function a8(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,i=t.numberOfMonths,s=void 0===i?1:i,a=r?s:1,o=ag(e);if(!n||!(aT(n,e)<s))return aC(o,a)}}function oe(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,i=t.numberOfMonths,s=void 0===i?1:i,a=r?s:1,o=ag(e);if(!n||!(0>=aT(o,n)))return aC(o,-a)}}var ot=(0,m.createContext)(void 0);function on(e){var t=aZ(),n=a9(),r=n[0],i=n[1],s=a7(r,t),a=a8(r,t),o=oe(r,t),l=function(e){return s.some(function(t){return aE(e,t)})},u=function(e,n){l(e)||(n&&ax(e,n)?i(aC(e,1+-1*t.numberOfMonths)):i(e))},c={currentMonth:r,displayMonths:s,goToMonth:i,goToDate:u,previousMonth:o,nextMonth:a,isDateDisplayed:l};return(0,p.jsx)(ot.Provider,{value:c,children:e.children})}function or(){var e=(0,m.useContext)(ot);if(!e)throw Error("useNavigation must be used within a NavigationProvider");return e}function oi(e){var t,n=aZ(),r=n.classNames,i=n.styles,s=n.components,a=or().goToMonth,o=function(t){a(aC(t,e.displayIndex?-e.displayIndex:0))},l=null!==(t=null==s?void 0:s.CaptionLabel)&&void 0!==t?t:a0,u=(0,p.jsx)(l,{id:e.id,displayMonth:e.displayMonth});return(0,p.jsxs)("div",{className:r.caption_dropdowns,style:i.caption_dropdowns,children:[(0,p.jsx)("div",{className:r.vhidden,children:u}),(0,p.jsx)(a4,{onChange:o,displayMonth:e.displayMonth}),(0,p.jsx)(a3,{onChange:o,displayMonth:e.displayMonth})]})}function os(e){return(0,p.jsx)("svg",aV({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:(0,p.jsx)("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function oa(e){return(0,p.jsx)("svg",aV({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:(0,p.jsx)("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var oo=(0,m.forwardRef)(function(e,t){var n=aZ(),r=n.classNames,i=n.styles,s=[r.button_reset,r.button];e.className&&s.push(e.className);var a=s.join(" "),o=aV(aV({},i.button_reset),i.button);return e.style&&Object.assign(o,e.style),(0,p.jsx)("button",aV({},e,{ref:t,type:"button",className:a,style:o}))});function ol(e){var t,n,r=aZ(),i=r.dir,s=r.locale,a=r.classNames,o=r.styles,l=r.labels,u=l.labelPrevious,c=l.labelNext,d=r.components;if(!e.nextMonth&&!e.previousMonth)return(0,p.jsx)(p.Fragment,{});var h=u(e.previousMonth,{locale:s}),f=[a.nav_button,a.nav_button_previous].join(" "),m=c(e.nextMonth,{locale:s}),g=[a.nav_button,a.nav_button_next].join(" "),y=null!==(t=null==d?void 0:d.IconRight)&&void 0!==t?t:oa,v=null!==(n=null==d?void 0:d.IconLeft)&&void 0!==n?n:os;return(0,p.jsxs)("div",{className:a.nav,style:o.nav,children:[!e.hidePrevious&&(0,p.jsx)(oo,{name:"previous-month","aria-label":h,className:f,style:o.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:"rtl"===i?(0,p.jsx)(y,{className:a.nav_icon,style:o.nav_icon}):(0,p.jsx)(v,{className:a.nav_icon,style:o.nav_icon})}),!e.hideNext&&(0,p.jsx)(oo,{name:"next-month","aria-label":m,className:g,style:o.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:"rtl"===i?(0,p.jsx)(v,{className:a.nav_icon,style:o.nav_icon}):(0,p.jsx)(y,{className:a.nav_icon,style:o.nav_icon})})]})}function ou(e){var t=aZ().numberOfMonths,n=or(),r=n.previousMonth,i=n.nextMonth,s=n.goToMonth,a=n.displayMonths,o=a.findIndex(function(t){return aE(e.displayMonth,t)}),l=0===o,u=o===a.length-1,c=t>1&&(l||!u),d=t>1&&(u||!l),h=function(){r&&s(r)},f=function(){i&&s(i)};return(0,p.jsx)(ol,{displayMonth:e.displayMonth,hideNext:c,hidePrevious:d,nextMonth:i,previousMonth:r,onPreviousClick:h,onNextClick:f})}function oc(e){var t,n,r=aZ(),i=r.classNames,s=r.disableNavigation,a=r.styles,o=r.captionLayout,l=r.components,u=null!==(t=null==l?void 0:l.CaptionLabel)&&void 0!==t?t:a0;return n=s?(0,p.jsx)(u,{id:e.id,displayMonth:e.displayMonth}):"dropdown"===o?(0,p.jsx)(oi,{displayMonth:e.displayMonth,id:e.id}):"dropdown-buttons"===o?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(oi,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),(0,p.jsx)(ou,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),(0,p.jsx)(ou,{displayMonth:e.displayMonth,id:e.id})]}),(0,p.jsx)("div",{className:i.caption,style:a.caption,children:n})}function od(e){var t=aZ(),n=t.footer,r=t.styles,i=t.classNames.tfoot;return n?(0,p.jsx)("tfoot",{className:i,style:r.tfoot,children:(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,children:n})})}):(0,p.jsx)(p.Fragment,{})}function oh(e,t,n){for(var r=n?sH(new Date):s$(new Date,{locale:e,weekStartsOn:t}),i=[],s=0;s<7;s++){var a=a_(r,s);i.push(a)}return i}function of(){var e=aZ(),t=e.classNames,n=e.styles,r=e.showWeekNumber,i=e.locale,s=e.weekStartsOn,a=e.ISOWeek,o=e.formatters.formatWeekdayName,l=e.labels.labelWeekday,u=oh(i,s,a);return(0,p.jsxs)("tr",{style:n.head_row,className:t.head_row,children:[r&&(0,p.jsx)("td",{style:n.head_cell,className:t.head_cell}),u.map(function(e,r){return(0,p.jsx)("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":l(e,{locale:i}),children:o(e,{locale:i})},r)})]})}function op(){var e,t=aZ(),n=t.classNames,r=t.styles,i=t.components,s=null!==(e=null==i?void 0:i.HeadRow)&&void 0!==e?e:of;return(0,p.jsx)("thead",{style:r.head,className:n.head,children:(0,p.jsx)(s,{})})}function om(e){var t=aZ(),n=t.locale,r=t.formatters.formatDay;return(0,p.jsx)(p.Fragment,{children:r(e.date,{locale:n})})}var og=(0,m.createContext)(void 0);function oy(e){if(!aq(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return(0,p.jsx)(og.Provider,{value:t,children:e.children})}return(0,p.jsx)(ov,{initialProps:e.initialProps,children:e.children})}function ov(e){var t=e.initialProps,n=e.children,r=t.selected,i=t.min,s=t.max,a=function(e,n,a){if(null===(o=t.onDayClick)||void 0===o||o.call(t,e,n,a),(!n.selected||!i||(null==r?void 0:r.length)!==i)&&(n.selected||!s||(null==r?void 0:r.length)!==s)){var o,l,u=r?az([],r,!0):[];if(n.selected){var c=u.findIndex(function(t){return aI(e,t)});u.splice(c,1)}else u.push(e);null===(l=t.onSelect)||void 0===l||l.call(t,u,e,n,a)}},o={disabled:[]};r&&o.disabled.push(function(e){var t=s&&r.length>s-1,n=r.some(function(t){return aI(t,e)});return!!(t&&!n)});var l={selected:r,onDayClick:a,modifiers:o};return(0,p.jsx)(og.Provider,{value:l,children:n})}function ob(){var e=(0,m.useContext)(og);if(!e)throw Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function ow(e,t){var n=t||{},r=n.from,i=n.to;return r&&i?aI(i,e)&&aI(r,e)?void 0:aI(i,e)?{from:i,to:void 0}:aI(r,e)?void 0:ak(r,e)?{from:e,to:i}:{from:r,to:e}:i?ak(e,i)?{from:i,to:e}:{from:e,to:i}:r?ax(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var oS=(0,m.createContext)(void 0);function oT(e){if(!aW(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return(0,p.jsx)(oS.Provider,{value:t,children:e.children})}return(0,p.jsx)(oC,{initialProps:e.initialProps,children:e.children})}function oC(e){var t=e.initialProps,n=e.children,r=t.selected,i=r||{},s=i.from,a=i.to,o=t.min,l=t.max,u=function(e,n,i){null===(s=t.onDayClick)||void 0===s||s.call(t,e,n,i);var s,a,o=ow(e,r);null===(a=t.onSelect)||void 0===a||a.call(t,o,e,n,i)},c={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(c.range_start=[s],a?(c.range_end=[a],aI(s,a)||(c.range_middle=[{after:s,before:a}])):c.range_end=[s]):a&&(c.range_start=[a],c.range_end=[a]),o&&(s&&!a&&c.disabled.push({after:aD(s,o-1),before:a_(s,o-1)}),s&&a&&c.disabled.push({after:s,before:a_(s,o-1)}),!s&&a&&c.disabled.push({after:aD(a,o-1),before:a_(a,o-1)})),l){if(s&&!a&&(c.disabled.push({before:a_(s,-l+1)}),c.disabled.push({after:a_(s,l-1)})),s&&a){var d=l-(sU(a,s)+1);c.disabled.push({before:aD(s,d)}),c.disabled.push({after:a_(a,d)})}!s&&a&&(c.disabled.push({before:a_(a,-l+1)}),c.disabled.push({after:a_(a,l-1)}))}return(0,p.jsx)(oS.Provider,{value:{selected:r,onDayClick:u,modifiers:c},children:n})}function oE(){var e=(0,m.useContext)(oS);if(!e)throw Error("useSelectRange must be used within a SelectRangeProvider");return e}function ox(e){return Array.isArray(e)?az([],e,!0):void 0!==e?[e]:[]}function o_(e){var t={};return Object.entries(e).forEach(function(e){var n=e[0],r=e[1];t[n]=ox(r)}),t}!function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"}(l||(l={}));var oI=l.Selected,ok=l.Disabled,oD=l.Hidden,oR=l.Today,oN=l.RangeEnd,oA=l.RangeMiddle,oO=l.RangeStart,oM=l.Outside;function oP(e,t,n){var r,i=((r={})[oI]=ox(e.selected),r[ok]=ox(e.disabled),r[oD]=ox(e.hidden),r[oR]=[e.today],r[oN]=[],r[oA]=[],r[oO]=[],r[oM]=[],r);return e.fromDate&&i[ok].push({before:e.fromDate}),e.toDate&&i[ok].push({after:e.toDate}),aq(e)?i[ok]=i[ok].concat(t.modifiers[ok]):aW(e)&&(i[ok]=i[ok].concat(n.modifiers[ok]),i[oO]=n.modifiers[oO],i[oA]=n.modifiers[oA],i[oN]=n.modifiers[oN]),i}var oL=(0,m.createContext)(void 0);function oB(e){var t=aZ(),n=oP(t,ob(),oE()),r=o_(t.modifiers),i=aV(aV({},n),r);return(0,p.jsx)(oL.Provider,{value:i,children:e.children})}function oF(){var e=(0,m.useContext)(oL);if(!e)throw Error("useModifiers must be used within a ModifiersProvider");return e}function oj(e){return!!(e&&"object"==typeof e&&"before"in e&&"after"in e)}function oV(e){return!!(e&&"object"==typeof e&&"from"in e)}function oU(e){return!!(e&&"object"==typeof e&&"after"in e)}function oz(e){return!!(e&&"object"==typeof e&&"before"in e)}function oq(e){return!!(e&&"object"==typeof e&&"dayOfWeek"in e)}function oW(e,t){var n,r=t.from,i=t.to;return r&&i?(0>sU(i,r)&&(r=(n=[i,r])[0],i=n[1]),sU(e,r)>=0&&sU(i,e)>=0):i?aI(i,e):!!r&&aI(r,e)}function o$(e){return ao(e)}function oH(e){return Array.isArray(e)&&e.every(ao)}function oG(e,t){return t.some(function(t){if("boolean"==typeof t)return t;if(o$(t))return aI(e,t);if(oH(t))return t.includes(e);if(oV(t))return oW(e,t);if(oq(t))return t.dayOfWeek.includes(e.getDay());if(oj(t)){var n=sU(t.before,e),r=sU(t.after,e),i=n>0,s=r<0;return ak(t.before,t.after)?s&&i:i||s}return oU(t)?sU(e,t.after)>0:oz(t)?sU(t.before,e)>0:"function"==typeof t&&t(e)})}function oK(e,t,n){var r=Object.keys(t).reduce(function(n,r){return oG(e,t[r])&&n.push(r),n},[]),i={};return r.forEach(function(e){return i[e]=!0}),n&&!aE(e,n)&&(i.outside=!0),i}function oQ(e,t){for(var n,r,i=ag(e[0]),s=ay(e[e.length-1]),a=i;a<=s;){var o=oK(a,t);if(!(!o.disabled&&!o.hidden)){a=a_(a,1);continue}if(o.selected)return a;o.today&&!r&&(r=a),n||(n=a),a=a_(a,1)}return r||n}var oY=365;function oJ(e,t){var n=t.moveBy,r=t.direction,i=t.context,s=t.modifiers,a=t.retry,o=void 0===a?{count:0,lastFocused:e}:a,l=i.weekStartsOn,u=i.fromDate,c=i.toDate,d=i.locale,h=({day:a_,week:aR,month:aC,year:aN,startOfWeek:function(e){return i.ISOWeek?sH(e):s$(e,{locale:d,weekStartsOn:l})},endOfWeek:function(e){return i.ISOWeek?aO(e):aA(e,{locale:d,weekStartsOn:l})}})[n](e,"after"===r?1:-1);"before"===r&&u?h=aM([u,h]):"after"===r&&c&&(h=aP([c,h]));var f=!0;if(s){var p=oK(h,s);f=!p.disabled&&!p.hidden}return f?h:o.count>oY?o.lastFocused:oJ(h,{moveBy:n,direction:r,context:i,modifiers:s,retry:aV(aV({},o),{count:o.count+1})})}var oX=(0,m.createContext)(void 0);function oZ(e){var t=or(),n=oF(),r=(0,m.useState)(),i=r[0],s=r[1],a=(0,m.useState)(),o=a[0],l=a[1],u=oQ(t.displayMonths,n),c=(null!=i?i:o&&t.isDateDisplayed(o))?o:u,d=function(){l(i),s(void 0)},h=function(e){s(e)},f=aZ(),g=function(e,r){if(i){var s=oJ(i,{moveBy:e,direction:r,context:f,modifiers:n});aI(i,s)||(t.goToDate(s,i),h(s))}},y={focusedDay:i,focusTarget:c,blur:d,focus:h,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return(0,p.jsx)(oX.Provider,{value:y,children:e.children})}function o0(){var e=(0,m.useContext)(oX);if(!e)throw Error("useFocusContext must be used within a FocusProvider");return e}function o1(e,t){return oK(e,oF(),t)}var o2=(0,m.createContext)(void 0);function o4(e){if(!a$(e.initialProps)){var t={selected:void 0};return(0,p.jsx)(o2.Provider,{value:t,children:e.children})}return(0,p.jsx)(o3,{initialProps:e.initialProps,children:e.children})}function o3(e){var t=e.initialProps,n=e.children,r=function(e,n,r){var i,s,a;if(null===(i=t.onDayClick)||void 0===i||i.call(t,e,n,r),n.selected&&!t.required){null===(s=t.onSelect)||void 0===s||s.call(t,void 0,e,n,r);return}null===(a=t.onSelect)||void 0===a||a.call(t,e,e,n,r)},i={selected:t.selected,onDayClick:r};return(0,p.jsx)(o2.Provider,{value:i,children:n})}function o6(){var e=(0,m.useContext)(o2);if(!e)throw Error("useSelectSingle must be used within a SelectSingleProvider");return e}function o5(e,t){var n=aZ(),r=o6(),i=ob(),s=oE(),a=o0(),o=a.focusDayAfter,l=a.focusDayBefore,u=a.focusWeekAfter,c=a.focusWeekBefore,d=a.blur,h=a.focus,f=a.focusMonthBefore,p=a.focusMonthAfter,m=a.focusYearBefore,g=a.focusYearAfter,y=a.focusStartOfWeek,v=a.focusEndOfWeek;return{onClick:function(a){var o,l,u,c;a$(n)?null===(o=r.onDayClick)||void 0===o||o.call(r,e,t,a):aq(n)?null===(l=i.onDayClick)||void 0===l||l.call(i,e,t,a):aW(n)?null===(u=s.onDayClick)||void 0===u||u.call(s,e,t,a):null===(c=n.onDayClick)||void 0===c||c.call(n,e,t,a)},onFocus:function(r){var i;h(e),null===(i=n.onDayFocus)||void 0===i||i.call(n,e,t,r)},onBlur:function(r){var i;d(),null===(i=n.onDayBlur)||void 0===i||i.call(n,e,t,r)},onKeyDown:function(r){var i;switch(r.key){case"ArrowLeft":r.preventDefault(),r.stopPropagation(),"rtl"===n.dir?o():l();break;case"ArrowRight":r.preventDefault(),r.stopPropagation(),"rtl"===n.dir?l():o();break;case"ArrowDown":r.preventDefault(),r.stopPropagation(),u();break;case"ArrowUp":r.preventDefault(),r.stopPropagation(),c();break;case"PageUp":r.preventDefault(),r.stopPropagation(),r.shiftKey?m():f();break;case"PageDown":r.preventDefault(),r.stopPropagation(),r.shiftKey?g():p();break;case"Home":r.preventDefault(),r.stopPropagation(),y();break;case"End":r.preventDefault(),r.stopPropagation(),v()}null===(i=n.onDayKeyDown)||void 0===i||i.call(n,e,t,r)},onKeyUp:function(r){var i;null===(i=n.onDayKeyUp)||void 0===i||i.call(n,e,t,r)},onMouseEnter:function(r){var i;null===(i=n.onDayMouseEnter)||void 0===i||i.call(n,e,t,r)},onMouseLeave:function(r){var i;null===(i=n.onDayMouseLeave)||void 0===i||i.call(n,e,t,r)},onPointerEnter:function(r){var i;null===(i=n.onDayPointerEnter)||void 0===i||i.call(n,e,t,r)},onPointerLeave:function(r){var i;null===(i=n.onDayPointerLeave)||void 0===i||i.call(n,e,t,r)},onTouchCancel:function(r){var i;null===(i=n.onDayTouchCancel)||void 0===i||i.call(n,e,t,r)},onTouchEnd:function(r){var i;null===(i=n.onDayTouchEnd)||void 0===i||i.call(n,e,t,r)},onTouchMove:function(r){var i;null===(i=n.onDayTouchMove)||void 0===i||i.call(n,e,t,r)},onTouchStart:function(r){var i;null===(i=n.onDayTouchStart)||void 0===i||i.call(n,e,t,r)}}}function o9(){var e=aZ(),t=o6(),n=ob(),r=oE();return a$(e)?t.selected:aq(e)?n.selected:aW(e)?r.selected:void 0}function o7(e){return Object.values(l).includes(e)}function o8(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(t){var r=e.modifiersClassNames[t];if(r)n.push(r);else if(o7(t)){var i=e.classNames["day_".concat(t)];i&&n.push(i)}}),n}function le(e,t){var n=aV({},e.styles.day);return Object.keys(t).forEach(function(t){var r;n=aV(aV({},n),null===(r=e.modifiersStyles)||void 0===r?void 0:r[t])}),n}function lt(e,t,n){var r,i,s,a=aZ(),o=o0(),l=o1(e,t),u=o5(e,l),c=o9(),d=!!(a.onDayClick||"default"!==a.mode);(0,m.useEffect)(function(){var t;!l.outside&&o.focusedDay&&d&&aI(o.focusedDay,e)&&(null===(t=n.current)||void 0===t||t.focus())},[o.focusedDay,e,n,d,l.outside]);var h=o8(a,l).join(" "),f=le(a,l),g=!!(l.outside&&!a.showOutsideDays||l.hidden),y=null!==(s=null===(i=a.components)||void 0===i?void 0:i.DayContent)&&void 0!==s?s:om,v={style:f,className:h,children:(0,p.jsx)(y,{date:e,displayMonth:t,activeModifiers:l}),role:"gridcell"},b=o.focusTarget&&aI(o.focusTarget,e)&&!l.outside,w=o.focusedDay&&aI(o.focusedDay,e),S=aV(aV(aV({},v),((r={disabled:l.disabled,role:"gridcell"})["aria-selected"]=l.selected,r.tabIndex=w||b?0:-1,r)),u);return{isButton:d,isHidden:g,activeModifiers:l,selectedDays:c,buttonProps:S,divProps:v}}function ln(e){var t=(0,m.useRef)(null),n=lt(e.date,e.displayMonth,t);return n.isHidden?(0,p.jsx)("div",{role:"gridcell"}):n.isButton?(0,p.jsx)(oo,aV({name:"day",ref:t},n.buttonProps)):(0,p.jsx)("div",aV({},n.divProps))}function lr(e){var t=e.number,n=e.dates,r=aZ(),i=r.onWeekNumberClick,s=r.styles,a=r.classNames,o=r.locale,l=r.labels.labelWeekNumber,u=(0,r.formatters.formatWeekNumber)(Number(t),{locale:o});if(!i)return(0,p.jsx)("span",{className:a.weeknumber,style:s.weeknumber,children:u});var c=l(Number(t),{locale:o}),d=function(e){i(t,n,e)};return(0,p.jsx)(oo,{name:"week-number","aria-label":c,className:a.weeknumber,style:s.weeknumber,onClick:d,children:u})}function li(e){var t,n,r,i=aZ(),s=i.styles,a=i.classNames,o=i.showWeekNumber,l=i.components,u=null!==(t=null==l?void 0:l.Day)&&void 0!==t?t:ln,c=null!==(n=null==l?void 0:l.WeekNumber)&&void 0!==n?n:lr;return o&&(r=(0,p.jsx)("td",{className:a.cell,style:s.cell,children:(0,p.jsx)(c,{number:e.weekNumber,dates:e.dates})})),(0,p.jsxs)("tr",{className:a.row,style:s.row,children:[r,e.dates.map(function(t){return(0,p.jsx)("td",{className:a.cell,style:s.cell,role:"presentation",children:(0,p.jsx)(u,{displayMonth:e.displayMonth,date:t})},aL(t))})]})}function ls(e,t,n){for(var r=(null==n?void 0:n.ISOWeek)?aO(t):aA(t,n),i=(null==n?void 0:n.ISOWeek)?sH(e):s$(e,n),s=sU(r,i),a=[],o=0;o<=s;o++)a.push(a_(i,o));return a.reduce(function(e,t){var r=(null==n?void 0:n.ISOWeek)?sQ(t):sX(t,n),i=e.find(function(e){return e.weekNumber===r});return i?i.dates.push(t):e.push({weekNumber:r,dates:[t]}),e},[])}function la(e,t){var n=ls(ag(e),ay(e),t);if(null==t?void 0:t.useFixedWeeks){var r=aj(e,t);if(r<6){var i=n[n.length-1],s=i.dates[i.dates.length-1],a=aR(s,6-r),o=ls(aR(s,1),a,t);n.push.apply(n,o)}}return n}function lo(e){var t,n,r,i=aZ(),s=i.locale,a=i.classNames,o=i.styles,l=i.hideHead,u=i.fixedWeeks,c=i.components,d=i.weekStartsOn,h=i.firstWeekContainsDate,f=i.ISOWeek,m=la(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:f,locale:s,weekStartsOn:d,firstWeekContainsDate:h}),g=null!==(t=null==c?void 0:c.Head)&&void 0!==t?t:op,y=null!==(n=null==c?void 0:c.Row)&&void 0!==n?n:li,v=null!==(r=null==c?void 0:c.Footer)&&void 0!==r?r:od;return(0,p.jsxs)("table",{id:e.id,className:a.table,style:o.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!l&&(0,p.jsx)(g,{}),(0,p.jsx)("tbody",{className:a.tbody,style:o.tbody,children:m.map(function(t){return(0,p.jsx)(y,{displayMonth:e.displayMonth,dates:t.dates,weekNumber:t.weekNumber},t.weekNumber)})}),(0,p.jsx)(v,{displayMonth:e.displayMonth})]})}var ll=!function(){return!!("undefined"!=typeof window&&window.document&&window.document.createElement)}()?m.useEffect:m.useLayoutEffect,lu=!1,lc=0;function ld(){return"react-day-picker-".concat(++lc)}function lh(e){var t,n=null!=e?e:lu?ld():null,r=(0,m.useState)(n),i=r[0],s=r[1];return ll(function(){null===i&&s(ld())},[]),(0,m.useEffect)(function(){!1===lu&&(lu=!0)},[]),null!==(t=null!=e?e:i)&&void 0!==t?t:void 0}function lf(e){var t,n,r=aZ(),i=r.dir,s=r.classNames,a=r.styles,o=r.components,l=or().displayMonths,u=lh(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),c=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,d=[s.month],h=a.month,f=0===e.displayIndex,m=e.displayIndex===l.length-1,g=!f&&!m;"rtl"===i&&(m=(t=[f,m])[0],f=t[1]),f&&(d.push(s.caption_start),h=aV(aV({},h),a.caption_start)),m&&(d.push(s.caption_end),h=aV(aV({},h),a.caption_end)),g&&(d.push(s.caption_between),h=aV(aV({},h),a.caption_between));var y=null!==(n=null==o?void 0:o.Caption)&&void 0!==n?n:oc;return(0,p.jsxs)("div",{className:d.join(" "),style:h,children:[(0,p.jsx)(y,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),(0,p.jsx)(lo,{id:c,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function lp(e){var t=aZ(),n=t.classNames,r=t.styles;return(0,p.jsx)("div",{className:n.months,style:r.months,children:e.children})}function lm(e){var t,n,r=e.initialProps,i=aZ(),s=o0(),a=or(),o=(0,m.useState)(!1),l=o[0],u=o[1];(0,m.useEffect)(function(){i.initialFocus&&s.focusTarget&&(l||(s.focus(s.focusTarget),u(!0)))},[i.initialFocus,l,s.focus,s.focusTarget,s]);var c=[i.classNames.root,i.className];i.numberOfMonths>1&&c.push(i.classNames.multiple_months),i.showWeekNumber&&c.push(i.classNames.with_weeknumber);var d=aV(aV({},i.styles.root),i.style),h=Object.keys(r).filter(function(e){return e.startsWith("data-")}).reduce(function(e,t){var n;return aV(aV({},e),((n={})[t]=r[t],n))},{}),f=null!==(n=null===(t=r.components)||void 0===t?void 0:t.Months)&&void 0!==n?n:lp;return(0,p.jsx)("div",aV({className:c.join(" "),style:d,dir:i.dir,id:i.id,nonce:r.nonce,title:r.title,lang:r.lang},h,{children:(0,p.jsx)(f,{children:a.displayMonths.map(function(e,t){return(0,p.jsx)(lf,{displayIndex:t,displayMonth:e},t)})})}))}function lg(e){var t=e.children,n=aU(e,["children"]);return(0,p.jsx)(aX,{initialProps:n,children:(0,p.jsx)(on,{children:(0,p.jsx)(o4,{initialProps:n,children:(0,p.jsx)(oy,{initialProps:n,children:(0,p.jsx)(oT,{initialProps:n,children:(0,p.jsx)(oB,{children:(0,p.jsx)(oZ,{children:t})})})})})})})}function ly(e){return(0,p.jsx)(lg,aV({},e,{children:(0,p.jsx)(lm,{initialProps:e})}))}function lv({className:e,classNames:t,showOutsideDays:n=!0,...r}){return p.jsx(ly,{showOutsideDays:n,className:(0,T.cn)("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,T.cn)((0,w.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,T.cn)((0,w.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...e})=>p.jsx(sr,{className:"h-4 w-4"}),IconRight:({...e})=>p.jsx(si,{className:"h-4 w-4"})},...r})}function lb(e,t){return m.useReducer((e,n)=>t[e][n]??e,e)}lv.displayName="Calendar";var lw=e=>{let{present:t,children:n}=e,r=lS(t),i="function"==typeof n?n({present:r.isPresent}):m.Children.only(n),s=(0,B.e)(r.ref,lC(i));return"function"==typeof n||r.isPresent?m.cloneElement(i,{ref:s}):null};function lS(e){let[t,n]=m.useState(),r=m.useRef({}),i=m.useRef(e),s=m.useRef("none"),[a,o]=lb(e?"mounted":"unmounted",{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{let e=lT(r.current);s.current="mounted"===a?e:"none"},[a]),eb(()=>{let t=r.current,n=i.current;if(n!==e){let r=s.current,a=lT(t);if(e)o("MOUNT");else if("none"===a||t?.display==="none")o("UNMOUNT");else{let e=r!==a;n&&e?o("ANIMATION_OUT"):o("UNMOUNT")}i.current=e}},[e,o]),eb(()=>{if(t){let e;let n=t.ownerDocument.defaultView??window,a=s=>{let a=lT(r.current).includes(s.animationName);if(s.target===t&&a&&(o("ANIMATION_END"),!i.current)){let r=t.style.animationFillMode;t.style.animationFillMode="forwards",e=n.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=r)})}},l=e=>{e.target===t&&(s.current=lT(r.current))};return t.addEventListener("animationstart",l),t.addEventListener("animationcancel",a),t.addEventListener("animationend",a),()=>{n.clearTimeout(e),t.removeEventListener("animationstart",l),t.removeEventListener("animationcancel",a),t.removeEventListener("animationend",a)}}o("ANIMATION_END")},[t,o]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:m.useCallback(e=>{e&&(r.current=getComputedStyle(e)),n(e)},[])}}function lT(e){return e?.animationName||"none"}function lC(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(n=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}lw.displayName="Presence";var lE="Popover",[lx,l_]=P(lE,[na]),lI=na(),[lk,lD]=lx(lE),lR=e=>{let{__scopePopover:t,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:a=!1}=e,o=lI(t),l=m.useRef(null),[u,c]=m.useState(!1),[d=!1,h]=nk({prop:r,defaultProp:i,onChange:s});return(0,p.jsx)(nT,{...o,children:(0,p.jsx)(lk,{scope:t,contentId:eT(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:m.useCallback(()=>h(e=>!e),[h]),hasCustomAnchor:u,onCustomAnchorAdd:m.useCallback(()=>c(!0),[]),onCustomAnchorRemove:m.useCallback(()=>c(!1),[]),modal:a,children:n})})};lR.displayName=lE;var lN="PopoverAnchor";m.forwardRef((e,t)=>{let{__scopePopover:n,...r}=e,i=lD(lN,n),s=lI(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=i;return m.useEffect(()=>(a(),()=>o()),[a,o]),(0,p.jsx)(nC,{...s,...r,ref:t})}).displayName=lN;var lA="PopoverTrigger",lO=m.forwardRef((e,t)=>{let{__scopePopover:n,...r}=e,i=lD(lA,n),s=lI(n),a=(0,B.e)(t,i.triggerRef),o=(0,p.jsx)(_.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":l$(i.open),...r,ref:a,onClick:M(e.onClick,i.onOpenToggle)});return i.hasCustomAnchor?o:(0,p.jsx)(nC,{asChild:!0,...s,children:o})});lO.displayName=lA;var lM="PopoverPortal",[lP,lL]=lx(lM,{forceMount:void 0}),lB=e=>{let{__scopePopover:t,forceMount:n,children:r,container:i}=e,s=lD(lM,t);return(0,p.jsx)(lP,{scope:t,forceMount:n,children:(0,p.jsx)(lw,{present:n||s.open,children:(0,p.jsx)(nI,{asChild:!0,container:i,children:r})})})};lB.displayName=lM;var lF="PopoverContent",lj=m.forwardRef((e,t)=>{let n=lL(lF,e.__scopePopover),{forceMount:r=n.forceMount,...i}=e,s=lD(lF,e.__scopePopover);return(0,p.jsx)(lw,{present:r||s.open,children:s.modal?(0,p.jsx)(lV,{...i,ref:t}):(0,p.jsx)(lU,{...i,ref:t})})});lj.displayName=lF;var lV=m.forwardRef((e,t)=>{let n=lD(lF,e.__scopePopover),r=m.useRef(null),i=(0,B.e)(t,r),s=m.useRef(!1);return m.useEffect(()=>{let e=r.current;if(e)return nU(e)},[]),(0,p.jsx)(rF,{as:x.g7,allowPinchZoom:!0,children:(0,p.jsx)(lz,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:M(e.onCloseAutoFocus,e=>{e.preventDefault(),s.current||n.triggerRef.current?.focus()}),onPointerDownOutside:M(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;s.current=r},{checkForDefaultPrevented:!1}),onFocusOutside:M(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),lU=m.forwardRef((e,t)=>{let n=lD(lF,e.__scopePopover),r=m.useRef(!1),i=m.useRef(!1);return(0,p.jsx)(lz,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(r.current||n.triggerRef.current?.focus(),t.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(r.current=!0,"pointerdown"!==t.detail.originalEvent.type||(i.current=!0));let s=t.target;n.triggerRef.current?.contains(s)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}})}),lz=m.forwardRef((e,t)=>{let{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:c,...d}=e,h=lD(lF,n),f=lI(n);return et(),(0,p.jsx)(eo,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:(0,p.jsx)(K,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:c,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1),children:(0,p.jsx)(nE,{"data-state":l$(h.open),role:"dialog",id:h.contentId,...f,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),lq="PopoverClose";m.forwardRef((e,t)=>{let{__scopePopover:n,...r}=e,i=lD(lq,n);return(0,p.jsx)(_.button,{type:"button",...r,ref:t,onClick:M(e.onClick,()=>i.onOpenChange(!1))})}).displayName=lq;var lW="PopoverArrow";function l$(e){return e?"open":"closed"}m.forwardRef((e,t)=>{let{__scopePopover:n,...r}=e,i=lI(n);return(0,p.jsx)(nx,{...i,...r,ref:t})}).displayName=lW;var lH=lB,lG=lj;let lK=lR,lQ=lO,lY=m.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},i)=>p.jsx(lH,{children:p.jsx(lG,{ref:i,align:t,sideOffset:n,className:(0,T.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));lY.displayName=lG.displayName;let lJ={NODE_CLIENT:!1,SDK_VERSION:"${JSCORE_VERSION}"},lX=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:((64512&i)==55296&&r+1<e.length&&(64512&e.charCodeAt(r+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t},lZ=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{let s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")},l0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,u=i>>2,c=(3&i)<<4|a>>4,d=(15&a)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),r.push(n[u],n[c],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(lX(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):lZ(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){let i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0,a=++t<e.length?n[e.charAt(t)]:64,o=++t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==o)throw new l1;let l=i<<2|s>>4;if(r.push(l),64!==a){let e=s<<4&240|a>>2;if(r.push(e),64!==o){let e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class l1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let l2=function(e){let t=lX(e);return l0.encodeByteArray(t,!0)},l4=function(e){return l2(e).replace(/\./g,"")},l3=function(e){try{return l0.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l6(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}let l5=()=>l6().__FIREBASE_DEFAULTS__,l9=()=>{if("undefined"==typeof process||void 0===process.env)return;let e=process.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},l7=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&l3(e[1]);return t&&JSON.parse(t)},l8=()=>{try{return l5()||l9()||l7()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},ue=e=>{var t,n;return null===(n=null===(t=l8())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},ut=e=>{let t=ue(e);if(!t)return;let n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},un=()=>{var e;return null===(e=l8())||void 0===e?void 0:e.config};class ur{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function ui(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e),o="";return[l4(JSON.stringify(n)),l4(JSON.stringify(a)),o].join(".")}function us(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ua(){var e;let t=null===(e=l8())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function uo(){return!ua()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ul(){try{return"object"==typeof indexedDB}catch(e){return!1}}function uu(){return new Promise((e,t)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})}let uc="FirebaseError";class ud extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=uc,Object.setPrototypeOf(this,ud.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,uh.prototype.create)}}class uh{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?uf(i,n):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new ud(r,a,n)}}function uf(e,t){return e.replace(up,(e,n)=>{let r=t[n];return null!=r?String(r):`<${n}?>`})}let up=/\{\$([^}]+)}/g;function um(e,t){if(e===t)return!0;let n=Object.keys(e),r=Object.keys(t);for(let i of n){if(!r.includes(i))return!1;let n=e[i],s=t[i];if(ug(n)&&ug(s)){if(!um(n,s))return!1}else if(n!==s)return!1}for(let e of r)if(!n.includes(e))return!1;return!0}function ug(e){return null!==e&&"object"==typeof e}function uy(e){return e&&e._delegate?e._delegate:e}lJ.NODE_CLIENT=!0;class uv{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let ub="[DEFAULT]";class uw{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new ur;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(uT(e))try{this.getOrInitializeService({instanceIdentifier:ub})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=ub){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=ub){return this.instances.has(e)}getOptions(e=ub){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;let r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:uS(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}return n||null}normalizeInstanceIdentifier(e=ub){return this.component?this.component.multipleInstances?e:ub:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function uS(e){return e===ub?void 0:e}function uT(e){return"EAGER"===e.instantiationMode}class uC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new uw(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let uE=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(u||(u={}));let ux={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},u_=u.INFO,uI={[u.DEBUG]:"log",[u.VERBOSE]:"log",[u.INFO]:"info",[u.WARN]:"warn",[u.ERROR]:"error"},uk=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=uI[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class uD{constructor(e){this.name=e,this._logLevel=u_,this._logHandler=uk,this._userLogHandler=null,uE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in u))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ux[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,u.DEBUG,...e),this._logHandler(this,u.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,u.VERBOSE,...e),this._logHandler(this,u.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,u.INFO,...e),this._logHandler(this,u.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,u.WARN,...e),this._logHandler(this,u.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,u.ERROR,...e),this._logHandler(this,u.ERROR,...e)}}let uR=(e,t)=>t.some(t=>e instanceof t);function uN(){return r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uA(){return i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let uO=new WeakMap,uM=new WeakMap,uP=new WeakMap,uL=new WeakMap,uB=new WeakMap;function uF(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(uW(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&uO.set(t,e)}).catch(()=>{}),uB.set(t,e),t}function uj(e){if(uM.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});uM.set(e,t)}let uV={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return uM.get(e);if("objectStoreNames"===t)return e.objectStoreNames||uP.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return uW(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function uU(e){uV=e(uV)}function uz(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?uA().includes(e)?function(...t){return e.apply(u$(this),t),uW(uO.get(this))}:function(...t){return uW(e.apply(u$(this),t))}:function(t,...n){let r=e.call(u$(this),t,...n);return uP.set(r,t.sort?t.sort():[t]),uW(r)}}function uq(e){return"function"==typeof e?uz(e):(e instanceof IDBTransaction&&uj(e),uR(e,uN()))?new Proxy(e,uV):e}function uW(e){if(e instanceof IDBRequest)return uF(e);if(uL.has(e))return uL.get(e);let t=uq(e);return t!==e&&(uL.set(e,t),uB.set(t,e)),t}let u$=e=>uB.get(e);function uH(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(e,t),o=uW(a);return r&&a.addEventListener("upgradeneeded",e=>{r(uW(a.result),e.oldVersion,e.newVersion,uW(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}let uG=["get","getKey","getAll","getAllKeys","count"],uK=["put","add","delete","clear"],uQ=new Map;function uY(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(uQ.get(t))return uQ.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=uK.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||uG.includes(n)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),a=s.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),i&&s.done]))[0]};return uQ.set(t,s),s}uU(e=>({...e,get:(t,n,r)=>uY(t,n)||e.get(t,n,r),has:(t,n)=>!!uY(t,n)||e.has(t,n)}));class uJ{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(!uX(e))return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}function uX(e){let t=e.getComponent();return(null==t?void 0:t.type)==="VERSION"}let uZ="@firebase/app",u0="0.10.18",u1=new uD("@firebase/app"),u2="11.2.0",u4="[DEFAULT]",u3={[uZ]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},u6=new Map,u5=new Map,u9=new Map;function u7(e,t){try{e.container.addComponent(t)}catch(n){u1.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function u8(e){let t=e.name;if(u9.has(t))return u1.debug(`There were multiple attempts to register component ${t}.`),!1;for(let n of(u9.set(t,e),u6.values()))u7(n,e);for(let t of u5.values())u7(t,e);return!0}function ce(e,t){let n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}let ct=new uh("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class cn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new uv("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ct.create("app-deleted",{appName:this._name})}}let cr=u2;function ci(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});let r=Object.assign({name:u4,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw ct.create("bad-app-name",{appName:String(i)});if(n||(n=un()),!n)throw ct.create("no-options");let s=u6.get(i);if(s){if(um(n,s.options)&&um(r,s.config))return s;throw ct.create("duplicate-app",{appName:i})}let a=new uC(i);for(let e of u9.values())a.addComponent(e);let o=new cn(n,r,a);return u6.set(i,o),o}function cs(e=u4){let t=u6.get(e);if(!t&&e===u4&&un())return ci();if(!t)throw ct.create("no-app",{appName:e});return t}function ca(e,t,n){var r;let i=null!==(r=u3[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);let s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){let e=[`Unable to register library "${i}" with version "${t}":`];s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),u1.warn(e.join(" "));return}u8(new uv(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}let co="firebase-heartbeat-database",cl=1,cu="firebase-heartbeat-store",cc=null;function cd(){return cc||(cc=uH(co,cl,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(cu)}catch(e){console.warn(e)}}}).catch(e=>{throw ct.create("idb-open",{originalErrorMessage:e.message})})),cc}async function ch(e){try{let t=(await cd()).transaction(cu),n=await t.objectStore(cu).get(cp(e));return await t.done,n}catch(e){if(e instanceof ud)u1.warn(e.message);else{let t=ct.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});u1.warn(t.message)}}}async function cf(e,t){try{let n=(await cd()).transaction(cu,"readwrite"),r=n.objectStore(cu);await r.put(t,cp(e)),await n.done}catch(e){if(e instanceof ud)u1.warn(e.message);else{let t=ct.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});u1.warn(t.message)}}}function cp(e){return`${e.name}!${e.options.appId}`}let cm=1024,cg=2592e6;class cy{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new cw(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{let n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=cv();if((null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{let t=new Date(e.date).valueOf();return Date.now()-t<=cg}),this._storage.overwrite(this._heartbeatsCache)}catch(e){u1.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let t=cv(),{heartbeatsToSend:n,unsentEntries:r}=cb(this._heartbeatsCache.heartbeats),i=l4(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return u1.warn(e),""}}}function cv(){return new Date().toISOString().substring(0,10)}function cb(e,t=cm){let n=[],r=e.slice();for(let i of e){let e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),cS(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),cS(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class cw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ul()&&uu().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await ch(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let n=await this.read();return cf(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){let n=await this.read();return cf(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function cS(e){return l4(JSON.stringify({version:2,heartbeats:e})).length}(function(e){u8(new uv("platform-logger",e=>new uJ(e),"PRIVATE")),u8(new uv("heartbeat",e=>new cy(e),"PRIVATE")),ca(uZ,u0,""),ca(uZ,u0,"esm2017"),ca("fire-js","")})(0);var cT=n(21764),cC=n(84770),cE="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},cx={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function t(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^n&(i^s))+r[0]+3614090360&4294967295;a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[1]+3905402710&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[2]+606105819&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[3]+3250441966&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[4]+4118548399&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[5]+1200080426&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[6]+2821735955&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[7]+4249261313&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[8]+1770035416&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[9]+2336552879&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[10]+4294925233&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[11]+2304563134&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[12]+1804603682&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[13]+4254626195&4294967295,a=i+(n^(s=t+(a<<12&4294967295|a>>>20))&(t^n))+r[14]+2792965006&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[15]+1236535329&4294967295,n=i+(a<<22&4294967295|a>>>10),a=t+(i^s&(n^i))+r[1]+4129170786&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[6]+3225465664&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[0]+3921069994&4294967295,n=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(n^i))+r[5]+3593408605&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[10]+38016083&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[4]+3889429448&4294967295,n=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(n^i))+r[9]+568446438&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[14]+3275163606&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[8]+1163531501&4294967295,n=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(n^i))+r[13]+2850285829&4294967295,t=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(t^n))+r[2]+4243563512&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^t&(i^s))+r[12]+2368359562&4294967295,a=t+((n=i+(a<<20&4294967295|a>>>12))^i^s)+r[5]+4294588738&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[8]+2272392833&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[11]+1839030562&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[14]+4259657740&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[1]+2763975236&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[4]+1272893353&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[7]+4139469664&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[10]+3200236656&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[13]+681279174&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[0]+3936430074&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[3]+3572445317&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[6]+76029189&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[9]+3654602809&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[12]+3873151461&4294967295,a=i+((s=t+(a<<11&4294967295|a>>>21))^t^n)+r[15]+530742520&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[2]+3299628645&4294967295,n=i+(a<<23&4294967295|a>>>9),a=t+(i^(n|~s))+r[0]+4096336452&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[7]+1126891415&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[5]+4237533241&4294967295,n=i+(a<<21&4294967295|a>>>11),a=t+(i^(n|~s))+r[12]+1700485571&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[3]+2399980690&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[1]+2240044497&4294967295,n=i+(a<<21&4294967295|a>>>11),a=t+(i^(n|~s))+r[8]+1873313359&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[15]+4264355552&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[13]+1309151649&4294967295,n=i+(a<<21&4294967295|a>>>11),a=t+(i^(n|~s))+r[4]+4149444226&4294967295,t=n+(a<<6&4294967295|a>>>26),a=s+(n^(t|~i))+r[11]+3174756917&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function n(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}})(e,function(){this.blockSize=-1}),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(e,n){void 0===n&&(n=e.length);for(var r=n-this.blockSize,i=this.B,s=this.h,a=0;a<n;){if(0==s)for(;a<=r;)t(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<n;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){t(this,i),s=0;break}}else for(;a<n;)if(i[s++]=e[a++],s==this.blockSize){t(this,i),s=0;break}}this.h=s,this.o+=n},e.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i,s={};function a(e){return -128<=e&&128>e?n(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return u;if(0>e)return g(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}function l(e,t){if(0==e.length)throw Error("number format error: empty string");if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if("-"==e.charAt(0))return g(l(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=o(Math.pow(t,8)),r=u,i=0;i<e.length;i+=8){var s=Math.min(8,e.length-i),a=parseInt(e.substring(i,i+s),t);8>s?(s=o(Math.pow(t,s)),r=r.j(s).add(o(a))):r=(r=r.j(n)).add(o(a))}return r}var u=a(0),h=a(1),f=a(16777216);function p(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function m(e){return -1==e.h}function g(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(h)}function y(e,t){return e.add(g(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function b(e,t){this.g=e,this.h=t}function w(e,t){if(p(t))throw Error("division by zero");if(p(e))return new b(u,u);if(m(e))return t=w(g(e),t),new b(g(t.g),g(t.h));if(m(t))return t=w(e,g(t)),new b(g(t.g),t.h);if(30<e.g.length){if(m(e)||m(t))throw Error("slowDivide_ only works with positive integers.");for(var n=h,r=t;0>=r.l(e);)n=S(n),r=S(r);var i=T(n,1),s=T(r,1);for(r=T(r,2),n=T(n,2);!p(r);){var a=s.add(r);0>=a.l(e)&&(i=i.add(n),s=a),r=T(r,1),n=T(n,1)}return t=y(e,i.j(t)),new b(i,t)}for(i=u;0<=e.l(t);){for(r=48>=(r=Math.ceil(Math.log(n=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))?1:Math.pow(2,r-48),a=(s=o(n)).j(t);m(a)||0<a.l(e);)n-=r,a=(s=o(n)).j(t);p(s)&&(s=h),i=i.add(s),e=y(e,a)}return new b(i,e)}function S(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function T(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],a=0;a<i;a++)s[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new r(s,e.h)}(i=r.prototype).m=function(){if(m(this))return-g(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},i.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(p(this))return"0";if(m(this))return"-"+g(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=w(n,t).g,s=((0<(n=y(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(p(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},i.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},i.l=function(e){return m(e=y(this,e))?-1:p(e)?0:1},i.abs=function(){return m(this)?g(this):this},i.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var a=i+(65535&this.i(s))+(65535&e.i(s)),o=(a>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=o>>>16,a&=65535,o&=65535,n[s]=o<<16|a}return new r(n,-2147483648&n[n.length-1]?-1:0)},i.j=function(e){if(p(this)||p(e))return u;if(m(this))return m(e)?g(this).j(g(e)):g(g(this).j(e));if(m(e))return g(this.j(g(e)));if(0>this.l(f)&&0>e.l(f))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var a=this.i(i)>>>16,l=65535&this.i(i),c=e.i(s)>>>16,d=65535&e.i(s);n[2*i+2*s]+=l*d,v(n,2*i+2*s),n[2*i+2*s+1]+=a*d,v(n,2*i+2*s+1),n[2*i+2*s+1]+=l*c,v(n,2*i+2*s+1),n[2*i+2*s+2]+=a*c,v(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},i.A=function(e){return w(this,e).h},i.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},i.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},i.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,d=cx.Md5=e,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=l,c=cx.Integer=r}).apply(void 0!==cE?cE:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var c_=n(1968),cI=n(13716);let ck="@firebase/firestore",cD="4.7.6";class cR{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cR.UNAUTHENTICATED=new cR(null),cR.GOOGLE_CREDENTIALS=new cR("google-credentials-uid"),cR.FIRST_PARTY=new cR("first-party-uid"),cR.MOCK_USER=new cR("mock-user");let cN="11.2.0";function cA(e){cN=e}function cO(e){return(0,cT.inspect)(e,{depth:100})}let cM=new uD("@firebase/firestore");function cP(){return cM.logLevel}function cL(e,...t){if(cM.logLevel<=u.DEBUG){let n=t.map(cj);cM.debug(`Firestore (${cN}): ${e}`,...n)}}function cB(e,...t){if(cM.logLevel<=u.ERROR){let n=t.map(cj);cM.error(`Firestore (${cN}): ${e}`,...n)}}function cF(e,...t){if(cM.logLevel<=u.WARN){let n=t.map(cj);cM.warn(`Firestore (${cN}): ${e}`,...n)}}function cj(e){if("string"==typeof e)return e;try{return cO(e)}catch(t){return e}}function cV(e="Unexpected state"){let t=`FIRESTORE (${cN}) INTERNAL ASSERTION FAILED: `+e;throw cB(t),Error(t)}function cU(e,t){e||cV()}function cz(e,t){return e}let cq={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class cW extends ud{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class c${constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class cH{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cG{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(cR.UNAUTHENTICATED))}shutdown(){}}class cK{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class cQ{constructor(e){this.authProvider=e,this.currentUser=cR.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){cU(void 0===this.tokenListener);let n=this.tokenCounter,r=e=>this.tokenCounter!==n?(n=this.tokenCounter,t(e)):Promise.resolve(),i=new c$;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),i.resolve(),i=new c$,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{cL("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),s())};this.authProvider.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.authProvider.getImmediate({optional:!0});e?a(e):(cL("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new c$)}},0),s()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(t).then(t=>this.tokenCounter!==e?(cL("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(cU("string"==typeof t.accessToken),new cH(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return cU(null===e||"string"==typeof e),new cR(e)}}class cY{constructor(e,t,n){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=n,this.type="FirstParty",this.user=cR.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class cJ{constructor(e,t,n){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=n}getToken(){return Promise.resolve(new cY(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(cR.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cX{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cZ{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,t){cU(void 0===this.tokenListener);let n=e=>{null!=e.error&&cL("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.latestAppCheckToken;return this.latestAppCheckToken=e.token,cL("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.tokenListener=t=>{e.enqueueRetryable(()=>n(t))};let r=e=>{cL("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){let e=this.appCheckProvider.getImmediate({optional:!0});e?r(e):cL("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(e).then(e=>e?(cU("string"==typeof e.token),this.latestAppCheckToken=e.token,new cX(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function c0(e){if(!e)return new cG;switch(e.type){case"firstParty":return new cJ(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new cW(cq.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function c1(e){return(0,cC.randomBytes)(e)}class c2{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="",r=20;for(;n.length<r;){let i=c1(40);for(let s=0;s<i.length;++s)n.length<r&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}}function c4(e,t){return e<t?-1:e>t?1:0}function c3(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function c6(e){return e+"\0"}let c5=-62135596800,c9=1e6;class c7{static now(){return c7.fromMillis(Date.now())}static fromDate(e){return c7.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*c9);return new c7(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new cW(cq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<c5||e>=253402300800)throw new cW(cq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/c9}_compareTo(e){return this.seconds===e.seconds?c4(this.nanoseconds,e.nanoseconds):c4(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds-c5).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class c8{static fromTimestamp(e){return new c8(e)}static min(){return new c8(new c7(0,0))}static max(){return new c8(new c7(253402300799,1e9-1))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let de="__name__";class dt{constructor(e,t,n){void 0===t?t=0:t>e.length&&cV(),void 0===n?n=e.length-t:n>e.length-t&&cV(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===dt.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof dt?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let n=dt.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Math.sign(e.length-t.length)}static compareSegments(e,t){let n=dt.isNumericId(e),r=dt.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?dt.extractNumericId(e).compare(dt.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return c.fromString(e.substring(4,e.length-2))}}class dn extends dt{construct(e,t,n){return new dn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new cW(cq.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new dn(t)}static emptyPath(){return new dn([])}}let dr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class di extends dt{construct(e,t,n){return new di(e,t,n)}static isValidIdentifier(e){return dr.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),di.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===de}static keyField(){return new di([de])}static fromServerFormat(e){let t=[],n="",r=0,i=()=>{if(0===n.length)throw new cW(cq.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},s=!1;for(;r<e.length;){let t=e[r];if("\\"===t){if(r+1===e.length)throw new cW(cq.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[r+1];if(!("\\"===t||"."===t||"`"===t))throw new cW(cq.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?s=!s:"."!==t||s?n+=t:i(),r++}if(i(),s)throw new cW(cq.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new di(t)}static emptyPath(){return new di([])}}class ds{constructor(e){this.path=e}static fromPath(e){return new ds(dn.fromString(e))}static fromName(e){return new ds(dn.fromString(e).popFirst(5))}static empty(){return new ds(dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===dn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ds(new dn(e.slice()))}}let da=-1,dl=0;class du{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function dc(e){return e.fields.find(e=>2===e.kind)}function dd(e){return e.fields.filter(e=>2!==e.kind)}function dh(e){let t=dd(e);return 0===t.length?0:t[t.length-1].kind}function df(e,t){let n=c4(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(0!==(n=dg(e.fields[r],t.fields[r])))return n;return c4(e.fields.length,t.fields.length)}function dp(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}du.UNKNOWN_ID=-1;class dm{constructor(e,t){this.fieldPath=e,this.kind=t}}function dg(e,t){let n=di.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:c4(e.kind,t.kind)}class dy{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new dy(dl,dw.min())}}function dv(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1;return new dw(c8.fromTimestamp(1e9===r?new c7(n+1,0):new c7(n,r)),ds.empty(),t)}function db(e){return new dw(e.readTime,e.key,da)}class dw{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new dw(c8.min(),ds.empty(),da)}static max(){return new dw(c8.max(),ds.empty(),da)}}function dS(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n||0!==(n=ds.comparator(e.documentKey,t.documentKey))?n:c4(e.largestBatchId,t.largestBatchId)}let dT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function dE(e){if(e.code===cq.FAILED_PRECONDITION&&e.message===dT)cL("LocalStore","Unexpectedly lost primary lease");else throw e}class dx{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return(this.callbackAttached&&cV(),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new dx((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();if(t instanceof dx)return t;return dx.resolve(t)}catch(e){return dx.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):dx.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):dx.reject(t)}static resolve(e){return new dx((t,n)=>{t(e)})}static reject(e){return new dx((t,n)=>{n(e)})}static waitFor(e){return new dx((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=dx.resolve(!1);for(let n of e)t=t.next(e=>e?dx.resolve(e):n());return t}static forEach(e,t){let n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new dx((n,r)=>{let i=e.length,s=Array(i),a=0;for(let o=0;o<i;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new dx((n,r)=>{let i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}let d_="SimpleDb",dI=3;class dk{static open(e,t,n,r){try{return new dk(t,e.transaction(r,n))}catch(e){throw new dA(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.completionDeferred=new c$,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{t.error?this.completionDeferred.reject(new dA(e,t.error)):this.completionDeferred.resolve()},this.transaction.onerror=t=>{let n=dB(t.target.error);this.completionDeferred.reject(new dA(e,n))}}get completionPromise(){return this.completionDeferred.promise}abort(e){e&&this.completionDeferred.reject(e),this.aborted||(cL(d_,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return new dM(this.transaction.objectStore(e))}}class dD{static delete(e){return cL(d_,"Removing database:",e),dP(window.indexedDB.deleteDatabase(e)).toPromise()}static isAvailable(){if(!ul())return!1;if(dD.isMockPersistence())return!0;let e=us(),t=dD.getIOSVersion(e),n=0<t&&t<10,r=dR(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0)&&!n&&!i}static isMockPersistence(){var e;return"undefined"!=typeof process&&(null===(e=process.env)||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)==="YES"}static getStore(e,t){return e.store(t)}static getIOSVersion(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(t?t[1].split("_").slice(0,2).join("."):"-1")}constructor(e,t,n){this.name=e,this.version=t,this.schemaConverter=n,12.2===dD.getIOSVersion(us())&&cB("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async ensureDb(e){return this.db||(cL(d_,"Opening database:",this.name),this.db=await new Promise((t,n)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{t(e.target.result)},r.onblocked=()=>{n(new dA(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{let r=t.target.error;"VersionError"===r.name?n(new cW(cq.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new cW(cq.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new dA(e,r))},r.onupgradeneeded=e=>{cL(d_,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;this.schemaConverter.createOrUpgrade(t,r.transaction,e.oldVersion,this.version).next(()=>{cL(d_,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=e=>this.versionchangelistener(e)),this.db}setVersionChangeListener(e){this.versionchangelistener=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.ensureDb(e);let t=dk.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.maybeCommit(),e)).catch(e=>(t.abort(e),dx.reject(e))).toPromise();return s.catch(()=>{}),await t.completionPromise,s}catch(n){let e=n,t="FirebaseError"!==e.name&&s<dI;if(cL(d_,"Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}function dR(e){let t=e.match(/Android ([\d.]+)/i);return Number(t?t[1].split(".").slice(0,2).join("."):"-1")}class dN{constructor(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(e){this.dbCursor=e}done(){this.shouldStop=!0}skip(e){this.nextKey=e}delete(){return dP(this.dbCursor.delete())}}class dA extends cW{constructor(e,t){super(cq.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function dO(e){return"IndexedDbTransactionError"===e.name}class dM{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(cL(d_,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(cL(d_,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),dP(n)}add(e){return cL(d_,"ADD",this.store.name,e,e),dP(this.store.add(e))}get(e){return dP(this.store.get(e)).next(t=>(void 0===t&&(t=null),cL(d_,"GET",this.store.name,e,t),t))}delete(e){return cL(d_,"DELETE",this.store.name,e),dP(this.store.delete(e))}count(){return cL(d_,"COUNT",this.store.name),dP(this.store.count())}loadAll(e,t){let n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){let e=r.getAll(n.range);return new dx((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{let e=this.cursor(n),t=[];return this.iterateCursor(e,(e,n)=>{t.push(n)}).next(()=>t)}}loadFirst(e,t){let n=this.store.getAll(e,null===t?void 0:t);return new dx((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}deleteAll(e,t){cL(d_,"DELETE ALL",this.store.name);let n=this.options(e,t);n.keysOnly=!1;let r=this.cursor(n);return this.iterateCursor(r,(e,t,n)=>n.delete())}iterate(e,t){let n;t?n=e:(n={},t=e);let r=this.cursor(n);return this.iterateCursor(r,t)}iterateSerial(e){let t=this.cursor({});return new dx((n,r)=>{t.onerror=e=>{r(dB(e.target.error))},t.onsuccess=t=>{let r=t.target.result;if(!r){n();return}e(r.primaryKey,r.value).next(e=>{e?r.continue():n()})}})}iterateCursor(e,t){let n=[];return new dx((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i){r();return}let s=new dN(i),a=t(i.primaryKey,i.value,s);if(a instanceof dx){let e=a.catch(e=>(s.done(),dx.reject(e)));n.push(e)}s.isDone?r():null===s.skipToKey?i.continue():i.continue(s.skipToKey)}}).next(()=>dx.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),!e.index)return this.store.openCursor(e.range,t);{let n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}}}function dP(e){return new dx((t,n)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{n(dB(e.target.error))}})}let dL=!1;function dB(e){let t=dD.getIOSVersion(us());if(t>=12.2&&t<13){let t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){let e=new cW("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dL||(dL=!0,setTimeout(()=>{throw e},0)),e}}return e}let dF="IndexBackfiller",dj=15e3,dV=6e4,dU=50;class dz{constructor(e,t){this.asyncQueue=e,this.backfiller=t,this.task=null}start(){this.schedule(dj)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(e){cL(dF,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let e=await this.backfiller.backfill();cL(dF,`Documents written: ${e}`)}catch(e){dO(e)?cL(dF,"Ignoring IndexedDB error during index backfill: ",e):await dE(e)}await this.schedule(dV)})}}class dq{constructor(e,t){this.localStore=e,this.persistence=t}async backfill(e=dU){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.writeIndexEntries(t,e))}writeIndexEntries(e,t){let n=new Set,r=t,i=!0;return dx.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(!(null===t||n.has(t)))return cL(dF,`Processing collection: ${t}`),this.writeEntriesForCollectionGroup(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}writeEntriesForCollectionGroup(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{let i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.getNewOffset(r,n)).next(n=>(cL(dF,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}getNewOffset(e,t){let n=e;return t.changes.forEach((e,t)=>{let r=db(t);dS(r,n)>0&&(n=r)}),new dw(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class dW{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.setPreviousValue(e),this.writeNewSequenceNumber=e=>t.writeSequenceNumber(e))}setPreviousValue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e}}dW.INVALID=-1;let d$="\x01",dH="\x01",dG="\x10",dK="\x11";function dQ(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=dJ(t)),t=dY(e.get(n),t);return dJ(t)}function dY(e,t){let n=t,r=e.length;for(let t=0;t<r;t++){let r=e.charAt(t);switch(r){case"\0":n+=d$+dG;break;case d$:n+=d$+dK;break;default:n+=r}}return n}function dJ(e){return e+d$+dH}function dX(e){let t=e.length;if(cU(t>=2),2===t)return cU(e.charAt(0)===d$&&e.charAt(1)===dH),dn.emptyPath();let n=t-2,r=[],i="";for(let s=0;s<t;){let t=e.indexOf(d$,s);switch((t<0||t>n)&&cV(),e.charAt(t+1)){case dH:let a;let o=e.substring(s,t);0===i.length?a=o:(i+=o,a=i,i=""),r.push(a);break;case dG:i+=e.substring(s,t)+"\0";break;case dK:i+=e.substring(s,t+1);break;default:cV()}s=t+2}return new dn(r)}let dZ="remoteDocuments",d0="owner",d1="owner",d2="mutationQueues",d4="userId",d3="mutations",d6="batchId",d5="userMutationsIndex",d9=["userId","batchId"];function d7(e){return[e]}function d8(e,t){return[e,dQ(t)]}function he(e,t,n){return[e,dQ(t),n]}let ht={},hn="documentMutations",hr="remoteDocumentsV14",hi=["prefixPath","collectionGroup","readTime","documentId"],hs="documentKeyIndex",ha=["prefixPath","collectionGroup","documentId"],ho="collectionGroupIndex",hl=["collectionGroup","readTime","prefixPath","documentId"],hu="remoteDocumentGlobal",hc="remoteDocumentGlobalKey",hd="targets",hh="targetId",hf="queryTargetsIndex",hp=["canonicalId","targetId"],hm="targetDocuments",hg=["targetId","path"],hy="documentTargetsIndex",hv=["path","targetId"],hb="targetGlobalKey",hw="targetGlobal",hS="collectionParents",hT=["collectionId","parent"],hC="clientMetadata",hE="clientId",hx="bundles",h_="bundleId",hI="namedQueries",hk="name",hD="indexConfiguration",hR="indexId",hN="collectionGroupIndex",hA="collectionGroup",hO="indexState",hM=["indexId","uid"],hP="sequenceNumberIndex",hL=["uid","sequenceNumber"],hB="indexEntries",hF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hj="documentKeyIndex",hV=["indexId","uid","orderedDocumentKey"],hU="documentOverlays",hz=["userId","collectionPath","documentId"],hq="collectionPathOverlayIndex",hW=["userId","collectionPath","largestBatchId"],h$="collectionGroupOverlayIndex",hH=["userId","collectionGroup","largestBatchId"],hG="globals",hK="name",hQ=[d2,d3,hn,dZ,hd,d0,hw,hm,hC,hu,hS,hx,hI],hY=[...hQ,hU],hJ=[d2,d3,hn,hr,hd,d0,hw,hm,hC,hu,hS,hx,hI,hU],hX=hJ,hZ=[...hX,hD,hO,hB],h0=hZ,h1=[...hZ,hG];function h2(e){return 17===e?h1:16===e?h0:15===e?hZ:14===e?hX:13===e?hJ:12===e?hY:11===e?hQ:void cV()}class h4 extends dC{constructor(e,t){super(),this.simpleDbTransaction=e,this.currentSequenceNumber=t}}function h3(e,t){let n=cz(e);return dD.getStore(n.simpleDbTransaction,t)}function h6(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function h5(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function h9(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class h7{constructor(e,t){this.comparator=e,this.root=t||fe.EMPTY}insert(e,t){return new h7(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fe.BLACK,null,null))}remove(e){return new h7(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new h8(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new h8(this.root,e,this.comparator,!1)}getReverseIterator(){return new h8(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new h8(this.root,e,this.comparator,!0)}}class h8{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else if(0===i){this.nodeStack.push(e);break}else this.nodeStack.push(e),e=this.isReverse?e.right:e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fe{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:fe.RED,this.left=null!=r?r:fe.EMPTY,this.right=null!=i?i:fe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new fe(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}removeMin(){if(this.left.isEmpty())return fe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let n;let r=this;if(0>t(e,r.key))r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return fe.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,fe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,fe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw cV();let e=this.left.check();if(e===this.right.check())return e+(this.isRed()?0:1);throw cV()}}fe.EMPTY=null,fe.RED=!0,fe.BLACK=!1;class ft{constructor(){this.size=0}get key(){throw cV()}get value(){throw cV()}get color(){throw cV()}get left(){throw cV()}get right(){throw cV()}copy(e,t,n,r,i){return this}insert(e,t,n){return new fe(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}fe.EMPTY=new ft;class fn{constructor(e){this.comparator=e,this.data=new h7(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fr(this.data.getIterator())}getIteratorFrom(e){return new fr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof fn)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new fn(this.comparator);return t.data=e,t}}class fr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fi(e,t,n,r,i){let s=e.getIterator(),a=t.getIterator(),o=fs(s),l=fs(a);for(;o||l;){let e=!1,t=!1;if(o&&l){let r=n(o,l);r<0?t=!0:r>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(r(l),l=fs(a)):t?(i(o),o=fs(s)):(o=fs(s),l=fs(a))}}function fs(e){return e.hasNext()?e.getNext():void 0}class fa{constructor(e){this.fields=e,e.sort(di.comparator)}static empty(){return new fa([])}unionWith(e){let t=new fn(di.comparator);for(let e of this.fields)t=t.add(e);for(let n of e)t=t.add(n);return new fa(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return c3(this.fields,e.fields,(e,t)=>e.isEqual(t))}}function fo(e){return Buffer.from(e,"base64").toString("binary")}function fl(e){return Buffer.from(e,"binary").toString("base64")}class fu{constructor(e){this.binaryString=e}static fromBase64String(e){return new fu(fo(e))}static fromUint8Array(e){return new fu(fc(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return fl(this.binaryString)}toUint8Array(){return fd(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return c4(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}function fc(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}function fd(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}fu.EMPTY_BYTE_STRING=new fu("");let fh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ff(e){if(cU(!!e),"string"==typeof e){let t=0,n=fh.exec(e);if(cU(!!n),n[1]){let e=n[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:fp(e.seconds),nanos:fp(e.nanos)}}function fp(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function fm(e){return"string"==typeof e?fu.fromBase64String(e):fu.fromUint8Array(e)}let fg="server_timestamp",fy="__type__",fv="__previous_value__",fb="__local_write_time__";function fw(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[fy])||void 0===n?void 0:n.stringValue)===fg}function fS(e,t){let n={fields:{[fy]:{stringValue:fg},[fb]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&fw(t)&&(t=fT(t)),t&&(n.fields[fv]=t),{mapValue:n}}function fT(e){let t=e.mapValue.fields[fv];return fw(t)?fT(t):t}function fC(e){let t=ff(e.mapValue.fields[fb].timestampValue);return new c7(t.seconds,t.nanos)}class fE{constructor(e,t,n,r,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}let fx="(default)";class f_{constructor(e,t){this.projectId=e,this.database=t||fx}static empty(){return new f_("","")}get isDefaultDatabase(){return this.database===fx}isEqual(e){return e instanceof f_&&e.projectId===this.projectId&&e.database===this.database}}function fI(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new cW(cq.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new f_(e.options.projectId,t)}let fk=-1;function fD(e){return null==e}function fR(e){return 0===e&&1/e==-1/0}function fN(e){return"number"==typeof e&&Number.isInteger(e)&&!fR(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}let fA="__type__",fO="__max__",fM={mapValue:{fields:{__type__:{stringValue:fO}}}},fP="__vector__",fL="value",fB={nullValue:"NULL_VALUE"};function fF(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?fw(e)?4:ph(e)?9007199254740991:pc(e)?10:11:cV()}function fj(e,t){if(e===t)return!0;let n=fF(e);if(n!==fF(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return fC(e).isEqual(fC(t));case 3:return fV(e,t);case 5:return e.stringValue===t.stringValue;case 6:return fz(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return fU(e,t);case 2:return fq(e,t);case 9:return c3(e.arrayValue.values||[],t.arrayValue.values||[],fj);case 10:case 11:return fW(e,t);default:return cV()}}function fV(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=ff(e.timestampValue),r=ff(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}function fU(e,t){return fp(e.geoPointValue.latitude)===fp(t.geoPointValue.latitude)&&fp(e.geoPointValue.longitude)===fp(t.geoPointValue.longitude)}function fz(e,t){return fm(e.bytesValue).isEqual(fm(t.bytesValue))}function fq(e,t){if("integerValue"in e&&"integerValue"in t)return fp(e.integerValue)===fp(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let n=fp(e.doubleValue),r=fp(t.doubleValue);return n===r?fR(n)===fR(r):isNaN(n)&&isNaN(r)}return!1}function fW(e,t){let n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(h6(n)!==h6(r))return!1;for(let e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!fj(n[e],r[e])))return!1;return!0}function f$(e,t){return void 0!==(e.values||[]).find(e=>fj(e,t))}function fH(e,t){if(e===t)return 0;let n=fF(e),r=fF(t);if(n!==r)return c4(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return c4(e.booleanValue,t.booleanValue);case 2:return fG(e,t);case 3:return fK(e.timestampValue,t.timestampValue);case 4:return fK(fC(e),fC(t));case 5:return c4(e.stringValue,t.stringValue);case 6:return fJ(e.bytesValue,t.bytesValue);case 7:return fQ(e.referenceValue,t.referenceValue);case 8:return fY(e.geoPointValue,t.geoPointValue);case 9:return fX(e.arrayValue,t.arrayValue);case 10:return fZ(e.mapValue,t.mapValue);case 11:return f0(e.mapValue,t.mapValue);default:throw cV()}}function fG(e,t){let n=fp(e.integerValue||e.doubleValue),r=fp(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}function fK(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return c4(e,t);let n=ff(e),r=ff(t),i=c4(n.seconds,r.seconds);return 0!==i?i:c4(n.nanos,r.nanos)}function fQ(e,t){let n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){let t=c4(n[e],r[e]);if(0!==t)return t}return c4(n.length,r.length)}function fY(e,t){let n=c4(fp(e.latitude),fp(t.latitude));return 0!==n?n:c4(fp(e.longitude),fp(t.longitude))}function fJ(e,t){let n=fm(e),r=fm(t);return n.compareTo(r)}function fX(e,t){let n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){let t=fH(n[e],r[e]);if(t)return t}return c4(n.length,r.length)}function fZ(e,t){var n,r,i,s;let a=e.fields||{},o=t.fields||{},l=null===(n=a[fL])||void 0===n?void 0:n.arrayValue,u=null===(r=o[fL])||void 0===r?void 0:r.arrayValue,c=c4((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==u?void 0:u.values)||void 0===s?void 0:s.length)||0);return 0!==c?c:fX(l,u)}function f0(e,t){if(e===fM.mapValue&&t===fM.mapValue)return 0;if(e===fM.mapValue)return 1;if(t===fM.mapValue)return -1;let n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){let t=c4(r[e],s[e]);if(0!==t)return t;let a=fH(n[r[e]],i[s[e]]);if(0!==a)return a}return c4(r.length,s.length)}function f1(e){return f2(e)}function f2(e){if("nullValue"in e)return"null";if("booleanValue"in e)return""+e.booleanValue;if("integerValue"in e)return""+e.integerValue;if("doubleValue"in e)return""+e.doubleValue;if("timestampValue"in e)return f3(e.timestampValue);if("stringValue"in e)return e.stringValue;if("bytesValue"in e)return f4(e.bytesValue);else if("referenceValue"in e)return f5(e.referenceValue);else if("geoPointValue"in e)return f6(e.geoPointValue);else if("arrayValue"in e)return f7(e.arrayValue);else if("mapValue"in e)return f9(e.mapValue);else return cV()}function f4(e){return fm(e).toBase64()}function f3(e){let t=ff(e);return`time(${t.seconds},${t.nanos})`}function f6(e){return`geo(${e.latitude},${e.longitude})`}function f5(e){return ds.fromName(e).toString()}function f9(e){let t=Object.keys(e.fields||{}).sort(),n="{",r=!0;for(let i of t)r?r=!1:n+=",",n+=`${i}:${f2(e.fields[i])}`;return n+"}"}function f7(e){let t="[",n=!0;for(let r of e.values||[])n?n=!1:t+=",",t+=f2(r);return t+"]"}function f8(e){switch(fF(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let t=fT(e);return t?16+f8(t):16;case 5:return 2*e.stringValue.length;case 6:return fm(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return pt(e.arrayValue);case 10:case 11:return pe(e.mapValue);default:throw cV()}}function pe(e){let t=0;return h5(e.fields,(e,n)=>{t+=e.length+f8(n)}),t}function pt(e){return(e.values||[]).reduce((e,t)=>e+f8(t),0)}function pn(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function pr(e){return!!e&&"integerValue"in e}function pi(e){return!!e&&"doubleValue"in e}function ps(e){return pr(e)||pi(e)}function pa(e){return!!e&&"arrayValue"in e}function po(e){return!!e&&"nullValue"in e}function pl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function pu(e){return!!e&&"mapValue"in e}function pc(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[fA])||void 0===n?void 0:n.stringValue)===fP}function pd(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){let t={mapValue:{fields:{}}};return h5(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=pd(n)),t}{if(!e.arrayValue)return Object.assign({},e);let t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=pd(e.arrayValue.values[n]);return t}}function ph(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===fO}let pf={mapValue:{fields:{[fA]:{stringValue:fP},[fL]:{arrayValue:{}}}}};function pp(e){if("nullValue"in e)return fB;if("booleanValue"in e)return{booleanValue:!1};if("integerValue"in e||"doubleValue"in e)return{doubleValue:NaN};if("timestampValue"in e)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in e)return{stringValue:""};if("bytesValue"in e)return{bytesValue:""};if("referenceValue"in e)return pn(f_.empty(),ds.empty());else if("geoPointValue"in e)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in e)return{arrayValue:{}};else if(!("mapValue"in e))return cV();else return pc(e)?pf:{mapValue:{}}}function pm(e){if("nullValue"in e)return{booleanValue:!1};if("booleanValue"in e)return{doubleValue:NaN};if("integerValue"in e||"doubleValue"in e)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in e)return{stringValue:""};if("stringValue"in e)return{bytesValue:""};if("bytesValue"in e)return pn(f_.empty(),ds.empty());if("referenceValue"in e)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in e)return{arrayValue:{}};else if("arrayValue"in e)return pf;else if(!("mapValue"in e))return cV();else return pc(e)?{mapValue:{}}:fM}function pg(e,t){let n=fH(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function py(e,t){let n=fH(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class pv{constructor(e){this.value=e}static empty(){return new pv({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(!pu(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=pd(t)}setAll(e){let t=di.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=pd(e):r.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){let t=this.field(e.popLast());pu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return fj(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];pu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){for(let r of(h5(t,(t,n)=>e[t]=n),n))delete e[r]}clone(){return new pv(pd(this.value))}}function pb(e){let t=[];return h5(e.fields,(e,n)=>{let r=new di([e]);if(pu(n)){let e=pb(n.mapValue).fields;if(0===e.length)t.push(r);else for(let n of e)t.push(r.child(n))}else t.push(r)}),new fa(t)}class pw{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new pw(e,0,c8.min(),c8.min(),c8.min(),pv.empty(),0)}static newFoundDocument(e,t,n,r){return new pw(e,1,t,c8.min(),n,r,0)}static newNoDocument(e,t){return new pw(e,2,t,c8.min(),c8.min(),pv.empty(),0)}static newUnknownDocument(e,t){return new pw(e,3,t,c8.min(),c8.min(),pv.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(c8.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pv.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pv.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=c8.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof pw&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pw(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function pS(e,t,n){let r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?fH(r,i):cV()}class pT{constructor(e,t){this.position=e,this.inclusive=t}}function pC(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let s=t[i],a=e.position[i];if(r=s.field.isKeyField()?ds.comparator(ds.fromName(a.referenceValue),n.key):fH(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function pE(e,t,n){let r=pC(e,t,n);return e.inclusive?r>=0:r>0}function px(e,t,n){let r=pC(e,t,n);return e.inclusive?r<=0:r<0}function p_(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!fj(e.position[n],t.position[n]))return!1;return!0}class pI{constructor(e,t="asc"){this.field=e,this.dir=t}}function pk(e){return e.field.canonicalString()+e.dir}function pD(e){return`${e.field.canonicalString()} (${e.dir})`}function pR(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class pN{}class pA extends pN{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new pH(e,t,n):"array-contains"===t?new pY(e,n):"in"===t?new pJ(e,n):"not-in"===t?new pX(e,n):"array-contains-any"===t?new pZ(e,n):new pA(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new pG(e,n):new pK(e,n)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(fH(t,this.value)):null!==t&&fF(this.value)===fF(t)&&this.matchesComparison(fH(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return cV()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pO extends pN{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new pO(e,t)}matches(e){return pM(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function pM(e){return"and"===e.op}function pP(e){return"or"===e.op}function pL(e){return pB(e)&&pM(e)}function pB(e){for(let t of e.filters)if(t instanceof pO)return!1;return!0}function pF(e){if(e instanceof pA)return e.field.canonicalString()+e.op.toString()+f1(e.value);if(pL(e))return e.filters.map(e=>pF(e)).join(",");{let t=e.filters.map(e=>pF(e)).join(",");return`${e.op}(${t})`}}function pj(e,t){return e instanceof pA?pV(e,t):e instanceof pO?pU(e,t):void cV()}function pV(e,t){return t instanceof pA&&e.op===t.op&&e.field.isEqual(t.field)&&fj(e.value,t.value)}function pU(e,t){return t instanceof pO&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&pj(n,t.filters[r]),!0)}function pz(e,t){let n=e.filters.concat(t);return pO.create(n,e.op)}function pq(e){return e instanceof pA?p$(e):e instanceof pO?pW(e):"Filter"}function pW(e){return e.op.toString()+" {"+e.getFilters().map(pq).join(" ,")+"}"}function p$(e){return`${e.field.canonicalString()} ${e.op} ${f1(e.value)}`}class pH extends pA{constructor(e,t,n){super(e,t,n),this.key=ds.fromName(n.referenceValue)}matches(e){let t=ds.comparator(e.key,this.key);return this.matchesComparison(t)}}class pG extends pA{constructor(e,t){super(e,"in",t),this.keys=pQ("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class pK extends pA{constructor(e,t){super(e,"not-in",t),this.keys=pQ("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function pQ(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>ds.fromName(e.referenceValue))}class pY extends pA{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return pa(t)&&f$(t.arrayValue,this.value)}}class pJ extends pA{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&f$(this.value.arrayValue,t)}}class pX extends pA{constructor(e,t){super(e,"not-in",t)}matches(e){if(f$(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&!f$(this.value.arrayValue,t)}}class pZ extends pA{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!!pa(t)&&!!t.arrayValue.values&&t.arrayValue.values.some(e=>f$(this.value.arrayValue,e))}}class p0{constructor(e,t=null,n=[],r=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.memoizedCanonicalId=null}}function p1(e,t=null,n=[],r=[],i=null,s=null,a=null){return new p0(e,t,n,r,i,s,a)}function p2(e){let t=cz(e);if(null===t.memoizedCanonicalId){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:"+t.filters.map(e=>pF(e)).join(",")+"|ob:"+t.orderBy.map(e=>pk(e)).join(","),fD(t.limit)||(e+="|l:"+t.limit),t.startAt&&(e+="|lb:"+(t.startAt.inclusive?"b:":"a:")+t.startAt.position.map(e=>f1(e)).join(",")),t.endAt&&(e+="|ub:"+(t.endAt.inclusive?"a:":"b:")+t.endAt.position.map(e=>f1(e)).join(",")),t.memoizedCanonicalId=e}return t.memoizedCanonicalId}function p4(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>pq(e)).join(", ")}]`),fD(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>pD(e)).join(", ")}]`),e.startAt&&(t+=", startAt: "+(e.startAt.inclusive?"b:":"a:")+e.startAt.position.map(e=>f1(e)).join(",")),e.endAt&&(t+=", endAt: "+(e.endAt.inclusive?"a:":"b:")+e.endAt.position.map(e=>f1(e)).join(",")),`Target(${t})`}function p3(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!pR(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!pj(e.filters[n],t.filters[n]))return!1;return!!(e.collectionGroup===t.collectionGroup&&e.path.isEqual(t.path)&&p_(e.startAt,t.startAt))&&p_(e.endAt,t.endAt)}function p6(e){return ds.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function p5(e,t){return e.filters.filter(e=>e instanceof pA&&e.field.isEqual(t))}function p9(e,t){let n=dc(t);if(void 0===n)return null;for(let t of p5(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}function p7(e,t){let n=new Map;for(let r of dd(t))for(let t of p5(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}function p8(e,t){let n=[],r=!0;for(let i of dd(t)){let t=0===i.kind?mt(e,i.fieldPath,e.startAt):mn(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new pT(n,r)}function me(e,t){let n=[],r=!0;for(let i of dd(t)){let t=0===i.kind?mn(e,i.fieldPath,e.endAt):mt(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new pT(n,r)}function mt(e,t,n){let r=fB,i=!0;for(let n of p5(e,t)){let e=fB,t=!0;switch(n.op){case"<":case"<=":e=pp(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=fB}0>pg({value:r,inclusive:i},{value:e,inclusive:t})&&(r=e,i=t)}if(null!==n){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=n.position[s];0>pg({value:r,inclusive:i},{value:e,inclusive:n.inclusive})&&(r=e,i=n.inclusive);break}}return{value:r,inclusive:i}}function mn(e,t,n){let r=fM,i=!0;for(let n of p5(e,t)){let e=fM,t=!0;switch(n.op){case">=":case">":e=pm(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=fM}py({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=n.position[s];py({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}}return{value:r,inclusive:i}}function mr(e){let t=new fn(di.comparator),n=!1;for(let r of e.filters)for(let e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(let n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}function mi(e){return null!==e.limit}class ms{constructor(e,t=null,n=[],r=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function ma(e,t,n,r,i,s,a,o){return new ms(e,t,n,r,i,s,a,o)}function mo(e){return new ms(e)}function ml(e,t){return new ms(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function mu(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function mc(e){let t=new fn(di.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}function md(e){return ds.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function mh(e){return null!==e.collectionGroup}function mf(e){let t=cz(e);if(null===t.memoizedNormalizedOrderBy){t.memoizedNormalizedOrderBy=[];let e=new Set;for(let n of t.explicitOrderBy)t.memoizedNormalizedOrderBy.push(n),e.add(n.field.canonicalString());let n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";mc(t).forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.memoizedNormalizedOrderBy.push(new pI(r,n))}),e.has(di.keyField().canonicalString())||t.memoizedNormalizedOrderBy.push(new pI(di.keyField(),n))}return t.memoizedNormalizedOrderBy}function mp(e){let t=cz(e);return t.memoizedTarget||(t.memoizedTarget=mg(t,mf(e))),t.memoizedTarget}function mm(e){let t=cz(e);return t.memoizedAggregateTarget||(t.memoizedAggregateTarget=mg(t,e.explicitOrderBy)),t.memoizedAggregateTarget}function mg(e,t){if("F"===e.limitType)return p1(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new pI(e.field,t)});let n=e.endAt?new pT(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new pT(e.startAt.position,e.startAt.inclusive):null;return p1(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function my(e,t){let n=e.filters.concat([t]);return new ms(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function mv(e,t){let n=e.explicitOrderBy.concat([t]);return new ms(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function mb(e,t,n){return new ms(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function mw(e,t){return new ms(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}function mS(e,t){return new ms(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}function mT(e,t){return p3(mp(e),mp(t))&&e.limitType===t.limitType}function mC(e){return`${p2(mp(e))}|lt:${e.limitType}`}function mE(e){return`Query(target=${p4(mp(e))}; limitType=${e.limitType})`}function mx(e,t){return t.isFoundDocument()&&m_(e,t)&&mI(e,t)&&mk(e,t)&&mD(e,t)}function m_(e,t){let n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ds.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}function mI(e,t){for(let n of mf(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}function mk(e,t){for(let n of e.filters)if(!n.matches(t))return!1;return!0}function mD(e,t){return(!e.startAt||!!px(e.startAt,mf(e),t))&&(!e.endAt||!!pE(e.endAt,mf(e),t))}function mR(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function mN(e){return(t,n)=>{let r=!1;for(let i of mf(e)){let e=mA(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function mA(e,t,n){let r=e.field.isKeyField()?ds.comparator(t.key,n.key):pS(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return -1*r;default:return cV()}}class mO{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){for(let[t,r]of n)if(this.equalsFn(t,e))return r}}has(e){return void 0!==this.get(e)}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r){this.inner[n]=[[e,t]],this.innerSize++;return}for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e)){r[n]=[e,t];return}r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){h5(this.inner,(t,n)=>{for(let[t,r]of n)e(t,r)})}isEmpty(){return h9(this.inner)}size(){return this.innerSize}}let mM=new h7(ds.comparator);function mP(){return mM}let mL=new h7(ds.comparator);function mB(...e){let t=mL;for(let n of e)t=t.insert(n.key,n);return t}function mF(){return mz()}function mj(e){let t=mL;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function mV(){return mz()}function mU(){return mz()}function mz(){return new mO(e=>e.toString(),(e,t)=>e.isEqual(t))}let mq=new h7(ds.comparator);function mW(){return mq}let m$=new fn(ds.comparator);function mH(...e){let t=m$;for(let n of e)t=t.add(n);return t}let mG=new fn(c4);function mK(){return mG}function mQ(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fR(t)?"-0":t}}function mY(e){return{integerValue:""+e}}function mJ(e,t){return fN(t)?mY(t):mQ(e,t)}class mX{constructor(){this._=void 0}}function mZ(e,t,n){return e instanceof m4?fS(n,t):e instanceof m3?m6(e,t):e instanceof m5?m9(e,t):m8(e,t)}function m0(e,t,n){return e instanceof m3?m6(e,t):e instanceof m5?m9(e,t):n}function m1(e,t){return e instanceof m7?ps(t)?t:{integerValue:0}:null}function m2(e,t){return e instanceof m3&&t instanceof m3||e instanceof m5&&t instanceof m5?c3(e.elements,t.elements,fj):e instanceof m7&&t instanceof m7?fj(e.operand,t.operand):e instanceof m4&&t instanceof m4}class m4 extends mX{}class m3 extends mX{constructor(e){super(),this.elements=e}}function m6(e,t){let n=gt(t);for(let t of e.elements)n.some(e=>fj(e,t))||n.push(t);return{arrayValue:{values:n}}}class m5 extends mX{constructor(e){super(),this.elements=e}}function m9(e,t){let n=gt(t);for(let t of e.elements)n=n.filter(e=>!fj(e,t));return{arrayValue:{values:n}}}class m7 extends mX{constructor(e,t){super(),this.serializer=e,this.operand=t}}function m8(e,t){let n=m1(e,t),r=ge(n)+ge(e.operand);return pr(n)&&pr(e.operand)?mY(r):mQ(e.serializer,r)}function ge(e){return fp(e.integerValue||e.doubleValue)}function gt(e){return pa(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class gn{constructor(e,t){this.field=e,this.transform=t}}function gr(e,t){return e.field.isEqual(t.field)&&m2(e.transform,t.transform)}function gi(e,t){return void 0===e&&void 0===t||!!e&&!!t&&c3(e,t,(e,t)=>gr(e,t))}class gs{constructor(e,t){this.version=e,this.transformResults=t}}class ga{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ga}static exists(e){return new ga(void 0,e)}static updateTime(e){return new ga(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function go(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class gl{}function gu(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new gC(e.key,ga.none()):new gp(e.key,e.data,ga.none());{let n=e.data,r=pv.empty(),i=new fn(di.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new gy(e.key,r,new fa(i.toArray()),ga.none())}}function gc(e,t,n){e instanceof gp?gm(e,t,n):e instanceof gy?gv(e,t,n):gE(e,t,n)}function gd(e,t,n,r){return e instanceof gp?gg(e,t,n,r):e instanceof gy?gb(e,t,n,r):gx(e,t,n)}function gh(e,t){let n=null;for(let r of e.fieldTransforms){let e=t.data.field(r.field),i=m1(r.transform,e||null);null!=i&&(null===n&&(n=pv.empty()),n.set(r.field,i))}return n||null}function gf(e,t){return!!(e.type===t.type&&e.key.isEqual(t.key)&&e.precondition.isEqual(t.precondition)&&gi(e.fieldTransforms,t.fieldTransforms))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class gp extends gl{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}function gm(e,t,n){let r=e.value.clone(),i=gS(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}function gg(e,t,n,r){if(!go(e.precondition,t))return n;let i=e.value.clone(),s=gT(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}class gy extends gl{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function gv(e,t,n){if(!go(e.precondition,t)){t.convertToUnknownDocument(n.version);return}let r=gS(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(gw(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}function gb(e,t,n,r){if(!go(e.precondition,t))return n;let i=gT(e.fieldTransforms,r,t),s=t.data;return(s.setAll(gw(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n)?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}function gw(e){let t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}}),t}function gS(e,t,n){let r=new Map;cU(e.length===n.length);for(let i=0;i<n.length;i++){let s=e[i],a=s.transform,o=t.data.field(s.field);r.set(s.field,m0(a,o,n[i]))}return r}function gT(e,t,n){let r=new Map;for(let i of e){let e=i.transform,s=n.data.field(i.field);r.set(i.field,mZ(e,s,t))}return r}class gC extends gl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function gE(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}function gx(e,t,n){return go(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}class g_ extends gl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gI{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let r=this.mutations[t];r.key.isEqual(e.key)&&gc(r,e,n[t])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=gd(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=gd(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=mU();return this.mutations.forEach(r=>{let i=e.get(r.key),s=i.overlayedDocument,a=this.applyToLocalView(s,i.mutatedFields),o=gu(s,a=t.has(r.key)?null:a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(c8.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),mH())}isEqual(e){return this.batchId===e.batchId&&c3(this.mutations,e.mutations,(e,t)=>gf(e,t))&&c3(this.baseMutations,e.baseMutations,(e,t)=>gf(e,t))}}class gk{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){cU(e.mutations.length===n.length);let r=mW(),i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new gk(e,t,n,r)}}class gD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gR{constructor(e,t){this.count=e,this.unchangedNames=t}}function gN(e){switch(e){case cq.OK:return cV();case cq.CANCELLED:case cq.UNKNOWN:case cq.DEADLINE_EXCEEDED:case cq.RESOURCE_EXHAUSTED:case cq.INTERNAL:case cq.UNAVAILABLE:case cq.UNAUTHENTICATED:return!1;case cq.INVALID_ARGUMENT:case cq.NOT_FOUND:case cq.ALREADY_EXISTS:case cq.PERMISSION_DENIED:case cq.FAILED_PRECONDITION:case cq.ABORTED:case cq.OUT_OF_RANGE:case cq.UNIMPLEMENTED:case cq.DATA_LOSS:return!0;default:return cV()}}function gA(e){return gN(e)&&e!==cq.ABORTED}function gO(e){if(void 0===e)return cB("GRPC error has no .code"),cq.UNKNOWN;switch(e){case h.OK:return cq.OK;case h.CANCELLED:return cq.CANCELLED;case h.UNKNOWN:return cq.UNKNOWN;case h.DEADLINE_EXCEEDED:return cq.DEADLINE_EXCEEDED;case h.RESOURCE_EXHAUSTED:return cq.RESOURCE_EXHAUSTED;case h.INTERNAL:return cq.INTERNAL;case h.UNAVAILABLE:return cq.UNAVAILABLE;case h.UNAUTHENTICATED:return cq.UNAUTHENTICATED;case h.INVALID_ARGUMENT:return cq.INVALID_ARGUMENT;case h.NOT_FOUND:return cq.NOT_FOUND;case h.ALREADY_EXISTS:return cq.ALREADY_EXISTS;case h.PERMISSION_DENIED:return cq.PERMISSION_DENIED;case h.FAILED_PRECONDITION:return cq.FAILED_PRECONDITION;case h.ABORTED:return cq.ABORTED;case h.OUT_OF_RANGE:return cq.OUT_OF_RANGE;case h.UNIMPLEMENTED:return cq.UNIMPLEMENTED;case h.DATA_LOSS:return cq.DATA_LOSS;default:return cV()}}!function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS"}(h||(h={}));class gM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}let gP=null;function gL(e){if(gP)throw Error("a TestingHooksSpi instance is already set");gP=e}function gB(){return new cT.TextEncoder}function gF(){return new TextDecoder("utf-8")}let gj=new c([4294967295,4294967295],0);function gV(e){let t=gB().encode(e),n=new d;return n.update(t),new Uint8Array(n.digest())}function gU(e){let t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new c([n,r],0),new c([i,s],0)]}class gz{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new gq(`Invalid padding: ${t}`);if(n<0||e.length>0&&0===this.hashCount)throw new gq(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new gq(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=8*e.length-t,this.bitCountInInteger=c.fromNumber(this.bitCount)}getBitIndex(e,t,n){let r=e.add(t.multiply(c.fromNumber(n)));return 1===r.compare(gj)&&(r=new c([r.getBits(0),r.getBits(1)],0)),r.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(0===this.bitCount)return!1;let[t,n]=gU(gV(e));for(let e=0;e<this.hashCount;e++){let r=this.getBitIndex(t,n,e);if(!this.isBitSet(r))return!1}return!0}static create(e,t,n){let r=e%8==0?0:8-e%8,i=new gz(new Uint8Array(Math.ceil(e/8)),r,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.bitCount)return;let[t,n]=gU(gV(e));for(let e=0;e<this.hashCount;e++){let r=this.getBitIndex(t,n,e);this.setBit(r)}}setBit(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class gq extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gW{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let r=new Map;return r.set(e,g$.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new gW(c8.min(),r,new h7(c4),mP(),mH())}}class g${constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new g$(n,t,mH(),mH(),mH())}}class gH{constructor(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r}}class gG{constructor(e,t){this.targetId=e,this.existenceFilter=t}}class gK{constructor(e,t,n=fu.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class gQ{constructor(){this.pendingResponses=0,this.documentChanges=gZ(),this._resumeToken=fu.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=mH(),t=mH(),n=mH();return this.documentChanges.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:cV()}}),new g$(this._resumeToken,this._current,e,t,n)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=gZ()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,cU(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let gY="WatchChangeAggregator";class gJ{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=mP(),this.pendingDocumentUpdatesByTarget=gX(),this.pendingDocumentTargetMapping=gX(),this.pendingTargetResets=new h7(c4)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let n=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&n.updateResumeToken(e.resumeToken);break;case 1:n.recordTargetResponse(),n.isPending||n.clearPendingChanges(),n.updateResumeToken(e.resumeToken);break;case 2:n.recordTargetResponse(),n.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(n.markCurrent(),n.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),n.updateResumeToken(e.resumeToken));break;default:cV()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((e,n)=>{this.isActiveTarget(n)&&t(n)})}handleExistenceFilter(e){let t=e.targetId,n=e.existenceFilter.count,r=this.targetDataForActiveTarget(t);if(r){let i=r.target;if(p6(i)){if(0===n){let e=new ds(i.path);this.removeDocumentFromTarget(t,e,pw.newNoDocument(e,c8.min()))}else cU(1===n)}else{let r=this.getCurrentDocumentCountForTarget(t);if(r!==n){let n=this.parseBloomFilter(e),i=n?this.applyBloomFilter(n,e,r):1;if(0!==i){this.resetTarget(t);let e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,e)}null==gP||gP.notifyOnExistenceFilterMismatch(g0(r,e.existenceFilter,this.metadataProvider.getDatabaseId(),n,i))}}}}parseBloomFilter(e){let t,n;let r=e.existenceFilter.unchangedNames;if(!r||!r.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=r;try{t=fm(i).toUint8Array()}catch(e){if(e instanceof gM)return cF("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{n=new gz(t,s,a)}catch(e){return e instanceof gq?cF("BloomFilter error: ",e):cF("Applying bloom filter failed: ",e),null}return 0===n.bitCount?null:n}applyBloomFilter(e,t,n){return t.existenceFilter.count===n-this.filterRemovedDocuments(e,t.targetId)?0:2}filterRemovedDocuments(e,t){let n=this.metadataProvider.getRemoteKeysForTarget(t),r=0;return n.forEach(n=>{let i=this.metadataProvider.getDatabaseId(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;!e.mightContain(s)&&(this.removeDocumentFromTarget(t,n,null),r++)}),r}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((n,r)=>{let i=this.targetDataForActiveTarget(r);if(i){if(n.current&&p6(i.target)){let t=new ds(i.target.path);this.ensureDocumentUpdateByTarget(t).has(r)||this.targetContainsDocument(r,t)||this.removeDocumentFromTarget(r,t,pw.newNoDocument(t,e))}n.hasPendingChanges&&(t.set(r,n.toTargetChange()),n.clearPendingChanges())}});let n=mH();this.pendingDocumentTargetMapping.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{let t=this.targetDataForActiveTarget(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.pendingDocumentUpdates.forEach((t,n)=>n.setReadTime(e));let r=new gW(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,n);return this.pendingDocumentUpdates=mP(),this.pendingDocumentUpdatesByTarget=gX(),this.pendingDocumentTargetMapping=gX(),this.pendingTargetResets=new h7(c4),r}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let n=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(t.key,this.ensureDocumentUpdateByTarget(t.key).add(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,n){if(!this.isActiveTarget(e))return;let r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,1):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).add(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new gQ,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new fn(c4),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}ensureDocumentUpdateByTarget(e){let t=this.pendingDocumentUpdatesByTarget.get(e);return t||(t=new fn(c4),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(e,t)),t}isActiveTarget(e){let t=null!==this.targetDataForActiveTarget(e);return t||cL(gY,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new gQ),this.metadataProvider.getRemoteKeysForTarget(e).forEach(t=>{this.removeDocumentFromTarget(e,t,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}}function gX(){return new h7(ds.comparator)}function gZ(){return new h7(ds.comparator)}function g0(e,t,n,r,i){var s,a,o,l,u,c;let d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(o=null===(a=null==h?void 0:h.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(c=null===(u=null==h?void 0:h.bits)||void 0===u?void 0:u.padding)&&void 0!==c?c:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}let g1=(()=>{let e={};return e.asc="ASCENDING",e.desc="DESCENDING",e})(),g2=(()=>{let e={};return e["<"]="LESS_THAN",e["<="]="LESS_THAN_OR_EQUAL",e[">"]="GREATER_THAN",e[">="]="GREATER_THAN_OR_EQUAL",e["=="]="EQUAL",e["!="]="NOT_EQUAL",e["array-contains"]="ARRAY_CONTAINS",e.in="IN",e["not-in"]="NOT_IN",e["array-contains-any"]="ARRAY_CONTAINS_ANY",e})(),g4=(()=>{let e={};return e.and="AND",e.or="OR",e})();class g3{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function g6(e){return new cW(void 0===e.code?cq.UNKNOWN:gO(e.code),e.message||"")}function g5(e,t){return e.useProto3Json||fD(t)?t:{value:t}}function g9(e){let t;return fD(t="object"==typeof e?e.value:e)?null:t}function g7(e,t){if(!e.useProto3Json)return{seconds:""+t.seconds,nanos:t.nanoseconds};{let e=new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),n=("000000000"+t.nanoseconds).slice(-9);return`${e}.${n}Z`}}function g8(e){let t=ff(e);return new c7(t.seconds,t.nanos)}function ye(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function yt(e,t){return e.useProto3Json?(cU(void 0===t||"string"==typeof t),fu.fromBase64String(t||"")):(cU(void 0===t||t instanceof Buffer||t instanceof Uint8Array),fu.fromUint8Array(t||new Uint8Array))}function yn(e,t){return g7(e,t.toTimestamp())}function yr(e){return cU(!!e),c8.fromTimestamp(g8(e))}function yi(e,t){return ys(e,t).canonicalString()}function ys(e,t){let n=yh(e).child("documents");return void 0===t?n:n.child(t)}function ya(e){let t=dn.fromString(e);return cU(vr(t)),t}function yo(e,t){return yi(e.databaseId,t.path)}function yl(e,t){let n=ya(t);if(n.get(1)!==e.databaseId.projectId)throw new cW(cq.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new cW(cq.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ds(yf(n))}function yu(e,t){return yi(e.databaseId,t)}function yc(e){let t=ya(e);return 4===t.length?dn.emptyPath():yf(t)}function yd(e){return new dn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function yh(e){return new dn(["projects",e.projectId,"databases",e.database])}function yf(e){return cU(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function yp(e,t,n){return{name:yo(e,t),fields:n.value.mapValue.fields}}function ym(e,t){return{name:yo(e,t.key),fields:t.data.value.mapValue.fields,updateTime:g7(e,t.version.toTimestamp()),createTime:g7(e,t.createTime.toTimestamp())}}function yg(e,t,n){let r=yl(e,t.name),i=yr(t.updateTime),s=t.createTime?yr(t.createTime):c8.min(),a=new pv({mapValue:{fields:t.fields}}),o=pw.newFoundDocument(r,i,s,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function yy(e,t){cU(!!t.found),t.found.name,t.found.updateTime;let n=yl(e,t.found.name),r=yr(t.found.updateTime),i=t.found.createTime?yr(t.found.createTime):c8.min(),s=new pv({mapValue:{fields:t.found.fields}});return pw.newFoundDocument(n,r,i,s)}function yv(e,t){cU(!!t.missing),cU(!!t.readTime);let n=yl(e,t.missing),r=yr(t.readTime);return pw.newNoDocument(n,r)}function yb(e,t){return"found"in t?yy(e,t):"missing"in t?yv(e,t):cV()}function yw(e,t){let n;if("targetChange"in t){t.targetChange;let r=yS(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=yt(e,t.targetChange.resumeToken),a=t.targetChange.cause;n=new gK(r,i,s,a&&g6(a)||null)}else if("documentChange"in t){t.documentChange;let r=t.documentChange;r.document,r.document.name,r.document.updateTime;let i=yl(e,r.document.name),s=yr(r.document.updateTime),a=r.document.createTime?yr(r.document.createTime):c8.min(),o=new pv({mapValue:{fields:r.document.fields}}),l=pw.newFoundDocument(i,s,a,o);n=new gH(r.targetIds||[],r.removedTargetIds||[],l.key,l)}else if("documentDelete"in t){t.documentDelete;let r=t.documentDelete;r.document;let i=yl(e,r.document),s=r.readTime?yr(r.readTime):c8.min(),a=pw.newNoDocument(i,s);n=new gH([],r.removedTargetIds||[],a.key,a)}else if("documentRemove"in t){t.documentRemove;let r=t.documentRemove;r.document;let i=yl(e,r.document);n=new gH([],r.removedTargetIds||[],i,null)}else{if(!("filter"in t))return cV();t.filter;let e=t.filter;e.targetId;let{count:r=0,unchangedNames:i}=e,s=new gR(r,i);n=new gG(e.targetId,s)}return n}function yS(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:cV()}function yT(e){if(!("targetChange"in e))return c8.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length||!t.readTime?c8.min():yr(t.readTime)}function yC(e,t){let n;if(t instanceof gp)n={update:yp(e,t.key,t.value)};else if(t instanceof gC)n={delete:yo(e,t.key)};else if(t instanceof gy)n={update:yp(e,t.key,t.data),updateMask:vt(t.fieldMask)};else{if(!(t instanceof g_))return cV();n={verify:yo(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(t=>yD(e,t))),t.precondition.isNone||(n.currentDocument=yx(e,t.precondition)),n}function yE(e,t){let n=t.currentDocument?y_(t.currentDocument):ga.none(),r=t.updateTransforms?t.updateTransforms.map(t=>yR(e,t)):[];if(t.update){t.update.name;let i=yl(e,t.update.name),s=new pv({mapValue:{fields:t.update.fields}});return t.updateMask?new gy(i,s,vn(t.updateMask),n,r):new gp(i,s,n,r)}return t.delete?new gC(yl(e,t.delete),n):t.verify?new g_(yl(e,t.verify),n):cV()}function yx(e,t){return void 0!==t.updateTime?{updateTime:yn(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:cV()}function y_(e){return void 0!==e.updateTime?ga.updateTime(yr(e.updateTime)):void 0!==e.exists?ga.exists(e.exists):ga.none()}function yI(e,t){let n=e.updateTime?yr(e.updateTime):yr(t);return n.isEqual(c8.min())&&(n=yr(t)),new gs(n,e.transformResults||[])}function yk(e,t){return e&&e.length>0?(cU(void 0!==t),e.map(e=>yI(e,t))):[]}function yD(e,t){let n=t.transform;if(n instanceof m4)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof m3)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof m5)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof m7)return{fieldPath:t.field.canonicalString(),increment:n.operand};throw cV()}function yR(e,t){let n=null;return"setToServerValue"in t?(cU("REQUEST_TIME"===t.setToServerValue),n=new m4):"appendMissingElements"in t?n=new m3(t.appendMissingElements.values||[]):"removeAllFromArray"in t?n=new m5(t.removeAllFromArray.values||[]):"increment"in t?n=new m7(e,t.increment):cV(),new gn(di.fromServerFormat(t.fieldPath),n)}function yN(e,t){return{documents:[yu(e,t.path)]}}function yA(e){return cU(1===e.documents.length),mp(mo(yc(e.documents[0])))}function yO(e,t){let n;let r={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n=i,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=i.popLast(),r.structuredQuery.from=[{collectionId:i.lastSegment()}]),r.parent=yu(e,n);let s=yV(t.filters);s&&(r.structuredQuery.where=s);let a=yq(t.orderBy);a&&(r.structuredQuery.orderBy=a);let o=g5(e,t.limit);return null!==o&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=y$(t.startAt)),t.endAt&&(r.structuredQuery.endAt=yH(t.endAt)),{queryTarget:r,parent:n}}function yM(e,t,n,r){let{queryTarget:i,parent:s}=yO(e,t),a={},o=[],l=0;return n.forEach(e=>{let t=r?e.alias:`aggregate_${l++}`;a[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:y1(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:y1(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:i.structuredQuery},parent:i.parent},aliasMap:a,parent:s}}function yP(e){let t=yc(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){cU(1===r);let e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=yU(n.where));let a=[];n.orderBy&&(a=yW(n.orderBy));let o=null;n.limit&&(o=g9(n.limit));let l=null;n.startAt&&(l=yG(n.startAt));let u=null;return n.endAt&&(u=yK(n.endAt)),ma(t,i,a,s,o,"F",l,u)}function yL(e){return mp(yP(e))}function yB(e,t){let n=yF(t.purpose);return null==n?null:{"goog-listen-tags":n}}function yF(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cV()}}function yj(e,t){let n;let r=t.target;if((n=p6(r)?{documents:yN(e,r)}:{query:yO(e,r).queryTarget}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=ye(e,t.resumeToken);let r=g5(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(c8.min())>0){n.readTime=g7(e,t.snapshotVersion.toTimestamp());let r=g5(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}function yV(e){if(0!==e.length)return y6(pO.create(e,"and"))}function yU(e){let t=yz(e);return t instanceof pO&&pL(t)?t.getFilters():[t]}function yz(e){return void 0!==e.unaryFilter?y7(e):void 0!==e.fieldFilter?y8(e):void 0!==e.compositeFilter?ve(e):cV()}function yq(e){if(0!==e.length)return e.map(e=>y4(e))}function yW(e){return e.map(e=>y3(e))}function y$(e){return{before:e.inclusive,values:e.position}}function yH(e){return{before:!e.inclusive,values:e.position}}function yG(e){let t=!!e.before;return new pT(e.values||[],t)}function yK(e){let t=!e.before;return new pT(e.values||[],t)}function yQ(e){return g1[e]}function yY(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function yJ(e){return g2[e]}function yX(e){return g4[e]}function yZ(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return cV()}}function y0(e){switch(e){case"AND":return"and";case"OR":return"or";default:return cV()}}function y1(e){return{fieldPath:e.canonicalString()}}function y2(e){return di.fromServerFormat(e.fieldPath)}function y4(e){return{field:y1(e.field),direction:yQ(e.dir)}}function y3(e){return new pI(y2(e.field),yY(e.direction))}function y6(e){return e instanceof pA?y9(e):e instanceof pO?y5(e):cV()}function y5(e){let t=e.getFilters().map(e=>y6(e));return 1===t.length?t[0]:{compositeFilter:{op:yX(e.op),filters:t}}}function y9(e){if("=="===e.op){if(pl(e.value))return{unaryFilter:{field:y1(e.field),op:"IS_NAN"}};if(po(e.value))return{unaryFilter:{field:y1(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(pl(e.value))return{unaryFilter:{field:y1(e.field),op:"IS_NOT_NAN"}};if(po(e.value))return{unaryFilter:{field:y1(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:y1(e.field),op:yJ(e.op),value:e.value}}}function y7(e){switch(e.unaryFilter.op){case"IS_NAN":let t=y2(e.unaryFilter.field);return pA.create(t,"==",{doubleValue:NaN});case"IS_NULL":let n=y2(e.unaryFilter.field);return pA.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=y2(e.unaryFilter.field);return pA.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=y2(e.unaryFilter.field);return pA.create(i,"!=",{nullValue:"NULL_VALUE"});default:return cV()}}function y8(e){return pA.create(y2(e.fieldFilter.field),yZ(e.fieldFilter.op),e.fieldFilter.value)}function ve(e){return pO.create(e.compositeFilter.filters.map(e=>yz(e)),y0(e.compositeFilter.op))}function vt(e){let t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function vn(e){return new fa((e.fieldPaths||[]).map(e=>di.fromServerFormat(e)))}function vr(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class vi{constructor(e,t,n,r,i=c8.min(),s=c8.min(),a=fu.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new vi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class vs{constructor(e){this.remoteSerializer=e}}function va(e,t){let n;if(t.document)n=yg(e.remoteSerializer,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let e=ds.fromSegments(t.noDocument.path),r=vd(t.noDocument.readTime);n=pw.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return cV();let e=ds.fromSegments(t.unknownDocument.path),r=vd(t.unknownDocument.version);n=pw.newUnknownDocument(e,r)}return t.readTime&&n.setReadTime(vu(t.readTime)),n}function vo(e,t){let n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:vl(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=ym(e.remoteSerializer,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:vc(t.version)};else{if(!t.isUnknownDocument())return cV();r.unknownDocument={path:n.path.toArray(),version:vc(t.version)}}return r}function vl(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function vu(e){let t=new c7(e[0],e[1]);return c8.fromTimestamp(t)}function vc(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function vd(e){let t=new c7(e.seconds,e.nanoseconds);return c8.fromTimestamp(t)}function vh(e,t,n){let r=n.baseMutations.map(t=>yC(e.remoteSerializer,t)),i=n.mutations.map(t=>yC(e.remoteSerializer,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}function vf(e,t){let n=(t.baseMutations||[]).map(t=>yE(e.remoteSerializer,t));for(let e=0;e<t.mutations.length-1;++e){let n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){let r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}let r=t.mutations.map(t=>yE(e.remoteSerializer,t)),i=c7.fromMillis(t.localWriteTimeMs);return new gI(t.batchId,i,n,r)}function vp(e){let t;let n=vd(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?vd(e.lastLimboFreeSnapshotVersion):c8.min();return new vi(t=vg(e.query)?yA(e.query):yL(e.query),e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,n,r,fu.fromBase64String(e.resumeToken))}function vm(e,t){let n;let r=vc(t.snapshotVersion),i=vc(t.lastLimboFreeSnapshotVersion);n=p6(t.target)?yN(e.remoteSerializer,t.target):yO(e.remoteSerializer,t.target).queryTarget;let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:p2(t.target),readTime:r,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function vg(e){return void 0!==e.documents}function vy(e){return{id:e.bundleId,createTime:vd(e.createTime),version:e.version}}function vv(e){return{bundleId:e.id,createTime:vc(yr(e.createTime)),version:e.version}}function vb(e){return{name:e.name,query:vS(e.bundledQuery),readTime:vd(e.readTime)}}function vw(e){return{name:e.name,readTime:vc(yr(e.readTime)),bundledQuery:e.bundledQuery}}function vS(e){let t=yP({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?mb(t,t.limit,"L"):t}function vT(e){return{name:e.name,query:vS(e.bundledQuery),readTime:yr(e.readTime)}}function vC(e){return{id:e.id,version:e.version,createTime:yr(e.createTime)}}function vE(e,t){return new gD(t.largestBatchId,yE(e.remoteSerializer,t.overlayMutation))}function vx(e,t,n){let[r,i,s]=v_(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:yC(e.remoteSerializer,n.mutation)}}function v_(e,t){let n=t.path.lastSegment();return[e,dQ(t.path.popLast()),n]}function vI(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}function vk(e,t){let n=t?new dy(t.sequenceNumber,new dw(vd(t.readTime),new ds(dX(t.documentKey)),t.largestBatchId)):dy.empty(),r=e.fields.map(([e,t])=>new dm(di.fromServerFormat(e),t));return new du(e.indexId,e.collectionGroup,r,n)}function vD(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:vc(r.readTime),documentKey:dQ(r.documentKey.path),largestBatchId:r.largestBatchId}}class vR{getBundleMetadata(e,t){return vN(e).get(t).next(e=>{if(e)return vy(e)})}saveBundleMetadata(e,t){return vN(e).put(vv(t))}getNamedQuery(e,t){return vA(e).get(t).next(e=>{if(e)return vb(e)})}saveNamedQuery(e,t){return vA(e).put(vw(t))}}function vN(e){return h3(e,hx)}function vA(e){return h3(e,hI)}class vO{constructor(e,t){this.serializer=e,this.userId=t}static forUser(e,t){return new vO(e,t.uid||"")}getOverlay(e,t){return vM(e).get(v_(this.userId,t)).next(e=>e?vE(this.serializer,e):null)}getOverlays(e,t){let n=mV();return dx.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){let r=[];return n.forEach((n,i)=>{let s=new gD(t,i);r.push(this.saveOverlay(e,s))}),dx.waitFor(r)}removeOverlaysForBatchId(e,t,n){let r=new Set;t.forEach(e=>r.add(dQ(e.getCollectionPath())));let i=[];return r.forEach(t=>{let r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(vM(e).deleteAll(hq,r))}),dx.waitFor(i)}getOverlaysForCollection(e,t,n){let r=mV(),i=dQ(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return vM(e).loadAll(hq,s).next(e=>{for(let t of e){let e=vE(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){let i;let s=mV(),a=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return vM(e).iterate({index:h$,range:a},(e,t,n)=>{let a=vE(this.serializer,t);s.size()<r||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):n.done()}).next(()=>s)}saveOverlay(e,t){return vM(e).put(vx(this.serializer,this.userId,t))}}function vM(e){return h3(e,hU)}class vP{globalsStore(e){return h3(e,hG)}getSessionToken(e){return this.globalsStore(e).get("sessionToken").next(e=>{let t=null==e?void 0:e.value;return t?fu.fromUint8Array(t):fu.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.globalsStore(e).put({name:"sessionToken",value:t.toUint8Array()})}}let vL=5,vB=10,vF=13,vj=15,vV=20,vU=25,vz=30,vq=37,vW=45,v$=50,vH=53,vG=55,vK=60,vQ=2;class vY{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,vL);else if("booleanValue"in e)this.writeValueTypeLabel(t,vB),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,vj),t.writeNumber(fp(e.integerValue));else if("doubleValue"in e){let n=fp(e.doubleValue);isNaN(n)?this.writeValueTypeLabel(t,vF):(this.writeValueTypeLabel(t,vj),fR(n)?t.writeNumber(0):t.writeNumber(n))}else if("timestampValue"in e){let n=e.timestampValue;this.writeValueTypeLabel(t,vV),"string"==typeof n&&(n=ff(n)),t.writeString(`${n.seconds||""}`),t.writeNumber(n.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,vz),t.writeBytes(fm(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.writeValueTypeLabel(t,vW),t.writeNumber(n.latitude||0),t.writeNumber(n.longitude||0)}else"mapValue"in e?ph(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):pc(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):cV()}writeIndexString(e,t){this.writeValueTypeLabel(t,vU),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let n=e.fields||{};for(let e of(this.writeValueTypeLabel(t,vG),Object.keys(n)))this.writeIndexString(e,t),this.writeIndexValueAux(n[e],t)}writeIndexVector(e,t){var n,r;let i=e.fields||{};this.writeValueTypeLabel(t,vH);let s=fL,a=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.writeValueTypeLabel(t,vj),t.writeNumber(fp(a)),this.writeIndexString(s,t),this.writeIndexValueAux(i[s],t)}writeIndexArray(e,t){let n=e.values||[];for(let e of(this.writeValueTypeLabel(t,v$),n))this.writeIndexValueAux(e,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,vq),ds.fromName(e).path.forEach(e=>{this.writeValueTypeLabel(t,vK),this.writeUnlabeledIndexString(e,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(vQ)}}vY.INSTANCE=new vY;let vJ="\uD800",vX="\uDBFF",vZ=0,v0=255,v1=1,v2=255,v4=255,v3=0,v6=64,v5=8,v9=1024;function v7(e){let t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}function v8(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function be(e){let t=0;for(let n=0;n<8;++n){let r=v8(255&e[n]);if(t+=r,8!==r)break}return t}function bt(e){return Math.ceil((v6-be(e))/v5)}class bn{constructor(){this.buffer=new Uint8Array(v9),this.position=0}writeBytesAscending(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.writeByteAscending(n.value),n=t.next();this.writeSeparatorAscending()}writeBytesDescending(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.writeByteDescending(n.value),n=t.next();this.writeSeparatorDescending()}writeUtf8Ascending(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.writeByteAscending(e);else if(e<2048)this.writeByteAscending(960|e>>>6),this.writeByteAscending(128|63&e);else if(t<vJ||vX<t)this.writeByteAscending(480|e>>>12),this.writeByteAscending(128|63&e>>>6),this.writeByteAscending(128|63&e);else{let e=t.codePointAt(0);this.writeByteAscending(240|e>>>18),this.writeByteAscending(128|63&e>>>12),this.writeByteAscending(128|63&e>>>6),this.writeByteAscending(128|63&e)}}this.writeSeparatorAscending()}writeUtf8Descending(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.writeByteDescending(e);else if(e<2048)this.writeByteDescending(960|e>>>6),this.writeByteDescending(128|63&e);else if(t<vJ||vX<t)this.writeByteDescending(480|e>>>12),this.writeByteDescending(128|63&e>>>6),this.writeByteDescending(128|63&e);else{let e=t.codePointAt(0);this.writeByteDescending(240|e>>>18),this.writeByteDescending(128|63&e>>>12),this.writeByteDescending(128|63&e>>>6),this.writeByteDescending(128|63&e)}}this.writeSeparatorDescending()}writeNumberAscending(e){let t=this.toOrderedBits(e),n=bt(t);this.ensureAvailable(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}writeNumberDescending(e){let t=this.toOrderedBits(e),n=bt(t);this.ensureAvailable(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}writeInfinityAscending(){this.writeEscapedByteAscending(v2),this.writeEscapedByteAscending(v4)}writeInfinityDescending(){this.writeEscapedByteDescending(v2),this.writeEscapedByteDescending(v4)}reset(){this.position=0}seed(e){this.ensureAvailable(e.length),this.buffer.set(e,this.position),this.position+=e.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(e){let t=v7(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}writeByteAscending(e){let t=255&e;t===vZ?(this.writeEscapedByteAscending(vZ),this.writeEscapedByteAscending(v0)):t===v2?(this.writeEscapedByteAscending(v2),this.writeEscapedByteAscending(v3)):this.writeEscapedByteAscending(t)}writeByteDescending(e){let t=255&e;t===vZ?(this.writeEscapedByteDescending(vZ),this.writeEscapedByteDescending(v0)):t===v2?(this.writeEscapedByteDescending(v2),this.writeEscapedByteDescending(v3)):this.writeEscapedByteDescending(e)}writeSeparatorAscending(){this.writeEscapedByteAscending(vZ),this.writeEscapedByteAscending(v1)}writeSeparatorDescending(){this.writeEscapedByteDescending(vZ),this.writeEscapedByteDescending(v1)}writeEscapedByteAscending(e){this.ensureAvailable(1),this.buffer[this.position++]=e}writeEscapedByteDescending(e){this.ensureAvailable(1),this.buffer[this.position++]=~e}ensureAvailable(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class br{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesAscending(e)}writeString(e){this.orderedCode.writeUtf8Ascending(e)}writeNumber(e){this.orderedCode.writeNumberAscending(e)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class bi{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesDescending(e)}writeString(e){this.orderedCode.writeUtf8Descending(e)}writeNumber(e){this.orderedCode.writeNumberDescending(e)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class bs{constructor(){this.orderedCode=new bn,this.ascending=new br(this.orderedCode),this.descending=new bi(this.orderedCode)}seed(e){this.orderedCode.seed(e)}forKind(e){return 0===e?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}class ba{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}successor(){let e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new ba(this.indexId,this.documentKey,this.arrayValue,n)}}function bo(e,t){let n=e.indexId-t.indexId;return 0!==n||0!==(n=bl(e.arrayValue,t.arrayValue))||0!==(n=bl(e.directionalValue,t.directionalValue))?n:ds.comparator(e.documentKey,t.documentKey)}function bl(e,t){for(let n=0;n<e.length&&n<t.length;++n){let r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class bu{constructor(e){for(let t of(this.inequalityFilters=new fn((e,t)=>di.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.orderBys=e.orderBy,this.equalityFilters=[],e.filters)){let e=t;e.isInequality()?this.inequalityFilters=this.inequalityFilters.add(e):this.equalityFilters.push(e)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(e){if(cU(e.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let t=dc(e);if(void 0!==t&&!this.hasMatchingEqualityFilter(t))return!1;let n=dd(e),r=new Set,i=0,s=0;for(;i<n.length;++i)if(this.hasMatchingEqualityFilter(n[i]))r=r.add(n[i].fieldPath.canonicalString());else break;if(i===n.length)return!0;if(this.inequalityFilters.size>0){let e=this.inequalityFilters.getIterator().getNext();if(!r.has(e.field.canonicalString())){let t=n[i];if(!this.matchesFilter(e,t)||!this.matchesOrderBy(this.orderBys[s++],t))return!1}++i}for(;i<n.length;++i){let e=n[i];if(s>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[s++],e))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let e=new fn(di.comparator),t=[];for(let n of this.equalityFilters)if(!n.field.isKeyField()){if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new dm(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new dm(n.field,0))}}for(let n of this.orderBys)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new dm(n.field,"asc"===n.dir?0:1)));return new du(du.UNKNOWN_ID,this.collectionId,t,dy.empty())}hasMatchingEqualityFilter(e){for(let t of this.equalityFilters)if(this.matchesFilter(t,e))return!0;return!1}matchesFilter(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}matchesOrderBy(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function bc(e){var t,n;if(cU(e instanceof pA||e instanceof pO),e instanceof pA){if(!(e instanceof pJ))return e;{let r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>pA.create(e.field,"==",t)))||[];return pO.create(r,"or")}}let r=e.filters.map(e=>bc(e));return pO.create(r,e.op)}function bd(e){if(0===e.getFilters().length)return[];let t=bg(bc(e));return(cU(bp(t)),bh(t)||bf(t))?[t]:t.getFilters()}function bh(e){return e instanceof pA}function bf(e){return e instanceof pO&&pL(e)}function bp(e){return bh(e)||bf(e)||bm(e)}function bm(e){if(e instanceof pO&&pP(e)){for(let t of e.getFilters())if(!bh(t)&&!bf(t))return!1;return!0}return!1}function bg(e){if(cU(e instanceof pA||e instanceof pO),e instanceof pA)return e;if(1===e.filters.length)return bg(e.filters[0]);let t=e.filters.map(e=>bg(e)),n=pO.create(t,e.op);return bp(n=bS(n))?n:(cU(n instanceof pO),cU(pM(n)),cU(n.filters.length>1),n.filters.reduce((e,t)=>by(e,t)))}function by(e,t){let n;return cU(e instanceof pA||e instanceof pO),cU(t instanceof pA||t instanceof pO),bS(n=e instanceof pA?t instanceof pA?bv(e,t):bw(e,t):t instanceof pA?bw(t,e):bb(e,t))}function bv(e,t){return pO.create([e,t],"and")}function bb(e,t){if(cU(e.filters.length>0&&t.filters.length>0),pM(e)&&pM(t))return pz(e,t.getFilters());let n=pP(e)?e:t,r=pP(e)?t:e,i=n.filters.map(e=>by(e,r));return pO.create(i,"or")}function bw(e,t){if(pM(t))return pz(t,e.getFilters());{let n=t.filters.map(t=>by(e,t));return pO.create(n,"or")}}function bS(e){if(cU(e instanceof pA||e instanceof pO),e instanceof pA)return e;let t=e.getFilters();if(1===t.length)return bS(t[0]);if(pB(e))return e;let n=t.map(e=>bS(e)),r=[];return(n.forEach(t=>{t instanceof pA?r.push(t):t instanceof pO&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length)?r[0]:pO.create(r,e.op)}class bT{constructor(){this.collectionParentIndex=new bC}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),dx.resolve()}getCollectionParents(e,t){return dx.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return dx.resolve()}deleteFieldIndex(e,t){return dx.resolve()}deleteAllFieldIndexes(e){return dx.resolve()}createTargetIndexes(e,t){return dx.resolve()}getDocumentsMatchingTarget(e,t){return dx.resolve(null)}getIndexType(e,t){return dx.resolve(0)}getFieldIndexes(e,t){return dx.resolve([])}getNextCollectionGroupToUpdate(e){return dx.resolve(null)}getMinOffset(e,t){return dx.resolve(dw.min())}getMinOffsetFromCollectionGroup(e,t){return dx.resolve(dw.min())}updateCollectionGroup(e,t,n){return dx.resolve()}updateIndexEntries(e,t){return dx.resolve()}}class bC{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new fn(dn.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new fn(dn.comparator)).toArray()}}let bE="IndexedDbIndexManager",bx=new Uint8Array(0);class b_{constructor(e,t){this.databaseId=t,this.collectionParentsCache=new bC,this.targetToDnfSubTargets=new mO(e=>p2(e),(e,t)=>p3(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.collectionParentsCache.has(t)){let n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.collectionParentsCache.add(t)});let i={collectionId:n,parent:dQ(r)};return bI(e).put(i)}return dx.resolve()}getCollectionParents(e,t){let n=[],r=IDBKeyRange.bound([t,""],[c6(t),""],!1,!0);return bI(e).loadAll(r).next(e=>{for(let r of e){if(r.collectionId!==t)break;n.push(dX(r.parent))}return n})}addFieldIndex(e,t){let n=bD(e),r=vI(t);delete r.indexId;let i=n.add(r);if(!t.indexState)return i.next();{let n=bR(e);return i.next(e=>{n.put(vD(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}}deleteFieldIndex(e,t){let n=bD(e),r=bR(e),i=bk(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=bD(e),n=bk(e),r=bR(e);return t.deleteAll().next(()=>n.deleteAll()).next(()=>r.deleteAll())}createTargetIndexes(e,t){return dx.forEach(this.getSubTargets(t),t=>this.getIndexType(e,t).next(n=>{if(0===n||1===n){let n=new bu(t).buildTargetIndex();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,t){let n=bk(e),r=!0,i=new Map;return dx.forEach(this.getSubTargets(t),t=>this.getFieldIndex(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(!r)return dx.resolve(null);{let e=mH(),r=[];return dx.forEach(i,(i,s)=>{cL(bE,`Using index ${dp(i)} to execute ${p2(t)}`);let a=p9(s,i),o=p7(s,i),l=p8(s,i),u=me(s,i),c=this.encodeBound(i,s,l),d=this.encodeBound(i,s,u),h=this.encodeValues(i,s,o),f=this.generateIndexRanges(i.indexId,a,c,l.inclusive,d,u.inclusive,h);return dx.forEach(f,i=>n.loadFirst(i,t.limit).next(t=>{t.forEach(t=>{let n=ds.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}})}getSubTargets(e){let t=this.targetToDnfSubTargets.get(e);return t||(t=0===e.filters.length?[e]:bd(pO.create(e.filters,"and")).map(t=>p1(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.targetToDnfSubTargets.set(e,t)),t}generateIndexRanges(e,t,n,r,i,s,a){let o=(null!=t?t.length:1)*Math.max(n.length,i.length),l=o/(null!=t?t.length:1),u=[];for(let c=0;c<o;++c){let o=t?this.encodeSingleElement(t[c/l]):bx,d=this.generateLowerBound(e,o,n[c%l],r),h=this.generateUpperBound(e,o,i[c%l],s),f=a.map(t=>this.generateLowerBound(e,o,t,!0));u.push(...this.createRange(d,h,f))}return u}generateLowerBound(e,t,n,r){let i=new ba(e,ds.empty(),t,n);return r?i:i.successor()}generateUpperBound(e,t,n,r){let i=new ba(e,ds.empty(),t,n);return r?i.successor():i}getFieldIndex(e,t){let n=new bu(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(let r of e)n.servedByIndex(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2,r=this.getSubTargets(t);return dx.forEach(r,t=>this.getFieldIndex(e,t).next(e=>{e?0!==n&&e.fields.length<mr(t)&&(n=1):n=0})).next(()=>mi(t)&&r.length>1&&2===n?1:n)}encodeDirectionalElements(e,t){let n=new bs;for(let r of dd(e)){let e=t.data.field(r.fieldPath);if(null==e)return null;let i=n.forKind(r.kind);vY.INSTANCE.writeIndexValue(e,i)}return n.encodedBytes()}encodeSingleElement(e){let t=new bs;return vY.INSTANCE.writeIndexValue(e,t.forKind(0)),t.encodedBytes()}encodeDirectionalKey(e,t){let n=new bs;return vY.INSTANCE.writeIndexValue(pn(this.databaseId,t),n.forKind(dh(e))),n.encodedBytes()}encodeValues(e,t,n){if(null===n)return[];let r=[];r.push(new bs);let i=0;for(let s of dd(e)){let e=n[i++];for(let n of r)if(this.isInFilter(t,s.fieldPath)&&pa(e))r=this.expandIndexValues(r,s,e);else{let t=n.forKind(s.kind);vY.INSTANCE.writeIndexValue(e,t)}}return this.getEncodedBytes(r)}encodeBound(e,t,n){return this.encodeValues(e,t,n.position)}getEncodedBytes(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].encodedBytes();return t}expandIndexValues(e,t,n){let r=[...e],i=[];for(let e of n.arrayValue.values||[])for(let n of r){let r=new bs;r.seed(n.encodedBytes()),vY.INSTANCE.writeIndexValue(e,r.forKind(t.kind)),i.push(r)}return i}isInFilter(e,t){return!!e.filters.find(e=>e instanceof pA&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let n=bD(e),r=bR(e);return(t?n.loadAll(hN,IDBKeyRange.bound(t,t)):n.loadAll()).next(e=>{let t=[];return dx.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(vk(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:c4(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){let r=bD(e),i=bR(e);return this.getNextSequenceNumber(e).next(e=>r.loadAll(hN,IDBKeyRange.bound(t,t)).next(t=>dx.forEach(t,t=>i.put(vD(t.indexId,this.uid,e,n)))))}updateIndexEntries(e,t){let n=new Map;return dx.forEach(t,(t,r)=>{let i=n.get(t.collectionGroup);return(i?dx.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),dx.forEach(i,n=>this.getExistingIndexEntries(e,t,n).next(t=>{let i=this.computeIndexEntries(r,n);return t.isEqual(i)?dx.resolve():this.updateEntries(e,r,n,t,i)}))))})}addIndexEntry(e,t,n,r){return bk(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(n,t.key),documentKey:t.key.path.toArray()})}deleteIndexEntry(e,t,n,r){return bk(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.encodeDirectionalKey(n,t.key),t.key.path.toArray()])}getExistingIndexEntries(e,t,n){let r=bk(e),i=new fn(bo);return r.iterate({index:hj,range:IDBKeyRange.only([n.indexId,this.uid,this.encodeDirectionalKey(n,t)])},(e,r)=>{i=i.add(new ba(n.indexId,t,r.arrayValue,r.directionalValue))}).next(()=>i)}computeIndexEntries(e,t){let n=new fn(bo),r=this.encodeDirectionalElements(t,e);if(null==r)return n;let i=dc(t);if(null!=i){let s=e.data.field(i.fieldPath);if(pa(s))for(let i of s.arrayValue.values||[])n=n.add(new ba(t.indexId,e.key,this.encodeSingleElement(i),r))}else n=n.add(new ba(t.indexId,e.key,bx,r));return n}updateEntries(e,t,n,r,i){cL(bE,"Updating index entries for document '%s'",t.key);let s=[];return fi(r,i,bo,r=>{s.push(this.addIndexEntry(e,t,n,r))},r=>{s.push(this.deleteIndexEntry(e,t,n,r))}),dx.waitFor(s)}getNextSequenceNumber(e){let t=1;return bR(e).iterate({index:hP,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>bo(e,t)).filter((e,t,n)=>!t||0!==bo(e,n[t-1]));let r=[];for(let i of(r.push(e),n)){let n=bo(i,e),s=bo(i,t);if(0===n)r[0]=e.successor();else if(n>0&&s<0)r.push(i),r.push(i.successor());else if(s>0)break}r.push(t);let i=[];for(let e=0;e<r.length;e+=2){if(this.isRangeMatchable(r[e],r[e+1]))return[];let t=[r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,bx,[]],n=[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,bx,[]];i.push(IDBKeyRange.bound(t,n))}return i}isRangeMatchable(e,t){return bo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(bN)}getMinOffset(e,t){return dx.mapArray(this.getSubTargets(t),t=>this.getFieldIndex(e,t).next(e=>e||cV())).next(bN)}}function bI(e){return h3(e,hS)}function bk(e){return h3(e,hB)}function bD(e){return h3(e,hD)}function bR(e){return h3(e,hO)}function bN(e){cU(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){let i=e[r].indexState.offset;0>dS(i,t)&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new dw(t.readTime,t.documentKey,n)}function bA(e,t,n){let r=e.store(d3),i=e.store(hn),s=[],a=IDBKeyRange.only(n.batchId),o=0,l=r.iterate({range:a},(e,t,n)=>(o++,n.delete()));s.push(l.next(()=>{cU(1===o)}));let u=[];for(let e of n.mutations){let r=he(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return dx.waitFor(s).next(()=>u)}function bO(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else if(e.noDocument)t=e.noDocument;else throw cV();return JSON.stringify(t).length}class bM{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}static forUser(e,t,n,r){return cU(""!==e.uid),new bM(e.isAuthenticated()?e.uid:"",t,n,r)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bB(e).iterate({index:d5,range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){let i=bF(e),s=bB(e);return s.add({}).next(a=>{cU("number"==typeof a);let o=new gI(a,t,n,r),l=vh(this.serializer,this.userId,o),u=[],c=new fn((e,t)=>c4(e.canonicalString(),t.canonicalString()));for(let e of r){let t=he(this.userId,e.key.path,a);c=c.add(e.key.path.popLast()),u.push(s.put(l)),u.push(i.put(t,ht))}return c.forEach(t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.documentKeysByBatchId[a]=o.keys()}),dx.waitFor(u).next(()=>o)})}lookupMutationBatch(e,t){return bB(e).get(t).next(e=>e?(cU(e.userId===this.userId),vf(this.serializer,e)):null)}lookupMutationKeys(e,t){return this.documentKeysByBatchId[t]?dx.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(e=>{if(!e)return null;{let n=e.keys();return this.documentKeysByBatchId[t]=n,n}})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]),i=null;return bB(e).iterate({index:d5,range:r},(e,t,r)=>{t.userId===this.userId&&(cU(t.batchId>=n),i=vf(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=fk;return bB(e).iterate({index:d5,range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,fk],[this.userId,Number.POSITIVE_INFINITY]);return bB(e).loadAll(d5,t).next(e=>e.map(e=>vf(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=d8(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return bF(e).iterate({range:r},(n,r,s)=>{let[a,o,l]=n,u=dX(o);if(a!==this.userId||!t.path.isEqual(u)){s.done();return}return bB(e).get(l).next(e=>{if(!e)throw cV();cU(e.userId===this.userId),i.push(vf(this.serializer,e))})}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new fn(c4),r=[];return t.forEach(t=>{let i=d8(this.userId,t.path),s=IDBKeyRange.lowerBound(i),a=bF(e).iterate({range:s},(e,r,i)=>{let[s,a,o]=e,l=dX(a);if(s!==this.userId||!t.path.isEqual(l)){i.done();return}n=n.add(o)});r.push(a)}),dx.waitFor(r).next(()=>this.lookupMutationBatches(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=d8(this.userId,n),s=IDBKeyRange.lowerBound(i),a=new fn(c4);return bF(e).iterate({range:s},(e,t,i)=>{let[s,o,l]=e,u=dX(o);if(s!==this.userId||!n.isPrefixOf(u)){i.done();return}u.length===r&&(a=a.add(l))}).next(()=>this.lookupMutationBatches(e,a))}lookupMutationBatches(e,t){let n=[],r=[];return t.forEach(t=>{r.push(bB(e).get(t).next(e=>{if(null===e)throw cV();cU(e.userId===this.userId),n.push(vf(this.serializer,e))}))}),dx.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return bA(e.simpleDbTransaction,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.removeCachedMutationKeys(t.batchId)}),dx.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}removeCachedMutationKeys(e){delete this.documentKeysByBatchId[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return dx.resolve();let n=IDBKeyRange.lowerBound(d7(this.userId)),r=[];return bF(e).iterate({range:n},(e,t,n)=>{if(e[0]!==this.userId){n.done();return}{let t=dX(e[1]);r.push(t)}}).next(()=>{cU(0===r.length)})})}containsKey(e,t){return bP(e,this.userId,t)}getMutationQueueMetadata(e){return bj(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:fk,lastStreamToken:""})}}function bP(e,t,n){let r=d8(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),a=!1;return bF(e).iterate({range:s,keysOnly:!0},(e,n,r)=>{let[s,o,l]=e;s===t&&o===i&&(a=!0),r.done()}).next(()=>a)}function bL(e,t){let n=!1;return bj(e).iterateSerial(r=>bP(e,r,t).next(e=>(e&&(n=!0),dx.resolve(!e)))).next(()=>n)}function bB(e){return h3(e,d3)}function bF(e){return h3(e,hn)}function bj(e){return h3(e,d2)}let bV=2;class bU{constructor(e){this.lastId=e}next(){return this.lastId+=bV,this.lastId}static forTargetCache(){return new bU(2-bV)}static forSyncEngine(){return new bU(1-bV)}}class bz{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.retrieveMetadata(e).next(t=>{let n=new bU(t.highestTargetId);return t.highestTargetId=n.next(),this.saveMetadata(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.retrieveMetadata(e).next(e=>c8.fromTimestamp(new c7(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.retrieveMetadata(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.retrieveMetadata(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.saveMetadata(e,r)))}addTargetData(e,t){return this.saveTargetData(e,t).next(()=>this.retrieveMetadata(e).next(n=>(n.targetCount+=1,this.updateMetadataFromTargetData(t,n),this.saveMetadata(e,n))))}updateTargetData(e,t){return this.saveTargetData(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>bq(e).delete(t.targetId)).next(()=>this.retrieveMetadata(e)).next(t=>(cU(t.targetCount>0),t.targetCount-=1,this.saveMetadata(e,t)))}removeTargets(e,t,n){let r=0,i=[];return bq(e).iterate((s,a)=>{let o=vp(a);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,i.push(this.removeTargetData(e,o)))}).next(()=>dx.waitFor(i)).next(()=>r)}forEachTarget(e,t){return bq(e).iterate((e,n)=>{t(vp(n))})}retrieveMetadata(e){return bW(e).get(hb).next(e=>(cU(null!==e),e))}saveMetadata(e,t){return bW(e).put(hb,t)}saveTargetData(e,t){return bq(e).put(vm(this.serializer,t))}updateMetadataFromTargetData(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.retrieveMetadata(e).next(e=>e.targetCount)}getTargetData(e,t){let n=p2(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return bq(e).iterate({range:r,index:hf},(e,n,r)=>{let s=vp(n);p3(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){let r=[],i=b$(e);return t.forEach(t=>{let s=dQ(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),dx.waitFor(r)}removeMatchingKeys(e,t,n){let r=b$(e);return dx.forEach(t,t=>{let i=dQ(t.path);return dx.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){let n=b$(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),r=b$(e),i=mH();return r.iterate({range:n,keysOnly:!0},(e,t,n)=>{let r=new ds(dX(e[1]));i=i.add(r)}).next(()=>i)}containsKey(e,t){let n=dQ(t.path),r=IDBKeyRange.bound([n],[c6(n)],!1,!0),i=0;return b$(e).iterate({index:hy,keysOnly:!0,range:r},([e,t],n,r)=>{0!==e&&(i++,r.done())}).next(()=>i>0)}getTargetDataForTarget(e,t){return bq(e).get(t).next(e=>e?vp(e):null)}}function bq(e){return h3(e,hd)}function bW(e){return h3(e,hw)}function b$(e){return h3(e,hm)}let bH={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bG=-1,bK=41943040;class bQ{static withCacheSize(e){return new bQ(e,bQ.DEFAULT_COLLECTION_PERCENTILE,bQ.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}bQ.DEFAULT_COLLECTION_PERCENTILE=10,bQ.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bQ.DEFAULT=new bQ(bK,bQ.DEFAULT_COLLECTION_PERCENTILE,bQ.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bQ.DISABLED=new bQ(bG,0,0);let bY="LruGarbageCollector",bJ=1048576,bX=6e4,bZ=3e5;function b0([e,t],[n,r]){let i=c4(e,n);return 0===i?c4(t,r):i}class b1{constructor(e){this.maxElements=e,this.buffer=new fn(b0),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>b0(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class b2{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==bG&&this.scheduleGC(bX)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(e){cL(bY,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){dO(e)?cL(bY,"Ignoring IndexedDB error during garbage collection: ",e):await dE(e)}await this.scheduleGC(bZ)})}}class b4{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return dx.resolve(dW.INVALID);let n=new b1(t);return this.delegate.forEachTarget(e,e=>n.addElement(e.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,e=>n.addElement(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.delegate.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===bG?(cL("LruGarbageCollector","Garbage collection skipped; disabled"),dx.resolve(bH)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(cL("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bH):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let n,r,i,s,a,o,l;let c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(cL("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),cP()<=u.DEBUG&&cL("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-c}ms
	Determined least recently used ${r} in ${a-s}ms
	Removed ${i} targets in ${o-a}ms
	Removed ${e} documents in ${l-o}ms
Total Duration: ${l-c}ms`),dx.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function b3(e,t){return new b4(e,t)}class b6{constructor(e,t){this.db=e,this.garbageCollector=b3(this,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}forEachOrphanedDocumentSequenceNumber(e,t){return this.forEachOrphanedDocument(e,(e,n)=>t(n))}addReference(e,t,n){return b7(e,n)}removeReference(e,t,n){return b7(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return b7(e,t)}isPinned(e,t){return bL(e,t)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],i=0;return this.forEachOrphanedDocument(e,(s,a)=>{if(a<=t){let t=this.isPinned(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,c8.min()),b$(e).delete(b5(s))))});r.push(t)}}).next(()=>dx.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return b7(e,t)}forEachOrphanedDocument(e,t){let n;let r=b$(e),i=dW.INVALID;return r.iterate({index:hy},([e,r],{path:s,sequenceNumber:a})=>{0===e?(i!==dW.INVALID&&t(new ds(dX(n)),i),i=a,n=s):i=dW.INVALID}).next(()=>{i!==dW.INVALID&&t(new ds(dX(n)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function b5(e){return[0,dQ(e.path)]}function b9(e,t){return{targetId:0,path:dQ(e.path),sequenceNumber:t}}function b7(e,t){return b$(e).put(b9(t,e.currentSequenceNumber))}class b8{constructor(){this.changes=new mO(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pw.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return void 0!==n?dx.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class we{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return wi(e).put(n)}removeEntry(e,t,n){return wi(e).delete(wa(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.setMetadata(e,n)))}getEntry(e,t){let n=pw.newInvalidDocument(t);return wi(e).iterate({index:hs,range:IDBKeyRange.only(ws(t))},(e,r)=>{n=this.maybeDecodeDocument(t,r)}).next(()=>n)}getSizedEntry(e,t){let n={size:0,document:pw.newInvalidDocument(t)};return wi(e).iterate({index:hs,range:IDBKeyRange.only(ws(t))},(e,r)=>{n={document:this.maybeDecodeDocument(t,r),size:bO(r)}}).next(()=>n)}getEntries(e,t){let n=mP();return this.forEachDbEntry(e,t,(e,t)=>{let r=this.maybeDecodeDocument(e,t);n=n.insert(e,r)}).next(()=>n)}getSizedEntries(e,t){let n=mP(),r=new h7(ds.comparator);return this.forEachDbEntry(e,t,(e,t)=>{let i=this.maybeDecodeDocument(e,t);n=n.insert(e,i),r=r.insert(e,bO(t))}).next(()=>({documents:n,sizeMap:r}))}forEachDbEntry(e,t,n){if(t.isEmpty())return dx.resolve();let r=new fn(wl);t.forEach(e=>r=r.add(e));let i=IDBKeyRange.bound(ws(r.first()),ws(r.last())),s=r.getIterator(),a=s.getNext();return wi(e).iterate({index:hs,range:i},(e,t,r)=>{let i=ds.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&0>wl(a,i);)n(a,null),a=s.getNext();a&&a.isEqual(i)&&(n(a,t),a=s.hasNext()?s.getNext():null),a?r.skip(ws(a)):r.done()}).next(()=>{for(;a;)n(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,i){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),vl(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wi(e).loadAll(IDBKeyRange.bound(a,o,!0)).next(e=>{null==i||i.incrementDocumentReadCount(e.length);let n=mP();for(let i of e){let e=this.maybeDecodeDocument(ds.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(mx(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=mP(),s=wo(t,n),a=wo(t,dw.max());return wi(e).iterate({index:ho,range:IDBKeyRange.bound(s,a,!0)},(e,t,n)=>{let s=this.maybeDecodeDocument(ds.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new wn(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return wr(e).get(hc).next(e=>(cU(!!e),e))}setMetadata(e,t){return wr(e).put(hc,t)}maybeDecodeDocument(e,t){if(t){let e=va(this.serializer,t);if(!(e.isNoDocument()&&e.version.isEqual(c8.min())))return e}return pw.newInvalidDocument(e)}}function wt(e){return new we(e)}class wn extends b8{constructor(e,t){super(),this.documentCache=e,this.trackRemovals=t,this.documentStates=new mO(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],n=0,r=new fn((e,t)=>c4(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let a=this.documentStates.get(i);if(t.push(this.documentCache.removeEntry(e,i,a.readTime)),s.isValidDocument()){let o=vo(this.documentCache.serializer,s);r=r.add(i.path.popLast());let l=bO(o);n+=l-a.size,t.push(this.documentCache.addEntry(e,i,o))}else if(n-=a.size,this.trackRemovals){let n=vo(this.documentCache.serializer,s.convertToNoDocument(c8.min()));t.push(this.documentCache.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.documentCache.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.documentCache.updateMetadata(e,n)),dx.waitFor(t)}getFromCache(e,t){return this.documentCache.getSizedEntry(e,t).next(e=>(this.documentStates.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.documentCache.getSizedEntries(e,t).next(({documents:e,sizeMap:t})=>(t.forEach((t,n)=>{this.documentStates.set(t,{size:n,readTime:e.get(t).readTime})}),e))}}function wr(e){return h3(e,hu)}function wi(e){return h3(e,hr)}function ws(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function wa(e,t){let n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],vl(t),n[n.length-1]]}function wo(e,t){let n=t.documentKey.path.toArray();return[e,vl(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function wl(e,t){let n=e.path.toArray(),r=t.path.toArray(),i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=c4(n[e],r[e]))return i;return(i=c4(n.length,r.length))||(i=c4(n[n.length-2],r[r.length-2]))?i:c4(n[n.length-1],r[r.length-1])}let wu=17;class wc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class wd{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&gd(n.mutation,e,fa.empty(),c7.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,mH()).next(()=>t))}getLocalViewOfDocuments(e,t,n=mH()){let r=mV();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=mB();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let n=mV();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,mH()))}populateOverlays(e,t,n){let r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=mP(),s=mz(),a=mF();return t.forEach((e,t)=>{let a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof gy)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),gd(a.mutation,t,a.mutation.getFieldMask(),c7.now())):s.set(t.key,fa.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new wc(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){let n=mz(),r=new h7((e,t)=>e-t),i=mH();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=n.get(e)||fa.empty();a=i.applyToLocalView(s,a),n.set(e,a);let o=(r.get(i.batchId)||mH()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{let s=[],a=r.getReverseIterator();for(;a.hasNext();){let r=a.getNext(),o=r.key,l=r.value,u=mU();l.forEach(e=>{if(!i.has(e)){let r=gu(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,u))}return dx.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return md(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{let s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):dx.resolve(mV()),a=da,o=i;return s.next(t=>dx.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t))?dx.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)})).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,mH())).next(e=>({batchId:a,changes:mj(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ds(t)).next(e=>{let t=mB();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let i=t.collectionGroup,s=mB();return this.indexManager.getCollectionParents(e,i).next(a=>dx.forEach(a,a=>{let o=ml(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{let r=n.getKey();null===e.get(r)&&(e=e.insert(r,pw.newInvalidDocument(r)))});let n=mB();return e.forEach((e,r)=>{let s=i.get(e);void 0!==s&&gd(s.mutation,r,fa.empty(),c7.now()),mx(t,r)&&(n=n.insert(e,r))}),n})}}class wh{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return dx.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,vC(t)),dx.resolve()}getNamedQuery(e,t){return dx.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,vT(t)),dx.resolve()}}class wf{constructor(){this.overlays=new h7(ds.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return dx.resolve(this.overlays.get(t))}getOverlays(e,t){let n=mV();return dx.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.saveOverlay(e,t,r)}),dx.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.overlayByBatchId.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.overlayByBatchId.delete(n)),dx.resolve()}getOverlaysForCollection(e,t,n){let r=mV(),i=t.length+1,s=new ds(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return dx.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new h7((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=mV(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=mV(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return dx.resolve(a)}saveOverlay(e,t,n){let r=this.overlays.get(n.key);if(null!==r){let e=this.overlayByBatchId.get(r.largestBatchId).delete(n.key);this.overlayByBatchId.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new gD(t,n));let i=this.overlayByBatchId.get(t);void 0===i&&(i=mH(),this.overlayByBatchId.set(t,i)),this.overlayByBatchId.set(t,i.add(n.key))}}class wp{constructor(){this.sessionToken=fu.EMPTY_BYTE_STRING}getSessionToken(e){return dx.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,dx.resolve()}}class wm{constructor(){this.refsByKey=new fn(wg.compareByKey),this.refsByTarget=new fn(wg.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let n=new wg(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)}addReferences(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.removeRef(new wg(e,t))}removeReferences(e,t){e.forEach(e=>this.removeReference(e,t))}removeReferencesForId(e){let t=new ds(new dn([])),n=new wg(t,e),r=new wg(t,e+1),i=[];return this.refsByTarget.forEachInRange([n,r],e=>{this.removeRef(e),i.push(e.key)}),i}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new ds(new dn([])),n=new wg(t,e),r=new wg(t,e+1),i=mH();return this.refsByTarget.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new wg(e,0),n=this.refsByKey.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class wg{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return ds.comparator(e.key,t.key)||c4(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return c4(e.targetOrBatchId,t.targetOrBatchId)||ds.comparator(e.key,t.key)}}class wy{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new fn(wg.compareByKey)}checkEmpty(e){return dx.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){let i=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new gI(i,t,n,r);for(let t of(this.mutationQueue.push(s),r))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new wg(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return dx.resolve(s)}lookupMutationBatch(e,t){return dx.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.indexOfBatchId(n),i=r<0?0:r;return dx.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return dx.resolve(0===this.mutationQueue.length?fk:this.nextBatchId-1)}getAllMutationBatches(e){return dx.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new wg(t,0),r=new wg(t,Number.POSITIVE_INFINITY),i=[];return this.batchesByDocumentKey.forEachInRange([n,r],e=>{let t=this.findMutationBatch(e.targetOrBatchId);i.push(t)}),dx.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new fn(c4);return t.forEach(e=>{let t=new wg(e,0),r=new wg(e,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([t,r],e=>{n=n.add(e.targetOrBatchId)})}),dx.resolve(this.findMutationBatches(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=n;ds.isDocumentKey(i)||(i=i.child(""));let s=new wg(new ds(i),0),a=new fn(c4);return this.batchesByDocumentKey.forEachWhile(e=>{let t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.targetOrBatchId)),!0)},s),dx.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(e=>{let n=this.findMutationBatch(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){cU(0===this.indexOfExistingBatchId(t.batchId,"removed")),this.mutationQueue.shift();let n=this.batchesByDocumentKey;return dx.forEach(t.mutations,r=>{let i=new wg(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.batchesByDocumentKey=n})}removeCachedMutationKeys(e){}containsKey(e,t){let n=new wg(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return dx.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,dx.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}let wv="-9223372036854775808";function wb(){return new h7(ds.comparator)}class ww{constructor(e){this.sizer=e,this.docs=wb(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.sizer(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return dx.resolve(n?n.document.mutableCopy():pw.newInvalidDocument(t))}getEntries(e,t){let n=mP();return t.forEach(e=>{let t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():pw.newInvalidDocument(e))}),dx.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=mP(),s=t.path,a=new ds(s.child("__id"+wv+"__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;!(e.path.length>s.length+1||0>=dS(db(a),n))&&(r.has(a.key)||mx(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return dx.resolve(i)}getAllFromCollectionGroup(e,t,n,r){cV()}forEachDocumentKey(e,t){return dx.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new wT(this)}getSize(e){return dx.resolve(this.size)}}function wS(e){return new ww(e)}class wT extends b8{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.documentCache.addEntry(e,r)):this.documentCache.removeEntry(n)}),dx.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}}class wC{constructor(e){this.persistence=e,this.targets=new mO(e=>p2(e),p3),this.lastRemoteSnapshotVersion=c8.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new wm,this.targetCount=0,this.targetIdGenerator=bU.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((e,n)=>t(n)),dx.resolve()}getLastRemoteSnapshotVersion(e){return dx.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return dx.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),dx.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),dx.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new bU(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,dx.resolve()}updateTargetData(e,t){return this.saveTargetData(t),dx.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,dx.resolve()}removeTargets(e,t,n){let r=0,i=[];return this.targets.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.targets.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),dx.waitFor(i).next(()=>r)}getTargetCount(e){return dx.resolve(this.targetCount)}getTargetData(e,t){let n=this.targets.get(t)||null;return dx.resolve(n)}addMatchingKeys(e,t,n){return this.references.addReferences(t,n),dx.resolve()}removeMatchingKeys(e,t,n){this.references.removeReferences(t,n);let r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),dx.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),dx.resolve()}getMatchingKeysForTargetId(e,t){let n=this.references.referencesForId(t);return dx.resolve(n)}containsKey(e,t){return dx.resolve(this.references.containsKey(t))}}let wE="MemoryPersistence";class wx{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new dW(0),this._started=!1,this._started=!0,this.globalsCache=new wp,this.referenceDelegate=e(this),this.targetCache=new wC(this);let n=e=>this.referenceDelegate.documentSize(e);this.indexManager=new bT,this.remoteDocumentCache=wS(n),this.serializer=new vs(t),this.bundleCache=new wh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wf,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.mutationQueues[e.toKey()];return n||(n=new wy(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=n),n}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,n){cL(wE,"Starting transaction:",e);let r=new w_(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(r).next(e=>this.referenceDelegate.onTransactionCommitted(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}mutationQueuesContainKey(e,t){return dx.or(Object.values(this.mutationQueues).map(n=>()=>n.containsKey(e,t)))}}class w_ extends dC{constructor(e){super(),this.currentSequenceNumber=e}}class wI{constructor(e){this.persistence=e,this.localViewReferences=new wm,this._orphanedDocuments=null}static factory(e){return new wI(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw cV()}addReference(e,t,n){return this.localViewReferences.addReference(n,t),this.orphanedDocuments.delete(n.toString()),dx.resolve()}removeReference(e,t,n){return this.localViewReferences.removeReference(n,t),this.orphanedDocuments.add(n.toString()),dx.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),dx.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(e=>this.orphanedDocuments.add(e.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.orphanedDocuments.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return dx.forEach(this.orphanedDocuments,n=>{let r=ds.fromPath(n);return this.isReferenced(e,r).next(e=>{e||t.removeEntry(r,c8.min())})}).next(()=>(this._orphanedDocuments=null,t.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(e=>{e?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return dx.or([()=>dx.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}}class wk{constructor(e,t){this.persistence=e,this.orphanedSequenceNumbers=new mO(e=>dQ(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=b3(this,t)}static factory(e,t){return new wk(e,t)}onTransactionStarted(){}onTransactionCommitted(e){return dx.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,e=>{t++}).next(()=>t)}forEachOrphanedDocumentSequenceNumber(e,t){return dx.forEach(this.orphanedSequenceNumbers,(n,r)=>this.isPinned(e,n,r).next(e=>e?dx.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0,r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.forEachDocumentKey(e,r=>this.isPinned(e,r,t).next(e=>{e||(n++,i.removeEntry(r,c8.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),dx.resolve()}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.orphanedSequenceNumbers.set(n,e.currentSequenceNumber),dx.resolve()}removeReference(e,t,n){return this.orphanedSequenceNumbers.set(n,e.currentSequenceNumber),dx.resolve()}updateLimboDocument(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),dx.resolve()}documentSize(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=f8(e.data.value)),t}isPinned(e,t,n){return dx.or([()=>this.persistence.mutationQueuesContainKey(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.orphanedSequenceNumbers.get(t);return dx.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class wD{constructor(e){this.serializer=e}createOrUpgrade(e,t,n,r){let i=new dk("createOrUpgrade",t);n<1&&r>=1&&(wN(e),wA(e),wB(e),wM(e));let s=dx.resolve();return n<3&&r>=3&&(0!==n&&(wF(e),wB(e)),s=s.next(()=>wV(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>wO(e,i))),s=s.next(()=>{wU(e)})),n<5&&r>=5&&(s=s.next(()=>this.removeAcknowledgedMutations(i))),n<6&&r>=6&&(s=s.next(()=>(wL(e),this.addDocumentGlobal(i)))),n<7&&r>=7&&(s=s.next(()=>this.ensureSequenceNumbers(i))),n<8&&r>=8&&(s=s.next(()=>this.createCollectionParentIndex(e,i))),n<9&&r>=9&&(s=s.next(()=>{wj(e)})),n<10&&r>=10&&(s=s.next(()=>this.rewriteCanonicalIds(i))),n<11&&r>=11&&(s=s.next(()=>{wz(e),wq(e)})),n<12&&r>=12&&(s=s.next(()=>{w$(e)})),n<13&&r>=13&&(s=s.next(()=>wP(e)).next(()=>this.rewriteRemoteDocumentCache(e,i)).next(()=>e.deleteObjectStore(dZ))),n<14&&r>=14&&(s=s.next(()=>this.runOverlayMigration(e,i))),n<15&&r>=15&&(s=s.next(()=>wW(e))),n<16&&r>=16&&(s=s.next(()=>{t.objectStore(hO).clear()}).next(()=>{t.objectStore(hB).clear()})),n<17&&r>=17&&(s=s.next(()=>{wH(e)})),s}addDocumentGlobal(e){let t=0;return e.store(dZ).iterate((e,n)=>{t+=bO(n)}).next(()=>{let n={byteSize:t};return e.store(hu).put(hc,n)})}removeAcknowledgedMutations(e){let t=e.store(d2),n=e.store(d3);return t.loadAll().next(t=>dx.forEach(t,t=>{let r=IDBKeyRange.bound([t.userId,fk],[t.userId,t.lastAcknowledgedBatchId]);return n.loadAll(d5,r).next(n=>dx.forEach(n,n=>{cU(n.userId===t.userId);let r=vf(this.serializer,n);return bA(e,t.userId,r).next(()=>{})}))}))}ensureSequenceNumbers(e){let t=e.store(hm),n=e.store(dZ);return e.store(hw).get(hb).next(e=>{let r=n=>t.put({targetId:0,path:dQ(n),sequenceNumber:e.highestListenSequenceNumber}),i=[];return n.iterate((e,n)=>{let s=new dn(e),a=wR(s);i.push(t.get(a).next(e=>e?dx.resolve():r(s)))}).next(()=>dx.waitFor(i))})}createCollectionParentIndex(e,t){e.createObjectStore(hS,{keyPath:hT});let n=t.store(hS),r=new bC,i=e=>{if(r.add(e)){let t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:dQ(r)})}};return t.store(dZ).iterate({keysOnly:!0},(e,t)=>i(new dn(e).popLast())).next(()=>t.store(hn).iterate({keysOnly:!0},([e,t,n],r)=>i(dX(t).popLast())))}rewriteCanonicalIds(e){let t=e.store(hd);return t.iterate((e,n)=>{let r=vp(n),i=vm(this.serializer,r);return t.put(i)})}rewriteRemoteDocumentCache(e,t){let n=t.store(dZ),r=[];return n.iterate((e,n)=>{let i=t.store(hr),s=wG(n).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(a))}).next(()=>dx.waitFor(r))}runOverlayMigration(e,t){let n=t.store(d3),r=wt(this.serializer),i=new wx(wI.factory,this.serializer.remoteSerializer);return n.loadAll().next(e=>{let n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:mH();vf(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),dx.forEach(n,(e,n)=>{let s=new cR(n),a=vO.forUser(this.serializer,s),o=i.getIndexManager(s);return new wd(r,bM.forUser(s,this.serializer,o,i.referenceDelegate),a,o).recalculateAndSaveOverlaysForDocumentKeys(new h4(t,dW.INVALID),e).next()})})}}function wR(e){return[0,dQ(e)]}function wN(e){e.createObjectStore(d0)}function wA(e){e.createObjectStore(d2,{keyPath:d4}),e.createObjectStore(d3,{keyPath:d6,autoIncrement:!0}).createIndex(d5,d9,{unique:!0}),e.createObjectStore(hn)}function wO(e,t){return t.store(d3).loadAll().next(n=>{e.deleteObjectStore(d3),e.createObjectStore(d3,{keyPath:d6,autoIncrement:!0}).createIndex(d5,d9,{unique:!0});let r=t.store(d3),i=n.map(e=>r.put(e));return dx.waitFor(i)})}function wM(e){e.createObjectStore(dZ)}function wP(e){let t=e.createObjectStore(hr,{keyPath:hi});t.createIndex(hs,ha),t.createIndex(ho,hl)}function wL(e){e.createObjectStore(hu)}function wB(e){e.createObjectStore(hm,{keyPath:hg}).createIndex(hy,hv,{unique:!0}),e.createObjectStore(hd,{keyPath:hh}).createIndex(hf,hp,{unique:!0}),e.createObjectStore(hw)}function wF(e){e.deleteObjectStore(hm),e.deleteObjectStore(hd),e.deleteObjectStore(hw)}function wj(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}function wV(e){let t=e.store(hw),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:c8.min().toTimestamp(),targetCount:0};return t.put(hb,n)}function wU(e){e.createObjectStore(hC,{keyPath:hE})}function wz(e){e.createObjectStore(hx,{keyPath:h_})}function wq(e){e.createObjectStore(hI,{keyPath:hk})}function wW(e){e.createObjectStore(hD,{keyPath:hR,autoIncrement:!0}).createIndex(hN,hA,{unique:!1}),e.createObjectStore(hO,{keyPath:hM}).createIndex(hP,hL,{unique:!1}),e.createObjectStore(hB,{keyPath:hF}).createIndex(hj,hV,{unique:!1})}function w$(e){let t=e.createObjectStore(hU,{keyPath:hz});t.createIndex(hq,hW,{unique:!1}),t.createIndex(h$,hH,{unique:!1})}function wH(e){e.createObjectStore(hG,{keyPath:hK})}function wG(e){return e.document?new ds(dn.fromString(e.document.name).popFirst(5)):e.noDocument?ds.fromSegments(e.noDocument.path):e.unknownDocument?ds.fromSegments(e.unknownDocument.path):cV()}let wK="IndexedDbPersistence",wQ=18e5,wY=5e3,wJ=4e3,wX="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",wZ="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",w0="firestore_zombie",w1="main";class w2{constructor(e,t,n,r,i,s,a,o,l,u,c=wu){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.queue=i,this.window=s,this.document=a,this.sequenceNumberSyncer=l,this.forceOwningTab=u,this.schemaVersion=c,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=e=>Promise.resolve(),!w2.isAvailable())throw new cW(cq.UNIMPLEMENTED,wZ);this.referenceDelegate=new b6(this,r),this.dbName=t+w1,this.serializer=new vs(o),this.simpleDb=new dD(this.dbName,this.schemaVersion,new wD(this.serializer)),this.globalsCache=new vP,this.targetCache=new bz(this.referenceDelegate,this.serializer),this.remoteDocumentCache=wt(this.serializer),this.bundleCache=new vR,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===u&&cB(wK,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new cW(cq.FAILED_PRECONDITION,wX);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.targetCache.getHighestSequenceNumber(e))}).then(e=>{this.listenSequence=new dW(e,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(e=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(e)))}setPrimaryStateListener(e){return this.primaryStateListener=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.simpleDb.setVersionChangeListener(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>w3(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(e).next(e=>{e||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(e)).next(t=>this.isPrimary&&!t?this.releasePrimaryLeaseIfHeld(e).next(()=>!1):!!t&&this.acquireOrExtendPrimaryLease(e).next(()=>!0))).catch(e=>{if(dO(e))return cL(wK,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return cL(wK,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.queue.enqueueRetryable(()=>this.primaryStateListener(e)),this.isPrimary=e})}verifyPrimaryLease(e){return w4(e).get(d1).next(e=>dx.resolve(this.isLocalClient(e)))}removeClientMetadata(e){return w3(e).delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,wQ)){this.lastGarbageCollectionTime=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=h3(e,hC);return t.loadAll().next(e=>{let n=this.filterActiveClients(e,wQ),r=e.filter(e=>-1===n.indexOf(e));return dx.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.webStorage)for(let t of e)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(t.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",wJ,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(e){return!!e&&e.ownerId===this.clientId}canActAsPrimary(e){return this.forceOwningTab?dx.resolve(!0):w4(e).get(d1).next(t=>{if(null!==t&&this.isWithinAge(t.leaseTimestampMs,wY)&&!this.isClientZombied(t.ownerId)){if(this.isLocalClient(t)&&this.networkEnabled)return!0;if(!this.isLocalClient(t)){if(!t.allowTabSynchronization)throw new cW(cq.FAILED_PRECONDITION,wX);return!1}}return!!this.networkEnabled&&!!this.inForeground||w3(e).loadAll().next(e=>void 0===this.filterActiveClients(e,wY).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&cL(wK,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[d0,hC],e=>{let t=new h4(e,dW.INVALID);return this.releasePrimaryLeaseIfHeld(t).next(()=>this.removeClientMetadata(t))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(e,t){return e.filter(e=>this.isWithinAge(e.updateTimeMs,t)&&!this.isClientZombied(e.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",e=>w3(e).loadAll().next(e=>this.filterActiveClients(e,wQ).map(e=>e.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(e,t){return bM.forUser(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new b_(e,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(e){return vO.forUser(this.serializer,e)}getBundleCache(){return this.bundleCache}runTransaction(e,t,n){let r;cL(wK,"Starting transaction:",e);let i="readonly"===t?"readonly":"readwrite",s=h2(this.schemaVersion);return this.simpleDb.runTransaction(e,i,s,i=>(r=new h4(i,this.listenSequence?this.listenSequence.next():dW.INVALID),"readwrite-primary"===t)?this.verifyPrimaryLease(r).next(e=>!!e||this.canActAsPrimary(r)).next(t=>{if(!t)throw cB(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new cW(cq.FAILED_PRECONDITION,dT);return n(r)}).next(e=>this.acquireOrExtendPrimaryLease(r).next(()=>e)):this.verifyAllowTabSynchronization(r).next(()=>n(r))).then(e=>(r.raiseOnCommittedEvent(),e))}verifyAllowTabSynchronization(e){return w4(e).get(d1).next(e=>{if(null!==e&&this.isWithinAge(e.leaseTimestampMs,wY)&&!this.isClientZombied(e.ownerId)&&!this.isLocalClient(e)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!e.allowTabSynchronization))throw new cW(cq.FAILED_PRECONDITION,wX)})}acquireOrExtendPrimaryLease(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return w4(e).put(d1,t)}static isAvailable(){return dD.isAvailable()}releasePrimaryLeaseIfHeld(e){let t=w4(e);return t.get(d1).next(e=>this.isLocalClient(e)?(cL(wK,"Releasing primary lease."),t.delete(d1)):dx.resolve())}isWithinAge(e,t){let n=Date.now(),r=n-t,i=n;return!(e<r)&&(!(e>i)||(cB(`Detected an update time that is in the future: ${e} > ${i}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.windowUnloadHandler=()=>{this.markClientZombied();let e=/(?:Version|Mobile)\/1[456]/;uo()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(e){var t;try{let n=(null===(t=this.webStorage)||void 0===t?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)))!==null;return cL(wK,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return cB(wK,"Failed to get zombied client id.",e),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){cB("Failed to set zombie client id.",e)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}}zombiedClientLocalStorageKey(e){return`${w0}_${this.persistenceKey}_${e}`}}function w4(e){return h3(e,d0)}function w3(e){return h3(e,hC)}function w6(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}function w5(e,t,n,r,i){t=[...t],(e=[...e]).sort(n),t.sort(n);let s=e.length,a=t.length,o=0,l=0;for(;o<a&&l<s;){let s=n(e[l],t[o]);s<0?i(e[l++]):s>0?r(t[o++]):(o++,l++)}for(;o<a;)r(t[o++]);for(;l<s;)i(e[l++])}function w9(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}let w7="LocalStore",w8=3e8;class Se{constructor(e,t,n,r){this.persistence=e,this.queryEngine=t,this.serializer=r,this.targetDataByTarget=new h7(c4),this.targetIdByTarget=new mO(e=>p2(e),p3),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(n)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wd(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}}function St(e,t,n,r){return new Se(e,t,n,r)}async function Sn(e,t){let n=cz(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.initializeUserComponents(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{let i=[],s=[],a=mH();for(let e of r)for(let t of(i.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return n.localDocuments.getDocuments(e,a).next(e=>({affectedDocuments:e,removedBatchIds:i,addedBatchIds:s}))})})}function Sr(e,t){let n,r;let i=cz(e),s=c7.now(),a=t.reduce((e,t)=>e.add(t.key),mH());return i.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=mP(),l=mH();return i.remoteDocuments.getEntries(e,a).next(e=>{(o=e).forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>i.localDocuments.getOverlayedDocuments(e,o)).next(r=>{n=r;let a=[];for(let e of t){let t=gh(e,n.get(e.key).overlayedDocument);null!=t&&a.push(new gy(e.key,t,pb(t.value.mapValue),ga.exists(!0)))}return i.mutationQueue.addMutationBatch(e,s,a,t)}).next(t=>{r=t;let s=t.applyToLocalDocumentSet(n,l);return i.documentOverlayCache.saveOverlays(e,t.batchId,s)})}).then(()=>({batchId:r.batchId,changes:mj(n)}))}function Si(e,t){let n=cz(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let r=t.batch.keys(),i=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});return Sb(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,Ss(t))).next(()=>n.localDocuments.getDocuments(e,r))})}function Ss(e){let t=mH();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}function Sa(e,t){let n=cz(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(cU(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}function So(e){let t=cz(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}function Sl(e){let t=cz(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.targetCache.getLastRemoteSnapshotVersion(e))}function Su(e,t){let n=cz(e),r=t.snapshotVersion,i=n.targetDataByTarget;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{let s=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=n.targetDataByTarget;let a=[];t.targetChanges.forEach((s,o)=>{let l=i.get(o);if(!l)return;a.push(n.targetCache.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.targetCache.addMatchingKeys(e,s.addedDocuments,o)));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?u=u.withResumeToken(fu.EMPTY_BYTE_STRING,c8.min()).withLastLimboFreeSnapshotVersion(c8.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(o,u),Sd(l,u,s)&&a.push(n.targetCache.updateTargetData(e,u))});let o=mP(),l=mH();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(Sc(e,s,t.documentUpdates).next(e=>{o=e.changedDocuments,l=e.existenceChangedKeys})),!r.isEqual(c8.min())){let t=n.targetCache.getLastRemoteSnapshotVersion(e).next(t=>n.targetCache.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return dx.waitFor(a).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.targetDataByTarget=i,e))}function Sc(e,t,n){let r=mH(),i=mH();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=mP();return n.forEach((n,s)=>{let a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(c8.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):cL(w7,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),{changedDocuments:r,existenceChangedKeys:i}})}function Sd(e,t,n){return!!(0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=w8)||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}async function Sh(e,t){let n=cz(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>dx.forEach(t,t=>dx.forEach(t.addedKeys,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>dx.forEach(t.removedKeys,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(dO(e))cL(w7,"Failed to update sequence numbers: "+e);else throw e}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=n.targetDataByTarget.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.targetDataByTarget=n.targetDataByTarget.insert(t,i)}}}function Sf(e,t){let n=cz(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=fk),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Sp(e,t){let n=cz(e);return n.persistence.runTransaction("read document","readonly",e=>n.localDocuments.getDocument(e,t))}function Sm(e,t){let n=cz(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.targetCache.getTargetData(e,t).next(i=>i?(r=i,dx.resolve(r)):n.targetCache.allocateTargetId(e).next(i=>(r=new vi(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.targetCache.addTargetData(e,r).next(()=>r))))}).then(e=>{let r=n.targetDataByTarget.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.targetDataByTarget=n.targetDataByTarget.insert(e.targetId,e),n.targetIdByTarget.set(t,e.targetId)),e})}function Sg(e,t,n){let r=cz(e),i=r.targetIdByTarget.get(n);return void 0!==i?dx.resolve(r.targetDataByTarget.get(i)):r.targetCache.getTargetData(t,n)}async function Sy(e,t,n){let r=cz(e),i=r.targetDataByTarget.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(dO(e))cL(w7,`Failed to update sequence numbers for target ${t}: ${e}`);else throw e}r.targetDataByTarget=r.targetDataByTarget.remove(t),r.targetIdByTarget.delete(i.target)}function Sv(e,t,n){let r=cz(e),i=c8.min(),s=mH();return r.persistence.runTransaction("Execute query","readwrite",e=>Sg(r,e,mp(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.targetCache.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.queryEngine.getDocumentsMatchingQuery(e,t,n?i:c8.min(),n?s:mH())).next(e=>(Sx(r,mR(t),e),{documents:e,remoteKeys:s})))}function Sb(e,t,n,r){let i=n.batch,s=i.keys(),a=dx.resolve();return s.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{let s=n.docVersions.get(e);cU(null!==s),0>t.version.compareTo(s)&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}function Sw(e,t){let n=cz(e),r=cz(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.lookupMutationKeys(e,t).next(t=>t?n.localDocuments.getDocuments(e,t):dx.resolve(null)))}function SS(e,t){cz(cz(e,Se).mutationQueue).removeCachedMutationKeys(t)}function ST(e){return cz(cz(e,Se).persistence).getActiveClients()}function SC(e,t){let n=cz(e),r=cz(n.targetCache),i=n.targetDataByTarget.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",e=>r.getTargetDataForTarget(e,t).next(e=>e?e.target:null))}function SE(e,t){let n=cz(e),r=n.collectionGroupReadTime.get(t)||c8.min();return n.persistence.runTransaction("Get new document changes","readonly",e=>n.remoteDocuments.getAllFromCollectionGroup(e,t,dv(r,da),Number.MAX_SAFE_INTEGER)).then(e=>(Sx(n,t,e),e))}function Sx(e,t,n){let r=e.collectionGroupReadTime.get(t)||c8.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.collectionGroupReadTime.set(t,r)}function S_(e){return mp(mo(dn.fromString(`__bundle__/docs/${e}`)))}async function SI(e,t,n,r){let i=cz(e),s=mH(),a=mP();for(let e of n){let n=t.toDocumentKey(e.metadata.name);e.document&&(s=s.add(n));let r=t.toMutableDocument(e);r.setReadTime(t.toSnapshotVersion(e.metadata.readTime)),a=a.insert(n,r)}let o=i.remoteDocuments.newChangeBuffer({trackRemovals:!0}),l=await Sm(i,S_(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",e=>Sc(e,o,a).next(t=>(o.apply(e),t)).next(t=>i.targetCache.removeMatchingKeysForTargetId(e,l.targetId).next(()=>i.targetCache.addMatchingKeys(e,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(e,t.changedDocuments,t.existenceChangedKeys)).next(()=>t.changedDocuments)))}function Sk(e,t){let n=cz(e),r=yr(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.bundleCache.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(r)>=0)}function SD(e,t){let n=cz(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.bundleCache.saveBundleMetadata(e,t))}async function SR(e,t,n=mH()){let r=await Sm(e,mp(vS(t.bundledQuery))),i=cz(e);return i.persistence.runTransaction("Save named query","readwrite",e=>{let s=yr(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.bundleCache.saveNamedQuery(e,t);let a=r.withResumeToken(fu.EMPTY_BYTE_STRING,s);return i.targetDataByTarget=i.targetDataByTarget.insert(a.targetId,a),i.targetCache.updateTargetData(e,a).next(()=>i.targetCache.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>i.targetCache.addMatchingKeys(e,n,r.targetId)).next(()=>i.bundleCache.saveNamedQuery(e,t))})}function SN(e,t){cz(e).queryEngine.indexAutoCreationEnabled=t}class SA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}let SO=100;function SM(){return uo()?8:dR(us())>0?6:4}class SP{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=SO,this.relativeIndexReadCostPerDocument=SM()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,n,r){let i={result:null};return this.performQueryUsingIndex(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.performQueryUsingRemoteKeys(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;let n=new SA;return this.executeFullCollectionScan(e,t,n).next(r=>{if(i.result=r,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,n,r.size)})}).next(()=>i.result)}createCacheIndexes(e,t,n,r){return n.documentReadCount<this.indexAutoCreationMinCollectionSize?(cP()<=u.DEBUG&&cL("QueryEngine","SDK will not create cache indexes for query:",mE(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),dx.resolve()):(cP()<=u.DEBUG&&cL("QueryEngine","Query:",mE(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.relativeIndexReadCostPerDocument*r)?(cP()<=u.DEBUG&&cL("QueryEngine","The SDK decides to create cache indexes for query:",mE(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,mp(t))):dx.resolve()}performQueryUsingIndex(e,t){if(mu(t))return dx.resolve(null);let n=mp(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(n=mp(t=mb(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{let i=mH(...r);return this.localDocumentsView.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{let s=this.applyQuery(t,r);return this.needsRefill(t,s,i,n.readTime)?this.performQueryUsingIndex(e,mb(t,null,"F")):this.appendRemainingResults(e,s,t,n)}))})))}performQueryUsingRemoteKeys(e,t,n,r){return mu(t)||r.isEqual(c8.min())?dx.resolve(null):this.localDocumentsView.getDocuments(e,n).next(i=>{let s=this.applyQuery(t,i);return this.needsRefill(t,s,n,r)?dx.resolve(null):(cP()<=u.DEBUG&&cL("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),mE(t)),this.appendRemainingResults(e,s,t,dv(r,da)).next(e=>e))})}applyQuery(e,t){let n=new fn(mN(e));return t.forEach((t,r)=>{mx(e,r)&&(n=n.add(r))}),n}needsRefill(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}executeFullCollectionScan(e,t,n){return cP()<=u.DEBUG&&cL("QueryEngine","Using full collection scan to execute query:",mE(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,dw.min(),n)}appendRemainingResults(e,t,n,r){return this.localDocumentsView.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}let SL="firestore_clients";function SB(e,t){return`${SL}_${e}_${t}`}let SF="firestore_mutations";function Sj(e,t,n){let r=`${SF}_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}let SV="firestore_targets";function SU(e,t){return`${SV}_${e}_${t}`}let Sz="firestore_online_state";function Sq(e){return`${Sz}_${e}`}let SW="firestore_bundle_loaded_v2";function S$(e){return`${SW}_${e}`}let SH="firestore_sequence_number";function SG(e){return`${SH}_${e}`}let SK="SharedClientState";class SQ{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static fromWebStorageEntry(e,t,n){let r;let i=JSON.parse(n),s="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return(s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new cW(i.error.code,i.error.message)),s)?new SQ(e,t,i.state,r):(cB(SK,`Failed to parse mutation state for ID '${t}': ${n}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class SY{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static fromWebStorageEntry(e,t){let n;let r=JSON.parse(t),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return(i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new cW(r.error.code,r.error.message)),i)?new SY(e,r.state,n):(cB(SK,`Failed to parse target state for ID '${e}': ${t}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class SJ{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fromWebStorageEntry(e,t){let n=JSON.parse(t),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=mK();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=fN(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new SJ(e,i):(cB(SK,`Failed to parse client data for instance '${e}': ${t}`),null)}}class SX{constructor(e,t){this.clientId=e,this.onlineState=t}static fromWebStorageEntry(e){let t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new SX(t.clientId,t.onlineState):(cB(SK,`Failed to parse online state: ${e}`),null)}}class SZ{constructor(){this.activeTargetIds=mK()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class S0{constructor(e,t,n,r,i){this.window=e,this.queue=t,this.persistenceKey=n,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new h7(c4),this.started=!1,this.earlyEvents=[];let s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.localClientStorageKey=SB(this.persistenceKey,this.localClientId),this.sequenceNumberKey=SG(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new SZ),this.clientStateKeyRe=RegExp(`^${SL}_${s}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${SF}_${s}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${SV}_${s}_(\\d+)$`),this.onlineStateKey=Sq(this.persistenceKey),this.bundleLoadedKey=S$(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(e){return!!(e&&e.localStorage)}async start(){for(let e of(await this.syncEngine.getActiveClients())){if(e===this.localClientId)continue;let t=this.getItem(SB(this.persistenceKey,e));if(t){let n=SJ.fromWebStorageEntry(e,t);n&&(this.activeClients=this.activeClients.insert(n.clientId,n))}}this.persistClientState();let e=this.storage.getItem(this.onlineStateKey);if(e){let t=this.fromWebStorageOnlineState(e);t&&this.handleOnlineStateEvent(t)}for(let e of this.earlyEvents)this.handleWebStorageEvent(e);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(e){let t=!1;return this.activeClients.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.persistMutationState(e,"pending")}updateMutationState(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){let t=this.storage.getItem(SU(this.persistenceKey,e));if(t){let r=SY.fromWebStorageEntry(e,t);r&&(n=r.state)}}return t&&this.localClientState.addQueryTarget(e),this.persistClientState(),n}removeLocalQueryTarget(e){this.localClientState.removeQueryTarget(e),this.persistClientState()}isLocalQueryTarget(e){return this.localClientState.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(SU(this.persistenceKey,e))}updateQueryState(e,t,n){this.persistQueryTargetState(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.removeMutationState(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.persistOnlineState(e)}notifyBundleLoaded(e){this.persistBundleLoadedState(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return cL(SK,"READ",e,t),t}setItem(e,t){cL(SK,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){cL(SK,"REMOVE",e),this.storage.removeItem(e)}handleWebStorageEvent(e){let t=e;if(t.storageArea===this.storage){if(cL(SK,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey){cB("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(async()=>{if(!this.started){this.earlyEvents.push(t);return}if(null!==t.key){if(this.clientStateKeyRe.test(t.key)){if(null!=t.newValue){let e=this.fromWebStorageClientState(t.key,t.newValue);if(e)return this.handleClientStateEvent(e.clientId,e)}else{let e=this.fromWebStorageClientStateKey(t.key);return this.handleClientStateEvent(e,null)}}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue){let e=this.fromWebStorageMutationMetadata(t.key,t.newValue);if(e)return this.handleMutationBatchEvent(e)}}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue){let e=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue);if(e)return this.handleQueryTargetEvent(e)}}else if(t.key===this.onlineStateKey){if(null!==t.newValue){let e=this.fromWebStorageOnlineState(t.newValue);if(e)return this.handleOnlineStateEvent(e)}}else if(t.key===this.sequenceNumberKey){let e=S1(t.newValue);e!==dW.INVALID&&this.sequenceNumberHandler(e)}else if(t.key===this.bundleLoadedKey){let e=this.fromWebStoreBundleLoadedState(t.newValue);await Promise.all(e.map(e=>this.syncEngine.synchronizeWithChangedDocuments(e)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(e,t,n){let r=new SQ(this.currentUser,e,t,n),i=Sj(this.persistenceKey,this.currentUser,e);this.setItem(i,r.toWebStorageJSON())}removeMutationState(e){let t=Sj(this.persistenceKey,this.currentUser,e);this.removeItem(t)}persistOnlineState(e){let t={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))}persistQueryTargetState(e,t,n){let r=SU(this.persistenceKey,e),i=new SY(e,t,n);this.setItem(r,i.toWebStorageJSON())}persistBundleLoadedState(e){let t=JSON.stringify(Array.from(e));this.setItem(this.bundleLoadedKey,t)}fromWebStorageClientStateKey(e){let t=this.clientStateKeyRe.exec(e);return t?t[1]:null}fromWebStorageClientState(e,t){let n=this.fromWebStorageClientStateKey(e);return SJ.fromWebStorageEntry(n,t)}fromWebStorageMutationMetadata(e,t){let n=this.mutationBatchKeyRe.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return SQ.fromWebStorageEntry(new cR(i),r,t)}fromWebStorageQueryTargetMetadata(e,t){let n=Number(this.queryTargetKeyRe.exec(e)[1]);return SY.fromWebStorageEntry(n,t)}fromWebStorageOnlineState(e){return SX.fromWebStorageEntry(e)}fromWebStoreBundleLoadedState(e){return JSON.parse(e)}async handleMutationBatchEvent(e){if(e.user.uid!==this.currentUser.uid){cL(SK,`Ignoring mutation for non-active user ${e.user.uid}`);return}return this.syncEngine.applyBatchState(e.batchId,e.state,e.error)}handleQueryTargetEvent(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)}handleClientStateEvent(e,t){let n=t?this.activeClients.insert(e,t):this.activeClients.remove(e),r=this.extractActiveQueryTargets(this.activeClients),i=this.extractActiveQueryTargets(n),s=[],a=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.applyActiveTargetsChange(s,a).then(()=>{this.activeClients=n})}handleOnlineStateEvent(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}extractActiveQueryTargets(e){let t=mK();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}function S1(e){let t=dW.INVALID;if(null!=e)try{let n=JSON.parse(e);cU("number"==typeof n),t=n}catch(e){cB(SK,"Failed to read sequence number from WebStorage",e)}return t}class S2{constructor(){this.localState=new SZ,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,n){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new SZ,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class S4{addCallback(e){}shutdown(){}}class S3{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}}let S6=null;function S5(){return 268435456+Math.round(2147483648*Math.random())}function S9(){return null===S6?S6=S5():S6++,"0x"+S6.toString(16)}function S7(e){return new Promise((t,n)=>{e((e,r)=>{e?n(e):t(r)})})}let S8="1.9.1",Te="GrpcConnection",Tt=`gl-node/${process.versions.node} fire/${cN} grpc/${S8}`;function Tn(e,t,n,r){cU(null===t||"OAuth"===t.type);let i=new c_.SF;return t&&t.headers.forEach((e,t)=>i.set(t,e)),n&&n.headers.forEach((e,t)=>i.set(t,e)),r&&i.set("X-Firebase-GMPID",r),i.set("X-Goog-Api-Client",Tt),i.set("Google-Cloud-Resource-Prefix",e),i.set("x-goog-request-params",e),i}class Tr{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){cL(Te,"Creating Firestore stub.");let e=this.databaseInfo.ssl?c_.K9.createSsl():c_.K9.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,n,r,i){let s=S9(),a=this.ensureActiveStub(),o=Tn(this.databasePath,r,i,this.databaseInfo.appId),l=Object.assign({database:this.databasePath},n);return S7(t=>(cL(Te,`RPC '${e}' ${s} invoked with request:`,n),a[e](l,o,(n,r)=>{n?(cL(Te,`RPC '${e}' ${s} failed with error:`,n),t(new cW(gO(n.code),n.message))):(cL(Te,`RPC '${e}' ${s} completed with response:`,r),t(void 0,r))})))}invokeStreamingRPC(e,t,n,r,i,s){let a=S9(),o=[],l=new c$;cL(Te,`RPC '${e}' ${a} invoked (streaming) with request:`,n);let u=this.ensureActiveStub(),c=Tn(this.databasePath,r,i,this.databaseInfo.appId),d=Object.assign(Object.assign({},n),{database:this.databasePath}),h=u[e](d,c),f=!1;return h.on("data",t=>{cL(Te,`RPC ${e} ${a} received result:`,t),o.push(t),void 0!==s&&o.length===s&&(f=!0,l.resolve(o))}),h.on("end",()=>{cL(Te,`RPC '${e}' ${a} completed.`),f||(f=!0,l.resolve(o))}),h.on("error",t=>{cL(Te,`RPC '${e}' ${a} failed with error:`,t);let n=gO(t.code);l.reject(new cW(n,t.message))}),l.promise}openStream(e,t,n){let r=S9(),i=this.ensureActiveStub(),s=Tn(this.databasePath,t,n,this.databaseInfo.appId),a=i[e](s),o=!1,l=e=>{o||(o=!0,u.callOnClose(e),a.end())},u=new S3({sendFn:t=>{if(o)cL(Te,`RPC '${e}' stream ${r} not sending because gRPC stream is closed:`,t);else{cL(Te,`RPC '${e}' stream ${r} sending:`,t);try{a.write(t)}catch(e){throw cB("Failure sending:",t),cB("Error:",e),e}}},closeFn:()=>{cL(Te,`RPC '${e}' stream ${r} closed locally via close().`),l()}}),c=!1;return a.on("data",t=>{o||(cL(Te,`RPC '${e}' stream ${r} received:`,t),c||(u.callOnConnected(),c=!0),u.callOnMessage(t))}),a.on("end",()=>{cL(Te,`RPC '${e}' stream ${r} ended.`),l()}),a.on("error",t=>{o||(cF(Te,`RPC '${e}' stream ${r} error. Code:`,t.code,"Message:",t.message),l(new cW(gO(t.code),t.message)))}),cL(Te,`Opening RPC '${e}' stream ${r} to ${this.databaseInfo.host}`),setTimeout(()=>{u.callOnOpen()},0),u}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let Ti={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var Ts={nested:Ti},Ta=Object.freeze({__proto__:null,nested:Ti,default:Ts});let To={longs:String,enums:String,defaults:!0,oneofs:!1};function Tl(){let e=cI.im(Ta,To);return c_.Rz(e)}function Tu(e){return new Tr(Tl(),e)}function Tc(){return new S4}function Td(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function Th(){return null}function Tf(e){return new g3(e,!1)}let Tp="ExponentialBackoff",Tm=1e3,Tg=1.5,Ty=6e4;class Tv{constructor(e,t,n=Tm,r=Tg,i=Ty){this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),n=Math.max(0,Date.now()-this.lastAttemptTime),r=Math.max(0,t-n);r>0&&cL(Tp,`Backing off for ${r} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,r,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}let Tb="PersistentStream",Tw=6e4,TS=1e4;class TT{constructor(e,t,n,r,i,s,a,o){this.queue=e,this.idleTimerId=n,this.healthTimerId=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new Tv(e,t)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state){this.performBackoff();return}this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,Tw,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(e,t){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==e?this.backoff.reset():t&&t.code===cq.RESOURCE_EXHAUSTED?(cB(t.toString()),cB("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===cq.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,await this.listener.onClose(t)}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.closeCount===t&&this.startStream(e,n)},t=>{e(()=>{let e=new cW(cq.UNKNOWN,"Fetching auth token failed: "+t.message);return this.handleStreamClose(e)})})}startStream(e,t){let n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{n(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{n(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,TS,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(e=>{n(()=>this.handleStreamClose(e))}),this.stream.onMessage(e=>{n(()=>1==++this.responseCount?this.onFirst(e):this.onNext(e))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(e){return cL(Tb,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(cL(Tb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TC extends TT{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=yw(this.serializer,e),n=yT(e);return this.listener.onWatchChange(t,n)}watch(e){let t={};t.database=yd(this.serializer),t.addTarget=yj(this.serializer,e);let n=yB(this.serializer,e);n&&(t.labels=n),this.sendRequest(t)}unwatch(e){let t={};t.database=yd(this.serializer),t.removeTarget=e,this.sendRequest(t)}}class TE extends TT{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return cU(!!e.streamToken),this.lastStreamToken=e.streamToken,cU(!e.writeResults||0===e.writeResults.length),this.listener.onHandshakeComplete()}onNext(e){cU(!!e.streamToken),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=yk(e.writeResults,e.commitTime),n=yr(e.commitTime);return this.listener.onMutationResult(n,t)}writeHandshake(){let e={};e.database=yd(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>yC(this.serializer,e))};this.sendRequest(t)}}class Tx{}class T_ extends Tx{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new cW(cq.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,n,r){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.invokeRPC(e,ys(t,n),r,i,s)).catch(e=>{if("FirebaseError"===e.name)throw e.code===cq.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new cW(cq.UNKNOWN,e.toString())})}invokeStreamingRPC(e,t,n,r,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.invokeStreamingRPC(e,ys(t,n),r,s,a,i)).catch(e=>{if("FirebaseError"===e.name)throw e.code===cq.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new cW(cq.UNKNOWN,e.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function TI(e,t,n,r){return new T_(e,t,n,r)}async function Tk(e,t){let n=cz(e),r={writes:t.map(e=>yC(n.serializer,e))};await n.invokeRPC("Commit",n.serializer.databaseId,dn.emptyPath(),r)}async function TD(e,t){let n=cz(e),r={documents:t.map(e=>yo(n.serializer,e))},i=await n.invokeStreamingRPC("BatchGetDocuments",n.serializer.databaseId,dn.emptyPath(),r,t.length),s=new Map;i.forEach(e=>{let t=yb(n.serializer,e);s.set(t.key.toString(),t)});let a=[];return t.forEach(e=>{let t=s.get(e.toString());cU(!!t),a.push(t)}),a}async function TR(e,t,n){var r;let i=cz(e),{request:s,aliasMap:a,parent:o}=yM(i.serializer,mm(t),n);i.connection.shouldResourcePathBeIncludedInRequest||delete s.parent;let l=(await i.invokeStreamingRPC("RunAggregationQuery",i.serializer.databaseId,o,s,1)).filter(e=>!!e.result);cU(1===l.length);let u=null===(r=l[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(u).reduce((e,t)=>(e[a[t]]=u[t],e),{})}function TN(e,t,n){let r=cz(e);return r.verifyInitialized(),new TE(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}function TA(e,t,n){let r=cz(e);return r.verifyInitialized(),new TC(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}let TO="OnlineStateTracker",TM=1,TP=1e4;class TL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",TP,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${TP/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=TM&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${TM} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===e&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(cB(t),this.shouldWarnClientIsOffline=!1):cL(TO,t)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}let TB="RemoteStore",TF=10;class Tj{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=i,this.connectivityMonitor.addCallback(e=>{n.enqueueAndForget(async()=>{TY(this)&&(cL(TB,"Restarting streams for network reachability change."),await Ca(this))})}),this.onlineStateTracker=new TL(n,r)}}function TV(e,t,n,r,i){return new Tj(e,t,n,r,i)}async function TU(e){if(TY(e))for(let t of e.onNetworkStatusChange)await t(!0)}async function Tz(e){for(let t of e.onNetworkStatusChange)await t(!1)}async function Tq(e){let t=cz(e);cL(TB,"RemoteStore shutting down."),t.offlineCauses.add(5),await Tz(t),t.connectivityMonitor.shutdown(),t.onlineStateTracker.set("Unknown")}function TW(e,t){let n=cz(e);!n.listenTargets.has(t.targetId)&&(n.listenTargets.set(t.targetId,t),TQ(n)?TK(n):Cu(n).isOpen()&&TH(n,t))}function T$(e,t){let n=cz(e),r=Cu(n);n.listenTargets.delete(t),r.isOpen()&&TG(n,t),0===n.listenTargets.size&&(r.isOpen()?r.markIdle():TY(n)&&n.onlineStateTracker.set("Unknown"))}function TH(e,t){if(e.watchChangeAggregator.recordPendingTargetRequest(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(c8.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Cu(e).watch(t)}function TG(e,t){e.watchChangeAggregator.recordPendingTargetRequest(t),Cu(e).unwatch(t)}function TK(e){e.watchChangeAggregator=new gJ({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),getTargetDataForTarget:t=>e.listenTargets.get(t)||null,getDatabaseId:()=>e.datastore.serializer.databaseId}),Cu(e).start(),e.onlineStateTracker.handleWatchStreamStart()}function TQ(e){return TY(e)&&!Cu(e).isStarted()&&e.listenTargets.size>0}function TY(e){return 0===cz(e).offlineCauses.size}function TJ(e){e.watchChangeAggregator=void 0}async function TX(e){e.onlineStateTracker.set("Online")}async function TZ(e){e.listenTargets.forEach((t,n)=>{TH(e,t)})}async function T0(e,t){TJ(e),TQ(e)?(e.onlineStateTracker.handleWatchStreamFailure(t),TK(e)):e.onlineStateTracker.set("Unknown")}async function T1(e,t,n){if(e.onlineStateTracker.set("Online"),t instanceof gK&&2===t.state&&t.cause){try{await T6(e,t)}catch(n){cL(TB,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await T2(e,n)}return}if(t instanceof gH?e.watchChangeAggregator.handleDocumentChange(t):t instanceof gG?e.watchChangeAggregator.handleExistenceFilter(t):e.watchChangeAggregator.handleTargetChange(t),!n.isEqual(c8.min()))try{let t=await Sl(e.localStore);n.compareTo(t)>=0&&await T3(e,n)}catch(t){cL(TB,"Failed to raise snapshot:",t),await T2(e,t)}}async function T2(e,t,n){if(dO(t))e.offlineCauses.add(1),await Tz(e),e.onlineStateTracker.set("Offline"),n||(n=()=>Sl(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{cL(TB,"Retrying IndexedDB access"),await n(),e.offlineCauses.delete(1),await TU(e)});else throw t}function T4(e,t){return t().catch(n=>T2(e,n,t))}function T3(e,t){let n=e.watchChangeAggregator.createRemoteEvent(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let i=e.listenTargets.get(r);i&&e.listenTargets.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{let r=e.listenTargets.get(t);r&&(e.listenTargets.set(t,r.withResumeToken(fu.EMPTY_BYTE_STRING,r.snapshotVersion)),TG(e,t),TH(e,new vi(r.target,t,n,r.sequenceNumber)))}),e.remoteSyncer.applyRemoteEvent(n)}async function T6(e,t){let n=t.cause;for(let r of t.targetIds)e.listenTargets.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.listenTargets.delete(r),e.watchChangeAggregator.removeTarget(r))}async function T5(e){let t=cz(e),n=Cc(t),r=t.writePipeline.length>0?t.writePipeline[t.writePipeline.length-1].batchId:fk;for(;T9(t);)try{let e=await Sf(t.localStore,r);if(null===e){0===t.writePipeline.length&&n.markIdle();break}r=e.batchId,T7(t,e)}catch(e){await T2(t,e)}T8(t)&&Ce(t)}function T9(e){return TY(e)&&e.writePipeline.length<TF}function T7(e,t){e.writePipeline.push(t);let n=Cc(e);n.isOpen()&&n.handshakeComplete&&n.writeMutations(t.mutations)}function T8(e){return TY(e)&&!Cc(e).isStarted()&&e.writePipeline.length>0}function Ce(e){Cc(e).start()}async function Ct(e){Cc(e).writeHandshake()}async function Cn(e){let t=Cc(e);for(let n of e.writePipeline)t.writeMutations(n.mutations)}async function Cr(e,t,n){let r=e.writePipeline.shift(),i=gk.from(r,t,n);await T4(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await T5(e)}async function Ci(e,t){t&&Cc(e).handshakeComplete&&await Cs(e,t),T8(e)&&Ce(e)}async function Cs(e,t){if(gA(t.code)){let n=e.writePipeline.shift();Cc(e).inhibitBackoff(),await T4(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await T5(e)}}async function Ca(e){let t=cz(e);t.offlineCauses.add(4),await Tz(t),t.onlineStateTracker.set("Unknown"),t.offlineCauses.delete(4),await TU(t)}async function Co(e,t){let n=cz(e);n.asyncQueue.verifyOperationInProgress(),cL(TB,"RemoteStore received new credentials");let r=TY(n);n.offlineCauses.add(3),await Tz(n),r&&n.onlineStateTracker.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.offlineCauses.delete(3),await TU(n)}async function Cl(e,t){let n=cz(e);t?(n.offlineCauses.delete(2),await TU(n)):t||(n.offlineCauses.add(2),await Tz(n),n.onlineStateTracker.set("Unknown"))}function Cu(e){return e.watchStream||(e.watchStream=TA(e.datastore,e.asyncQueue,{onConnected:TX.bind(null,e),onOpen:TZ.bind(null,e),onClose:T0.bind(null,e),onWatchChange:T1.bind(null,e)}),e.onNetworkStatusChange.push(async t=>{t?(e.watchStream.inhibitBackoff(),TQ(e)?TK(e):e.onlineStateTracker.set("Unknown")):(await e.watchStream.stop(),TJ(e))})),e.watchStream}function Cc(e){return e.writeStream||(e.writeStream=TN(e.datastore,e.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:Ct.bind(null,e),onClose:Ci.bind(null,e),onHandshakeComplete:Cn.bind(null,e),onMutationResult:Cr.bind(null,e)}),e.onNetworkStatusChange.push(async t=>{t?(e.writeStream.inhibitBackoff(),await T5(e)):(await e.writeStream.stop(),e.writePipeline.length>0&&(cL(TB,`Stopping write stream with ${e.writePipeline.length} pending writes`),e.writePipeline=[]))})),e.writeStream}let Cd="AsyncQueue";class Ch{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new c$,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){let s=new Ch(e,t,Date.now()+n,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new cW(cq.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cf(e,t){if(cB(Cd,`${t}: ${e}`),dO(e))return new cW(cq.UNAVAILABLE,`${t}: ${e}`);throw e}class Cp{static emptySet(e){return new Cp(e.comparator)}constructor(e){e?this.comparator=(t,n)=>e(t,n)||ds.comparator(t.key,n.key):this.comparator=(e,t)=>ds.comparator(e.key,t.key),this.keyedMap=mB(),this.sortedSet=new h7(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Cp)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){let e=[];return(this.forEach(t=>{e.push(t.toString())}),0===e.length)?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let n=new Cp;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Cm{constructor(){this.changeMap=new h7(ds.comparator)}track(e){let t=e.doc.key,n=this.changeMap.get(t);if(!n){this.changeMap=this.changeMap.insert(t,e);return}0!==e.type&&3===n.type?this.changeMap=this.changeMap.insert(t,e):3===e.type&&1!==n.type?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.changeMap=this.changeMap.remove(t):1===e.type&&2===n.type?this.changeMap=this.changeMap.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):cV()}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,n)=>{e.push(n)}),e}}class Cg{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Cg(e,t,Cp.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!mT(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Cy{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}}function Cv(){return new Cb}class Cb{constructor(){this.queries=Cw(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){C_(this,new cW(cq.ABORTED,"Firestore shutting down"))}}function Cw(){return new mO(e=>mC(e),mT)}async function CS(e,t){let n=cz(e),r=3,i=t.query,s=n.queries.get(i);s?!s.hasRemoteListeners()&&t.listensToRemoteStore()&&(r=2):(s=new Cy,r=t.listensToRemoteStore()?0:1);try{switch(r){case 0:s.viewSnap=await n.onListen(i,!0);break;case 1:s.viewSnap=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(n){let e=Cf(n,`Initialization of query '${mE(t.query)}' failed`);t.onError(e);return}n.queries.set(i,s),s.listeners.push(t),t.applyOnlineStateChange(n.onlineState),s.viewSnap&&t.onViewSnapshot(s.viewSnap)&&CI(n)}async function CT(e,t){let n=cz(e),r=t.query,i=3,s=n.queries.get(r);if(s){let e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),0===s.listeners.length?i=t.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&t.listensToRemoteStore()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function CC(e,t){let n=cz(e),r=!1;for(let e of t){let t=e.query,i=n.queries.get(t);if(i){for(let t of i.listeners)t.onViewSnapshot(e)&&(r=!0);i.viewSnap=e}}r&&CI(n)}function CE(e,t,n){let r=cz(e),i=r.queries.get(t);if(i)for(let e of i.listeners)e.onError(n);r.queries.delete(t)}function Cx(e,t){let n=cz(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(let e of n.listeners)e.applyOnlineStateChange(t)&&(r=!0)}),r&&CI(n)}function C_(e,t){let n=cz(e),r=n.queries;n.queries=Cw(),r.forEach((e,n)=>{for(let e of n.listeners)e.onError(t)})}function CI(e){e.snapshotsInSyncListeners.forEach(e=>{e.next()})}!function(e){e.Default="default",e.Cache="cache"}(f||(f={}));class Ck{constructor(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=n||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let t=[];for(let n of e.docChanges)3!==n.type&&t.push(n);e=new Cg(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let n="Offline"!==t;return(!this.options.waitForSyncWhenOnline||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return(!!e.syncStateChanged||!!t)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(e){e=Cg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==f.Cache}}class CD{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.addedKeys=n,this.removedKeys=r}static fromSnapshot(e,t){let n=mH(),r=mH();for(let e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new CD(e,t.fromCache,n,r)}}class CR{constructor(e){this.serializer=e}toDocumentKey(e){return yl(this.serializer,e)}toMutableDocument(e){return e.metadata.exists?yg(this.serializer,e.document,!1):pw.newNoDocument(this.toDocumentKey(e.metadata.name),this.toSnapshotVersion(e.metadata.readTime))}toSnapshotVersion(e){return yr(e)}}class CN{constructor(e,t,n){this.bundleMetadata=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=CA(e)}addSizedElement(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),!e.payload.documentMetadata.exists&&++t;let n=dn.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}getQueryDocumentMapping(e){let t=new Map,n=new CR(this.serializer);for(let r of e)if(r.metadata.queries){let e=n.toDocumentKey(r.metadata.name);for(let n of r.metadata.queries){let r=(t.get(n)||mH()).add(e);t.set(n,r)}}return t}async complete(){let e=await SI(this.localStore,new CR(this.serializer),this.documents,this.bundleMetadata.id),t=this.getQueryDocumentMapping(this.documents);for(let e of this.queries)await SR(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:e}}}function CA(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}function CO(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class CM{constructor(e){this.key=e}}class CP{constructor(e){this.key=e}}class CL{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=mH(),this.mutatedKeys=mH(),this.docComparator=mN(e),this.documentSet=new Cp(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let n=t?t.changeSet:new Cm,r=t?t.documentSet:this.documentSet,i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1,o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{let u=r.get(e),c=mx(this.query,t)?t:null,d=!!u&&this.mutatedKeys.has(u.key),h=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations),f=!1;u&&c?u.data.isEqual(c.data)?d!==h&&(n.track({type:3,doc:c}),f=!0):!this.shouldWaitForSyncedDocument(u,c)&&(n.track({type:2,doc:c}),f=!0,(o&&this.docComparator(c,o)>0||l&&0>this.docComparator(c,l))&&(a=!0)):!u&&c?(n.track({type:0,doc:c}),f=!0):u&&!c&&(n.track({type:1,doc:u}),f=!0,(o||l)&&(a=!0)),f&&(c?(s=s.add(c),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{documentSet:s,changeSet:n,needsRefill:a,mutatedKeys:i}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){let i=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let s=e.changeSet.getChanges();s.sort((e,t)=>CB(e.type,t.type)||this.docComparator(e.doc,t.doc)),this.applyTargetChange(n),r=null!=r&&r;let a=t&&!r?this.updateLimboDocuments():[],o=0===this.limboDocuments.size&&this.current&&!r?1:0,l=o!==this.syncState;return(this.syncState=o,0!==s.length||l)?{snapshot:new Cg(this.query,e.documentSet,i,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),limboChanges:a}:{limboChanges:a}}applyOnlineStateChange(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Cm,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations}applyTargetChange(e){e&&(e.addedDocuments.forEach(e=>this._syncedDocuments=this._syncedDocuments.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this._syncedDocuments=this._syncedDocuments.delete(e)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=mH(),this.documentSet.forEach(e=>{this.shouldBeInLimbo(e.key)&&(this.limboDocuments=this.limboDocuments.add(e.key))});let t=[];return e.forEach(e=>{this.limboDocuments.has(e)||t.push(new CP(e))}),this.limboDocuments.forEach(n=>{e.has(n)||t.push(new CM(n))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=mH();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return Cg.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function CB(e,t){let n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cV()}};return n(e)-n(t)}let CF="SyncEngine";class Cj{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class CV{constructor(e){this.key=e,this.receivedDocument=!1}}class CU{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.syncEngineListener={},this.queryViewsByQuery=new mO(e=>mC(e),mT),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new h7(ds.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new wm,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=bU.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function Cz(e,t,n,r,i,s,a){let o=new CU(e,t,n,r,i,s);return a&&(o._isPrimaryClient=!0),o}async function Cq(e,t,n=!0){let r;let i=Ep(e),s=i.queryViewsByQuery.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.computeInitialSnapshot()):r=await C$(i,t,n,!0),r}async function CW(e,t){let n=Ep(e);await C$(n,t,!0,!1)}async function C$(e,t,n,r){let i;let s=await Sm(e.localStore,mp(t)),a=s.targetId,o=e.sharedClientState.addLocalQueryTarget(a,n);return r&&(i=await CH(e,t,a,"current"===o,s.resumeToken)),e.isPrimaryClient&&n&&TW(e.remoteStore,s),i}async function CH(e,t,n,r,i){e.applyDocChanges=(t,n,r)=>Et(e,t,n,r);let s=await Sv(e.localStore,t,!0),a=new CL(t,s.remoteKeys),o=a.computeDocChanges(s.documents),l=g$.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=a.applyChanges(o,e.isPrimaryClient,l);C9(e,n,u.limboChanges);let c=new Cj(t,n,a);return e.queryViewsByQuery.set(t,c),e.queriesByTarget.has(n)?e.queriesByTarget.get(n).push(t):e.queriesByTarget.set(n,[t]),u.snapshot}async function CG(e,t,n){let r=cz(e),i=r.queryViewsByQuery.get(t),s=r.queriesByTarget.get(i.targetId);if(s.length>1){r.queriesByTarget.set(i.targetId,s.filter(e=>!mT(e,t))),r.queryViewsByQuery.delete(t);return}r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Sy(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&T$(r.remoteStore,i.targetId),C6(r,i.targetId)}).catch(dE)):(C6(r,i.targetId),await Sy(r.localStore,i.targetId,!0))}async function CK(e,t){let n=cz(e),r=n.queryViewsByQuery.get(t),i=n.queriesByTarget.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),T$(n.remoteStore,r.targetId))}async function CQ(e,t,n){let r=Em(e);try{let e=await Sr(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),C4(r,e.batchId,n),await Ee(r,e.changes),await T5(r.remoteStore)}catch(t){let e=Cf(t,"Failed to persist write");n.reject(e)}}async function CY(e,t){let n=cz(e);try{let e=await Su(n.localStore,t);t.targetChanges.forEach((e,t)=>{let r=n.activeLimboResolutionsByTarget.get(t);r&&(cU(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.receivedDocument=!0:e.modifiedDocuments.size>0?cU(r.receivedDocument):e.removedDocuments.size>0&&(cU(r.receivedDocument),r.receivedDocument=!1))}),await Ee(n,e,t)}catch(e){await dE(e)}}function CJ(e,t,n){let r=cz(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){let e=[];r.queryViewsByQuery.forEach((n,r)=>{let i=r.view.applyOnlineStateChange(t);i.snapshot&&e.push(i.snapshot)}),Cx(r.eventManager,t),e.length&&r.syncEngineListener.onWatchChange(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function CX(e,t,n){let r=cz(e);r.sharedClientState.updateQueryState(t,"rejected",n);let i=r.activeLimboResolutionsByTarget.get(t),s=i&&i.key;if(s){let e=new h7(ds.comparator);e=e.insert(s,pw.newNoDocument(s,c8.min()));let n=mH().add(s),i=new gW(c8.min(),new Map,new h7(c4),e,n);await CY(r,i),r.activeLimboTargetsByKey=r.activeLimboTargetsByKey.remove(s),r.activeLimboResolutionsByTarget.delete(t),C8(r)}else await Sy(r.localStore,t,!1).then(()=>C6(r,t,n)).catch(dE)}async function CZ(e,t){let n=cz(e),r=t.batch.batchId;try{let e=await Si(n.localStore,t);C3(n,r,null),C1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ee(n,e)}catch(e){await dE(e)}}async function C0(e,t,n){let r=cz(e);try{let e=await Sa(r.localStore,t);C3(r,t,n),C1(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Ee(r,e)}catch(e){await dE(e)}}function C1(e,t){(e.pendingWritesCallbacks.get(t)||[]).forEach(e=>{e.resolve()}),e.pendingWritesCallbacks.delete(t)}function C2(e,t){e.pendingWritesCallbacks.forEach(e=>{e.forEach(e=>{e.reject(new cW(cq.CANCELLED,t))})}),e.pendingWritesCallbacks.clear()}function C4(e,t,n){let r=e.mutationUserCallbacks[e.currentUser.toKey()];r||(r=new h7(c4)),r=r.insert(t,n),e.mutationUserCallbacks[e.currentUser.toKey()]=r}function C3(e,t,n){let r=cz(e),i=r.mutationUserCallbacks[r.currentUser.toKey()];if(i){let e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.mutationUserCallbacks[r.currentUser.toKey()]=i}}function C6(e,t,n=null){for(let r of(e.sharedClientState.removeLocalQueryTarget(t),e.queriesByTarget.get(t)))e.queryViewsByQuery.delete(r),n&&e.syncEngineListener.onWatchError(r,n);e.queriesByTarget.delete(t),e.isPrimaryClient&&e.limboDocumentRefs.removeReferencesForId(t).forEach(t=>{e.limboDocumentRefs.containsKey(t)||C5(e,t)})}function C5(e,t){e.enqueuedLimboResolutions.delete(t.path.canonicalString());let n=e.activeLimboTargetsByKey.get(t);null!==n&&(T$(e.remoteStore,n),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.remove(t),e.activeLimboResolutionsByTarget.delete(n),C8(e))}function C9(e,t,n){for(let r of n)r instanceof CM?(e.limboDocumentRefs.addReference(r.key,t),C7(e,r)):r instanceof CP?(cL(CF,"Document no longer in limbo: "+r.key),e.limboDocumentRefs.removeReference(r.key,t),e.limboDocumentRefs.containsKey(r.key)||C5(e,r.key)):cV()}function C7(e,t){let n=t.key,r=n.path.canonicalString();e.activeLimboTargetsByKey.get(n)||e.enqueuedLimboResolutions.has(r)||(cL(CF,"New document in limbo: "+n),e.enqueuedLimboResolutions.add(r),C8(e))}function C8(e){for(;e.enqueuedLimboResolutions.size>0&&e.activeLimboTargetsByKey.size<e.maxConcurrentLimboResolutions;){let t=e.enqueuedLimboResolutions.values().next().value;e.enqueuedLimboResolutions.delete(t);let n=new ds(dn.fromString(t)),r=e.limboTargetIdGenerator.next();e.activeLimboResolutionsByTarget.set(r,new CV(n)),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.insert(n,r),TW(e.remoteStore,new vi(mp(mo(n.path)),r,"TargetPurposeLimboResolution",dW.INVALID))}}async function Ee(e,t,n){let r=cz(e),i=[],s=[],a=[];r.queryViewsByQuery.isEmpty()||(r.queryViewsByQuery.forEach((e,o)=>{a.push(r.applyDocChanges(o,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){let i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);let t=CD.fromSnapshot(o.targetId,e);s.push(t)}}))}),await Promise.all(a),r.syncEngineListener.onWatchChange(i),await Sh(r.localStore,s))}async function Et(e,t,n,r){let i=t.view.computeDocChanges(n);i.needsRefill&&(i=await Sv(e.localStore,t.query,!1).then(({documents:e})=>t.view.computeDocChanges(e,i)));let s=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return C9(e,t.targetId,o.limboChanges),o.snapshot}async function En(e,t){let n=cz(e);if(!n.currentUser.isEqual(t)){cL(CF,"User change. New user:",t.toKey());let e=await Sn(n.localStore,t);n.currentUser=t,C2(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ee(n,e.affectedDocuments)}}function Er(e,t){let n=cz(e),r=n.activeLimboResolutionsByTarget.get(t);if(r&&r.receivedDocument)return mH().add(r.key);{let e=mH(),r=n.queriesByTarget.get(t);if(!r)return e;for(let t of r){let r=n.queryViewsByQuery.get(t);e=e.unionWith(r.view.syncedDocuments)}return e}}async function Ei(e,t){let n=cz(e),r=await Sv(n.localStore,t.query,!0),i=t.view.synchronizeWithPersistedState(r);return n.isPrimaryClient&&C9(n,t.targetId,i.limboChanges),i}async function Es(e,t){let n=cz(e);return SE(n.localStore,t).then(e=>Ee(n,e))}async function Ea(e,t,n,r){let i=cz(e),s=await Sw(i.localStore,t);if(null===s){cL(CF,"Cannot apply mutation batch with id: "+t);return}"pending"===n?await T5(i.remoteStore):"acknowledged"===n||"rejected"===n?(C3(i,t,r||null),C1(i,t),SS(i.localStore,t)):cV(),await Ee(i,s)}async function Eo(e,t){let n=cz(e);if(Ep(n),Em(n),!0===t&&!0!==n._isPrimaryClient){let e=n.sharedClientState.getAllActiveQueryTargets(),t=await Eu(n,e.toArray());for(let e of(n._isPrimaryClient=!0,await Cl(n.remoteStore,!0),t))TW(n.remoteStore,e)}else if(!1===t&&!1!==n._isPrimaryClient){let e=[],t=Promise.resolve();n.queriesByTarget.forEach((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(C6(n,i),Sy(n.localStore,i,!0))),T$(n.remoteStore,i)}),await t,await Eu(n,e),El(n),n._isPrimaryClient=!1,await Cl(n.remoteStore,!1)}}function El(e){let t=cz(e);t.activeLimboResolutionsByTarget.forEach((e,n)=>{T$(t.remoteStore,n)}),t.limboDocumentRefs.removeAllReferences(),t.activeLimboResolutionsByTarget=new Map,t.activeLimboTargetsByKey=new h7(ds.comparator)}async function Eu(e,t,n){let r=cz(e),i=[],s=[];for(let e of t){let t;let n=r.queriesByTarget.get(e);if(n&&0!==n.length)for(let e of(t=await Sm(r.localStore,mp(n[0])),n)){let t=r.queryViewsByQuery.get(e),n=await Ei(r,t);n.snapshot&&s.push(n.snapshot)}else{let n=await SC(r.localStore,e);t=await Sm(r.localStore,n),await CH(r,Ec(n),e,!1,t.resumeToken)}i.push(t)}return r.syncEngineListener.onWatchChange(s),i}function Ec(e){return ma(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Ed(e){return ST(cz(e).localStore)}async function Eh(e,t,n,r){let i=cz(e);if(i._isPrimaryClient){cL(CF,"Ignoring unexpected query state notification.");return}let s=i.queriesByTarget.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{let e=await SE(i.localStore,mR(s[0])),r=gW.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,fu.EMPTY_BYTE_STRING);await Ee(i,e,r);break}case"rejected":await Sy(i.localStore,t,!0),C6(i,t,r);break;default:cV()}}async function Ef(e,t,n){let r=Ep(e);if(r._isPrimaryClient){for(let e of t){if(r.queriesByTarget.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){cL(CF,"Adding an already active target "+e);continue}let t=await SC(r.localStore,e),n=await Sm(r.localStore,t);await CH(r,Ec(t),n.targetId,!1,n.resumeToken),TW(r.remoteStore,n)}for(let e of n)r.queriesByTarget.has(e)&&await Sy(r.localStore,e,!1).then(()=>{T$(r.remoteStore,e),C6(r,e)}).catch(dE)}}function Ep(e){let t=cz(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=CY.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Er.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=CX.bind(null,t),t.syncEngineListener.onWatchChange=CC.bind(null,t.eventManager),t.syncEngineListener.onWatchError=CE.bind(null,t.eventManager),t}function Em(e){let t=cz(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=CZ.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=C0.bind(null,t),t}async function Eg(e,t,n){try{let r=await t.getMetadata();if(await Sk(e.localStore,r))return await t.close(),n._completeWith(CO(r)),Promise.resolve(new Set);n._updateProgress(CA(r));let i=new CN(r,e.localStore,t.serializer),s=await t.nextElement();for(;s;){let e=await i.addSizedElement(s);e&&n._updateProgress(e),s=await t.nextElement()}let a=await i.complete();return await Ee(e,a.changedDocs,void 0),await SD(e.localStore,r),n._completeWith(a.progress),Promise.resolve(a.changedCollectionGroups)}catch(e){return cF(CF,`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}}class Ey{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Tf(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return St(this.persistence,new SP,e.initialUser,this.serializer)}createPersistence(e){return new wx(wI.factory,this.serializer)}createSharedClientState(e){return new S2}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ey.provider={build:()=>new Ey};class Ev extends Ey{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){return cU(this.persistence.referenceDelegate instanceof wk),new b2(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createPersistence(e){let t=void 0!==this.cacheSizeBytes?bQ.withCacheSize(this.cacheSizeBytes):bQ.DEFAULT;return new wx(e=>wk.factory(e,t),this.serializer)}}class Eb extends Ey{constructor(e,t,n){super(),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.onlineComponentProvider.initialize(this,e),await Em(this.onlineComponentProvider.syncEngine),await T5(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return St(this.persistence,new SP,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new b2(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let n=new dq(t,this.persistence);return new dz(e.asyncQueue,n)}createPersistence(e){let t=w6(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?bQ.withCacheSize(this.cacheSizeBytes):bQ.DEFAULT;return new w2(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Td(),Th(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new S2}}class Ew{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>CJ(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=En.bind(null,this.syncEngine),await Cl(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return Cv()}createDatastore(e){let t=Tf(e.databaseInfo.databaseId),n=Tu(e.databaseInfo);return TI(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return TV(this.localStore,this.datastore,e.asyncQueue,e=>CJ(this.syncEngine,e,0),Tc())}createSyncEngine(e,t){return Cz(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await Tq(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Ew.provider={build:()=>new Ew};let ES=10240;function ET(e,t=ES){let n=0;return{async read(){if(n<e.byteLength){let r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}function EC(e,t,n){if(!n)throw new cW(cq.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function EE(e,t,n,r){if(!0===t&&!0===r)throw new cW(cq.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Ex(e){if(!ds.isDocumentKey(e))throw new cW(cq.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function E_(e){if(ds.isDocumentKey(e))throw new cW(cq.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function EI(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Ek(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{let t=ED(e);return t?`a custom ${t} object`:"an object"}}if("function"==typeof e)return"a function";return cV()}function ED(e){return e.constructor?e.constructor.name:null}function ER(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new cW(cq.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Ek(e);throw new cW(cq.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function EN(e,t){if(!(e instanceof Uint8Array))throw new cW(cq.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${Ek(e)}`);return ET(e,t)}class EA{constructor(e){this.observer=e,this.muted=!1}next(e){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):cB("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class EO{constructor(e,t){this.payload=e,this.byteLength=t}isBundleMetadata(){return"metadata"in this.payload}}class EM{constructor(e,t){this.reader=e,this.serializer=t,this.metadata=new c$,this.buffer=new Uint8Array,this.textDecoder=gF(),this.nextElementImpl().then(e=>{e&&e.isBundleMetadata()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==e?void 0:e.payload)}`))},e=>this.metadata.reject(e))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let e=await this.readLength();if(null===e)return null;let t=this.textDecoder.decode(e),n=Number(t);return isNaN(n)&&this.raiseError(`length string (${t}) is not valid number`),new EO(JSON.parse(await this.readJsonString(n)),e.length+n)}indexOfOpenBracket(){return this.buffer.findIndex(e=>123===e)}async readLength(){for(;0>this.indexOfOpenBracket()&&!await this.pullMoreDataToBuffer(););if(0===this.buffer.length)return null;let e=this.indexOfOpenBracket();e<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async readJsonString(e){for(;this.buffer.length<e;)await this.pullMoreDataToBuffer()&&this.raiseError("Reached the end of bundle when more is expected.");let t=this.textDecoder.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}raiseError(e){throw this.reader.cancel(),Error(`Invalid bundle format: ${e}`)}async pullMoreDataToBuffer(){let e=await this.reader.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}function EP(e,t){return new EM(e,t)}class EL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new cW(cq.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await TD(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new gC(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let n=ds.fromPath(t);this.mutations.push(new g_(n,this.precondition(n)))}),await Tk(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else if(e.isNoDocument())t=c8.min();else throw cV();let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new cW(cq.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return this.writtenDocs.has(e.toString())||!t?ga.none():t.isEqual(c8.min())?ga.exists(!1):ga.updateTime(t)}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(this.writtenDocs.has(e.toString())||!t)return ga.exists(!0);if(t.isEqual(c8.min()))throw new cW(cq.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ga.updateTime(t)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}let EB="FirestoreClient",EF=100,Ej=11,EV=20,EU=22;class Ez{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=cR.UNAUTHENTICATED,this.clientId=c2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{cL(EB,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(cL(EB,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:EF}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new c$;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let t=Cf(n,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function Eq(e,t){e.asyncQueue.verifyOperationInProgress(),cL(EB,"Initializing OfflineComponentProvider");let n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Sn(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function EW(e,t){e.asyncQueue.verifyOperationInProgress();let n=await EH(e);cL(EB,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Co(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Co(t.remoteStore,n)),e._onlineComponents=t}function E$(e){return"FirebaseError"===e.name?e.code===cq.FAILED_PRECONDITION||e.code===cq.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||e.code===EU||e.code===EV||e.code===Ej}async function EH(e){if(!e._offlineComponents){if(e._uninitializedComponentsProvider){cL(EB,"Using user provided OfflineComponentProvider");try{await Eq(e,e._uninitializedComponentsProvider._offline)}catch(n){let t=n;if(!E$(t))throw t;cF("Error using user provided cache. Falling back to memory cache: "+t),await Eq(e,new Ey)}}else cL(EB,"Using default OfflineComponentProvider"),await Eq(e,new Ev(void 0))}return e._offlineComponents}async function EG(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(cL(EB,"Using user provided OnlineComponentProvider"),await EW(e,e._uninitializedComponentsProvider._online)):(cL(EB,"Using default OnlineComponentProvider"),await EW(e,new Ew))),e._onlineComponents}function EK(e){return EH(e).then(e=>e.localStore)}function EQ(e){return EG(e).then(e=>e.syncEngine)}function EY(e){return EG(e).then(e=>e.datastore)}function EJ(e,t){let n=new c$;return e.asyncQueue.enqueueAndForget(async()=>CQ(await EQ(e),t,n)),n.promise}function EX(e,t){return e.timeoutSeconds===t.timeoutSeconds}function EZ(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let E0="ComponentProvider",E1=new Map;function E2(e){let t=E1.get(e);t&&(cL(E0,"Removing Datastore"),E1.delete(e),t.terminate())}function E4(e,t,n,r){return new fE(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,EZ(r.experimentalLongPollingOptions),r.useFetchStreams)}let E3="firestore.googleapis.com",E6=!0,E5=5,E9=30,E7=!0;class E8{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new cW(cq.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=E3,this.ssl=E6}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:E6;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=bK;else{if(e.cacheSizeBytes!==bG&&e.cacheSizeBytes<bJ)throw new cW(cq.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${bJ}`);this.cacheSizeBytes=e.cacheSizeBytes}EE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=E7:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=EZ(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),xe(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&EX(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}function xe(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new cW(cq.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<E5)throw new cW(cq.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is ${E5})`);if(e.timeoutSeconds>E9)throw new cW(cq.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is ${E9})`)}}class xt{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new E8({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new cW(cq.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new cW(cq.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new E8(e),void 0!==e.credentials&&(this._authCredentials=c0(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return E2(this),Promise.resolve()}}function xn(e,t,n,r={}){var i;let s=(e=ER(e,xt))._getSettings(),a=`${t}:${n}`;if(s.host!==E3&&s.host!==a&&cF("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=cR.MOCK_USER;else{t=ui(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);let s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new cW(cq.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new cR(s)}e._authCredentials=new cK(new cH(t,n))}}class xr{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new xr(this.firestore,e,this._query)}}class xi{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xi(this.firestore,e,this._key)}}class xs extends xr{constructor(e,t,n){super(e,t,mo(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xi(this.firestore,null,new ds(e))}withConverter(e){return new xs(this.firestore,e,this._path)}}function xa(e,t,...n){if(e=uy(e),EC("collection","path",t),e instanceof xt){let r=dn.fromString(t,...n);return E_(r),new xs(e,null,r)}{if(!(e instanceof xi)&&!(e instanceof xs))throw new cW(cq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=e._path.child(dn.fromString(t,...n));return E_(r),new xs(e.firestore,null,r)}}function xo(e,t,...n){if(e=uy(e),1==arguments.length&&(t=c2.newId()),EC("doc","path",t),e instanceof xt){let r=dn.fromString(t,...n);return Ex(r),new xi(e,null,new ds(r))}{if(!(e instanceof xi)&&!(e instanceof xs))throw new cW(cq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=e._path.child(dn.fromString(t,...n));return Ex(r),new xi(e.firestore,e instanceof xs?e.converter:null,new ds(r))}}let xl="AsyncQueue";class xu{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new Tv(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new c$;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(dO(e))cL(xl,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(e=>{throw this.failure=e,this.operationInProgress=!1,cB("INTERNAL UNHANDLED ERROR: ",xc(e)),e}).then(e=>(this.operationInProgress=!1,e))));return this.tail=t,t}enqueueAfterDelay(e,t,n){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let r=Ch.createAndSchedule(this,e,t,n,e=>this.removeDelayedOperation(e));return this.delayedOperations.push(r),r}verifyNotFailed(){this.failure&&cV()}verifyOperationInProgress(){}async drain(){let e;do e=this.tail,await e;while(e!==this.tail)}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{for(let t of(this.delayedOperations.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.delayedOperations))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}}function xc(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class xd extends xt{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new xu,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xu(e),this._firestoreClient=void 0,await e}}}function xh(e,t){let n="object"==typeof e?e:cs(),r="string"==typeof e?e:t||fx,i=ce(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let e=ut("firestore");e&&xn(i,...e)}return i}function xf(e){if(e._terminated)throw new cW(cq.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||xp(e),e._firestoreClient}function xp(e){var t,n,r;let i=e._freezeSettings(),s=E4(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);!e._componentsProvider&&(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Ez(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&xm(e._componentsProvider))}function xm(e){let t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}function xg(e,t=!0){cA(cr),u8(new uv("firestore",(e,{instanceIdentifier:n,options:r})=>{let i=e.getProvider("app").getImmediate(),s=new xd(new cQ(e.getProvider("auth-internal")),new cZ(e.getProvider("app-check-internal")),fI(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s},"PUBLIC").setMultipleInstances(!0)),ca(ck,cD,e),ca(ck,cD,"esm2017")}class xy{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class xv{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xv(fu.fromBase64String(e))}catch(e){throw new cW(cq.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new xv(fu.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class xb{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new cW(cq.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new di(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class xw{constructor(e){this._methodName=e}}class xS{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new cW(cq.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new cW(cq.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return c4(this._lat,e._lat)||c4(this._long,e._long)}}class xT{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return w9(this._values,e._values)}}let xC=/^__.*__$/;class xE{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new gy(e,this.data,this.fieldMask,t,this.fieldTransforms):new gp(e,this.data,t,this.fieldTransforms)}}class xx{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new gy(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function x_(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cV()}}class xI{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new xI(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var t;let n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return xJ(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(x_(this.dataSource)&&xC.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class xk{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Tf(e)}createContext(e,t,n,r=!1){return new xI({dataSource:e,methodName:t,targetDoc:n,path:di.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xD(e){let t=e._freezeSettings(),n=Tf(e._databaseId);return new xk(e._databaseId,!!t.ignoreUndefinedProperties,n)}function xR(e,t,n,r,i,s={}){let a,o;let l=e.createContext(s.merge||s.mergeFields?2:0,t,n,i);xG("Data must be an object, but it was:",l,r);let u=xU(r,l);if(s.merge)a=new fa(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let r of s.mergeFields){let i=xK(t,r,n);if(!l.contains(i))throw new cW(cq.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);xX(e,i)||e.push(i)}a=new fa(e),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new xE(new pv(u),a,o)}class xN extends xw{_toFieldTransform(e){if(2===e.dataSource)e.fieldMask.push(e.path);else if(1===e.dataSource)throw e.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof xN}}function xA(e,t,n){return new xI({dataSource:3,targetDoc:t.settings.targetDoc,methodName:e._methodName,arrayElement:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class xO extends null{_toFieldTransform(e){return new gn(e.path,new m4)}isEqual(e){return e instanceof xO}}class xM extends xw{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=xA(this,e,!0),n=new m3(this._elements.map(e=>xV(e,t)));return new gn(e.path,n)}isEqual(e){return e instanceof xM&&um(this._elements,e._elements)}}class xP extends xw{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=xA(this,e,!0),n=new m5(this._elements.map(e=>xV(e,t)));return new gn(e.path,n)}isEqual(e){return e instanceof xP&&um(this._elements,e._elements)}}class xL extends xw{constructor(e,t){super(e),this._operand=t}_toFieldTransform(e){let t=new m7(e.serializer,mJ(e.serializer,this._operand));return new gn(e.path,t)}isEqual(e){return e instanceof xL&&this._operand===e._operand}}function xB(e,t,n,r){let i=e.createContext(1,t,n);xG("Data must be an object, but it was:",i,r);let s=[],a=pv.empty();return h5(r,(e,r)=>{let o=xY(t,e,n);r=uy(r);let l=i.childContextForFieldPath(o);if(r instanceof xN)s.push(o);else{let e=xV(r,l);null!=e&&(s.push(o),a.set(o,e))}}),new xx(a,new fa(s),i.fieldTransforms)}function xF(e,t,n,r,i,s){let a=e.createContext(1,t,n),o=[xK(t,r,n)],l=[i];if(s.length%2!=0)throw new cW(cq.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)o.push(xK(t,s[e])),l.push(s[e+1]);let u=[],c=pv.empty();for(let e=o.length-1;e>=0;--e)if(!xX(u,o[e])){let t=o[e],n=l[e];n=uy(n);let r=a.childContextForFieldPath(t);if(n instanceof xN)u.push(t);else{let e=xV(n,r);null!=e&&(u.push(t),c.set(t,e))}}return new xx(c,new fa(u),a.fieldTransforms)}function xj(e,t,n,r=!1){return xV(n,e.createContext(r?4:3,t))}function xV(e,t){if(xH(e=uy(e)))return xG("Unsupported field value:",t,e),xU(e,t);if(e instanceof xw)return xq(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),!(e instanceof Array))return xW(e,t);if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");return xz(e,t)}function xU(e,t){let n={};return h9(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):h5(e,(e,r)=>{let i=xV(r,t.childContextForField(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function xz(e,t){let n=[],r=0;for(let i of e){let e=xV(i,t.childContextForArray(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}function xq(e,t){if(!x_(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}function xW(e,t){if(null===(e=uy(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return mJ(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let n=c7.fromDate(e);return{timestampValue:g7(t.serializer,n)}}if(e instanceof c7){let n=new c7(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:g7(t.serializer,n)}}if(e instanceof xS)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};else if(e instanceof xv)return{bytesValue:ye(t.serializer,e._byteString)};else if(e instanceof xi){let n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.createError(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:yi(e.firestore._databaseId||t.databaseId,e._key.path)}}else if(e instanceof xT)return x$(e,t);else throw t.createError(`Unsupported field value: ${Ek(e)}`)}function x$(e,t){return{mapValue:{fields:{[fA]:{stringValue:fP},[fL]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.createError("VectorValues must only contain numeric values.");return mQ(t.serializer,e)})}}}}}}function xH(e){return"object"==typeof e&&null!==e&&!(e instanceof Array)&&!(e instanceof Date)&&!(e instanceof c7)&&!(e instanceof xS)&&!(e instanceof xv)&&!(e instanceof xi)&&!(e instanceof xw)&&!(e instanceof xT)}function xG(e,t,n){if(!xH(n)||!EI(n)){let r=Ek(n);if("an object"===r)throw t.createError(e+" a custom object");throw t.createError(e+" "+r)}}function xK(e,t,n){if((t=uy(t))instanceof xb)return t._internalPath;if("string"==typeof t)return xY(e,t);throw xJ("Field path arguments must be of type string or ",e,!1,void 0,n)}let xQ=RegExp("[~\\*/\\[\\]]");function xY(e,t,n){if(t.search(xQ)>=0)throw xJ(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new xb(...t.split("."))._internalPath}catch(r){throw xJ(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function xJ(e,t,n,r,i){let s=r&&!r.isEmpty(),a=void 0!==i,o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new cW(cq.INVALID_ARGUMENT,o+e+l)}function xX(e,t){return e.some(e=>e.isEqual(t))}class xZ{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new xi(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let e=new x0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}}}get(e){if(this._document){let t=this._document.data.field(x1("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class x0 extends xZ{data(){return super.data()}}function x1(e,t){return"string"==typeof t?xY(e,t):t instanceof xb?t._internalPath:t._delegate._internalPath}class x2{}class x4 extends x2{}class x3 extends x4{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new x3(e,t,n)}_apply(e){let t=this._parse(e);return _l(e._query,t),new xr(e.firestore,e.converter,my(e._query,t))}_parse(e){let t=xD(e.firestore);return _t(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class x6 extends x2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new x6(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:pO.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(_u(e._query,t),new xr(e.firestore,e.converter,my(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class x5 extends x4{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new x5(e,t)}_apply(e){let t=_n(e._query,this._field,this._direction);return new xr(e.firestore,e.converter,mv(e._query,t))}}class x9 extends x4{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new x9(e,t,n)}_apply(e){return new xr(e.firestore,e.converter,mb(e._query,this._limit,this._limitType))}}class x7 extends x4{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new x7(e,t,n)}_apply(e){let t=_e(e,this.type,this._docOrFields,this._inclusive);return new xr(e.firestore,e.converter,mw(e._query,t))}}class x8 extends x4{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new x8(e,t,n)}_apply(e){let t=_e(e,this.type,this._docOrFields,this._inclusive);return new xr(e.firestore,e.converter,mS(e._query,t))}}function _e(e,t,n,r){if(n[0]=uy(n[0]),n[0]instanceof xZ)return _r(e._query,e.firestore._databaseId,t,n[0]._document,r);{let i=xD(e.firestore);return _i(e._query,e.firestore._databaseId,i,t,n,r)}}function _t(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new cW(cq.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){_a(a,s);let t=[];for(let n of a)t.push(_s(r,e,n));o={arrayValue:{values:t}}}else o=_s(r,e,a)}else("in"===s||"not-in"===s||"array-contains-any"===s)&&_a(a,s),o=xj(n,t,a,"in"===s||"not-in"===s);return pA.create(i,s,o)}function _n(e,t,n){if(null!==e.startAt)throw new cW(cq.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new cW(cq.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pI(t,n)}function _r(e,t,n,r,i){if(!r)throw new cW(cq.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);let s=[];for(let n of mf(e))if(n.field.isKeyField())s.push(pn(t,r.key));else{let e=r.data.field(n.field);if(fw(e))throw new cW(cq.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==e)s.push(e);else{let e=n.field.canonicalString();throw new cW(cq.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}}return new pT(s,i)}function _i(e,t,n,r,i,s){let a=e.explicitOrderBy;if(i.length>a.length)throw new cW(cq.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let o=[];for(let s=0;s<i.length;s++){let l=i[s];if(a[s].field.isKeyField()){if("string"!=typeof l)throw new cW(cq.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof l}`);if(!mh(e)&&-1!==l.indexOf("/"))throw new cW(cq.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${l}' contains a slash.`);let n=e.path.child(dn.fromString(l));if(!ds.isDocumentKey(n))throw new cW(cq.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);let i=new ds(n);o.push(pn(t,i))}else{let e=xj(n,r,l);o.push(e)}}return new pT(o,s)}function _s(e,t,n){if("string"==typeof(n=uy(n))){if(""===n)throw new cW(cq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mh(t)&&-1!==n.indexOf("/"))throw new cW(cq.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=t.path.child(dn.fromString(n));if(!ds.isDocumentKey(r))throw new cW(cq.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return pn(e,new ds(r))}if(n instanceof xi)return pn(e,n._key);throw new cW(cq.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ek(n)}.`)}function _a(e,t){if(!Array.isArray(e)||0===e.length)throw new cW(cq.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function _o(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function _l(e,t){let n=_c(e.filters,_o(t.op));if(null!==n){if(n===t.op)throw new cW(cq.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`);throw new cW(cq.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}}function _u(e,t){let n=e;for(let e of t.getFlattenedFilters())_l(n,e),n=my(n,e)}function _c(e,t){for(let n of e)for(let e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}class _d{convertValue(e,t="none"){switch(fF(e)){case 0:return null;case 1:return e.booleanValue;case 2:return fp(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw cV()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return h5(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;return new xT(null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[fL].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>fp(e.doubleValue)))}convertGeoPoint(e){return new xS(fp(e.latitude),fp(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=fT(e);if(null==n)return null;return this.convertValue(n,t);case"estimate":return this.convertTimestamp(fC(e));default:return null}}convertTimestamp(e){let t=ff(e);return new c7(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=dn.fromString(e);cU(vr(n));let r=new f_(n.get(1),n.get(3)),i=new ds(n.popFirst(5));return r.isEqual(t)||cB(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function _h(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}class _f extends _d{constructor(e){super(),this.firestore=e}convertBytes(e){return new xv(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xi(this.firestore,null,t)}}class _p{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _m extends xZ{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);{let t=new _g(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}}}get(e,t={}){if(this._document){let n=this._document.data.field(x1("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class _g extends _m{data(e={}){return super.data(e)}}function _y(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cV()}}class _v extends _d{constructor(e){super(),this.firestore=e}convertBytes(e){return new xv(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xi(this.firestore,null,t)}}function _b(e,t){let n=ER(e.firestore,xd),r=xo(e),i=_h(e.converter,t);return _w(n,[xR(xD(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,ga.exists(!1))]).then(()=>r)}function _w(e,t){return EJ(xf(e),t)}class _S{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ew.provider,this._offlineComponentProvider={build:t=>new Eb(t,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}}function _T(e,t){if((e=uy(e)).firestore===t)return e;throw new cW(cq.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.")}new WeakMap;class _C{constructor(){this.existenceFilterMismatchCallbacksById=new Map}static get instance(){return _E||gL(_E=new _C),_E}notifyOnExistenceFilterMismatch(e){this.existenceFilterMismatchCallbacksById.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),n=this.existenceFilterMismatchCallbacksById;return n.set(t,e),()=>n.delete(t)}}let _E=null;xg("node"),ca("firebase","11.2.0","app");let _x={apiKey:"AIzaSyAT9yeUR8dCpKbksRvHkcpgQ3fnJYX_yXU",authDomain:"meu-salao-de-beleza-de96e.firebaseapp.com",databaseURL:process.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL,projectId:"meu-salao-de-beleza-de96e",storageBucket:"meu-salao-de-beleza-de96e.appspot.com",messagingSenderId:"168401795517",appId:"1:168401795517:web:155126b89a3e9c2ec37ad4",measurementId:"G-W2NV1442GG"};try{s=cs()}catch{s=ci(_x)}let __=xh(s),_I="/api/create-payment",_k={nails:[{name:"Gel na tips",price:120},{name:"Manuten\xe7\xe3o gel",price:60},{name:"Banho de gel",price:100},{name:"Manicure",price:25},{name:"Pedicure",price:25},{name:"Combo Mani + Pedi",price:45}],eyebrows:[{name:"Designer com Henna",price:35},{name:"Designer Natural",price:25}]},_D=["09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"];function _R(){let[e,t]=(0,m.useState)(""),[n,r]=(0,m.useState)(!1),[i,s]=(0,m.useState)(void 0),[a,o]=(0,m.useState)(""),[l,u]=(0,m.useState)(""),[c,d]=(0,m.useState)(""),[h,f]=(0,m.useState)(""),g=async t=>{t.preventDefault(),r(!0),f("");try{if(!l||!c||!i||!a||!e)throw Error("Todos os campos s\xe3o obrigat\xf3rios!");let t=[..._k.nails,..._k.eyebrows].find(t=>t.name===e);if(!t)throw Error("Servi\xe7o n\xe3o encontrado");let n=await _b(xa(__,"agendamentos"),{nome:l,telefone:c,data:ap(i,"yyyy-MM-dd"),horario:a,servico:e,status:"pendente",createdAt:new Date().toISOString(),valor:t.price});if(console.log(" Agendamento salvo com ID:",n.id),!(await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:"05jeelo30@gmail.com",subject:"Novo Agendamento - KatySilvaNailDesigner",text:`Novo agendamento:
            Nome: ${l}
            WhatsApp: ${c}
            Servi\xe7o: ${e}
            Data: ${ap(i,"dd/MM/yyyy")}
            Hor\xe1rio: ${a}
            Valor: R$ ${t.price.toFixed(2)}`})})).ok)throw Error("Erro ao enviar confirma\xe7\xe3o por e-mail");let r=await fetch(_I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n.id,title:t.name,price:t.price,date:ap(i,"yyyy-MM-dd"),time:a,clientName:l,clientPhone:c,clientEmail:c+"@email.com"})});if(!r.ok){let e=await r.json();throw Error(e.error||"Erro ao processar pagamento")}let s=await r.json();window.location.href=s.init_point}catch(e){console.error(" Erro:",e),f(e.message||"Erro ao processar agendamento")}finally{r(!1)}};return(0,p.jsxs)(p.Fragment,{children:[p.jsx(st(),{src:"https://sdk.mercadopago.com/js/v2",strategy:"lazyOnload"}),(0,p.jsxs)("div",{className:"min-h-screen bg-pink-50 p-4",children:[p.jsx("div",{className:"mb-8 flex justify-center",children:p.jsx(sn,{})}),(0,p.jsxs)(S.Zb,{className:"mx-auto max-w-xl",children:[p.jsx(S.Ol,{children:(0,p.jsxs)(S.ll,{className:"flex items-center gap-2 text-2xl",children:[p.jsx(v,{className:"h-6 w-6 text-pink-600"}),"Agendamento"]})}),p.jsx(S.aY,{children:(0,p.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,p.jsxs)("div",{children:[p.jsx(A,{children:"Nome:"}),p.jsx(C,{value:l,onChange:e=>u(e.target.value),placeholder:"Seu nome completo",required:!0})]}),(0,p.jsxs)("div",{children:[p.jsx(A,{children:"WhatsApp:"}),p.jsx(C,{value:c,onChange:e=>d(e.target.value),placeholder:"(11) 99999-9999",type:"tel",required:!0})]}),(0,p.jsxs)("div",{children:[p.jsx(A,{children:"Servi\xe7o:"}),(0,p.jsxs)(i4,{value:e,onValueChange:t,required:!0,children:[p.jsx(i6,{children:p.jsx(i3,{placeholder:"Selecione um servi\xe7o"})}),p.jsx(i7,{children:Object.entries(_k).map(([e,t])=>p.jsx("div",{children:t.map(e=>(0,p.jsxs)(i8,{value:e.name,children:[e.name," - R$",e.price.toFixed(2)]},e.name))},e))})]})]}),(0,p.jsxs)("div",{children:[p.jsx(A,{children:"Data:"}),(0,p.jsxs)(lK,{children:[p.jsx(lQ,{asChild:!0,children:(0,p.jsxs)(w.z,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[p.jsx(v,{className:"mr-2 h-4 w-4"}),i?ap(i,"dd/MM/yyyy"):"Selecione a data"]})}),p.jsx(lY,{className:"w-auto p-0",children:p.jsx(lv,{mode:"single",selected:i,onSelect:s,disabled:{before:new Date}})})]})]}),(0,p.jsxs)("div",{children:[p.jsx(A,{children:"Hor\xe1rio:"}),(0,p.jsxs)(i4,{value:a,onValueChange:o,disabled:!i,required:!0,children:[p.jsx(i6,{children:p.jsx(i3,{placeholder:"Selecione o hor\xe1rio"})}),p.jsx(i7,{children:_D.map(e=>p.jsx(i8,{value:e,children:e},e))})]})]}),p.jsx(w.z,{type:"submit",disabled:n,className:"w-full",children:n?p.jsx(b,{className:"mr-2 h-4 w-4 animate-spin"}):"Confirmar Agendamento"}),h&&p.jsx("p",{className:"text-red-500 text-center mt-4",children:h})]})})]})]})]})}},90772:(e,t,n)=>{"use strict";n.d(t,{d:()=>l,z:()=>u});var r=n(10326),i=n(17577),s=n(34214),a=n(79360),o=n(77863);let l=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=i.forwardRef(({className:e,variant:t,size:n,asChild:i=!1,...a},u)=>{let c=i?s.g7:"button";return r.jsx(c,{className:(0,o.cn)(l({variant:t,size:n,className:e})),ref:u,...a})});u.displayName="Button"},33071:(e,t,n)=>{"use strict";n.d(t,{Ol:()=>o,SZ:()=>u,Zb:()=>a,aY:()=>c,ll:()=>l});var r=n(10326),i=n(17577),s=n(77863);let a=i.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));a.displayName="Card";let o=i.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...t}));o.displayName="CardHeader";let l=i.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let u=i.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:(0,s.cn)("text-sm text-muted-foreground",e),...t}));u.displayName="CardDescription";let c=i.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:(0,s.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",i.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:(0,s.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},77863:(e,t,n)=>{"use strict";n.d(t,{cn:()=>s});var r=n(41135),i=n(31009);function s(...e){return(0,i.m6)((0,r.W)(e))}},27749:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addAdminServicesToServer=t.registerAdminService=void 0;let n=[];function r(e,t){n.push({getServiceDefinition:e,getHandlers:t})}function i(e){for(let{getServiceDefinition:t,getHandlers:r}of n)e.addService(t(),r())}t.registerAdminService=r,t.addAdminServicesToServer=i},1742:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackoffTimeout=void 0;let n=1e3,r=1.6,i=12e4,s=.2;function a(e,t){return Math.random()*(t-e)+e}class o{constructor(e,t){this.callback=e,this.initialDelay=n,this.multiplier=r,this.maxDelay=i,this.jitter=s,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,n;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||null===(n=(t=this.timerId).unref)||void 0===n||n.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+a(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,null===(t=(e=this.timerId).ref)||void 0===t||t.call(e)}unref(){var e,t;this.hasRef=!1,null===(t=(e=this.timerId).unref)||void 0===t||t.call(e)}getEndTime(){return this.endTime}}t.BackoffTimeout=o},45402:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallCredentials=void 0;let r=n(6281);function i(e){return"getRequestHeaders"in e&&"function"==typeof e.getRequestHeaders}class s{static createFromMetadataGenerator(e){return new o(e)}static createFromGoogleCredential(e){return s.createFromMetadataGenerator((t,n)=>{let s;(s=i(e)?e.getRequestHeaders(t.service_url):new Promise((n,r)=>{e.getRequestMetadata(t.service_url,(e,t)=>{if(e){r(e);return}if(!t){r(Error("Headers not set by metadata plugin"));return}n(t)})})).then(e=>{let t=new r.Metadata;for(let n of Object.keys(e))t.add(n,e[n]);n(null,t)},e=>{n(e)})})}static createEmpty(){return new l}}t.CallCredentials=s;class a extends s{constructor(e){super(),this.creds=e}async generateMetadata(e){let t=new r.Metadata;for(let n of(await Promise.all(this.creds.map(t=>t.generateMetadata(e)))))t.merge(n);return t}compose(e){return new a(this.creds.concat([e]))}_equals(e){return this===e||e instanceof a&&this.creds.every((t,n)=>t._equals(e.creds[n]))}}class o extends s{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,n)=>{this.metadataGenerator(e,(e,r)=>{void 0!==r?t(r):n(e)})})}compose(e){return new a([this,e])}_equals(e){return this===e||e instanceof o&&this.metadataGenerator===e.metadataGenerator}}class l extends s{generateMetadata(e){return Promise.resolve(new r.Metadata)}compose(e){return e}_equals(e){return e instanceof l}}},41218:(e,t)=>{"use strict";function n(e){return void 0!==e.onReceiveMetadata&&1===e.onReceiveMetadata.length}Object.defineProperty(t,"__esModule",{value:!0}),t.InterceptingListenerImpl=t.isInterceptingListener=void 0,t.isInterceptingListener=n;class r{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,e=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(e),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,e=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=e,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(e),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,e=>{this.processingMetadata||this.processingMessage?this.pendingStatus=e:this.nextListener.onReceiveStatus(e)})}}t.InterceptingListenerImpl=r},21801:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNextCallNumber=void 0;let n=0;function r(){return n++}t.getNextCallNumber=r},7639:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientDuplexStreamImpl=t.ClientWritableStreamImpl=t.ClientReadableStreamImpl=t.ClientUnaryCallImpl=t.callErrorFromStatus=void 0;let r=n(17702),i=n(76162),s=n(19572);function a(e,t){let n=`${e.code} ${s.Status[e.code]}: ${e.details}`,r=Error(n),i=`${r.stack}
for call at
${t}`;return Object.assign(Error(n),e,{stack:i})}t.callErrorFromStatus=a;class o extends r.EventEmitter{constructor(){super()}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}}t.ClientUnaryCallImpl=o;class l extends i.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}_read(e){var t;null===(t=this.call)||void 0===t||t.startRead()}}t.ClientReadableStreamImpl=l;class u extends i.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}_write(e,t,n){var r;let i={callback:n},s=Number(t);Number.isNaN(s)||(i.flags=s),null===(r=this.call)||void 0===r||r.sendMessageWithContext(i,e)}_final(e){var t;null===(t=this.call)||void 0===t||t.halfClose(),e()}}t.ClientWritableStreamImpl=u;class c extends i.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}_read(e){var t;null===(t=this.call)||void 0===t||t.startRead()}_write(e,t,n){var r;let i={callback:n},s=Number(t);Number.isNaN(s)||(i.flags=s),null===(r=this.call)||void 0===r||r.sendMessageWithContext(i,e)}_final(e){var t;null===(t=this.call)||void 0===t||t.halfClose(),e()}}t.ClientDuplexStreamImpl=c},70499:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelCredentials=void 0;let r=n(82452),i=n(45402),s=n(80606);function a(e,t){if(e&&!(e instanceof Buffer))throw TypeError(`${t}, if provided, must be a Buffer.`)}class o{constructor(e){this.callCredentials=e||i.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,n,i){var o;if(a(e,"Root certificate"),a(t,"Private key"),a(n,"Certificate chain"),t&&!n)throw Error("Private key must be given with accompanying certificate chain");if(!t&&n)throw Error("Certificate chain must be given with accompanying private key");return new u((0,r.createSecureContext)({ca:null!==(o=null!=e?e:(0,s.getDefaultRootsData)())&&void 0!==o?o:void 0,key:null!=t?t:void 0,cert:null!=n?n:void 0,ciphers:s.CIPHER_SUITES}),null!=i?i:{})}static createFromSecureContext(e,t){return new u(e,null!=t?t:{})}static createInsecure(){return new l}}t.ChannelCredentials=o;class l extends o{constructor(e){super(e)}compose(e){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof l}}class u extends o{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},(null==t?void 0:t.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){return new c(this,this.callCredentials.compose(e))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e||e instanceof u&&this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity}}class c extends o{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new c(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e||e instanceof c&&this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials)}}},89455:(e,t)=>{"use strict";function n(e,t){let n=Object.keys(e).sort(),r=Object.keys(t).sort();if(n.length!==r.length)return!1;for(let i=0;i<n.length;i+=1)if(n[i]!==r[i]||e[n[i]]!==t[r[i]])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.channelOptionsEqual=t.recognizedOptions=void 0,t.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},t.channelOptionsEqual=n},39452:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelImplementation=void 0;let r=n(70499),i=n(29359);class s{constructor(e,t,n){if("string"!=typeof e)throw TypeError("Channel target must be a string");if(!(t instanceof r.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(n&&"object"!=typeof n)throw TypeError("Channel options must be an object");this.internalChannel=new i.InternalChannel(e,t,n)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,n){this.internalChannel.watchConnectivityState(e,t,n)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,n,r,i){if("string"!=typeof e)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,n,r,i)}}t.ChannelImplementation=s},65962:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.getChannelzServiceDefinition=t.getChannelzHandlers=t.unregisterChannelzRef=t.registerChannelzSocket=t.registerChannelzServer=t.registerChannelzSubchannel=t.registerChannelzChannel=t.ChannelzCallTracker=t.ChannelzChildrenTracker=t.ChannelzTrace=void 0;let r=n(98216),i=n(72409),s=n(19572),a=n(74955),o=n(27749),l=n(54529);function u(e){return{channel_id:e.id,name:e.name}}function c(e){return{subchannel_id:e.id,name:e.name}}function d(e){return{server_id:e.id}}function h(e){return{socket_id:e.id,name:e.name}}let f=32;class p{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,n){let r=new Date;this.events.push({description:t,severity:e,timestamp:r,childChannel:(null==n?void 0:n.kind)==="channel"?n:void 0,childSubchannel:(null==n?void 0:n.kind)==="subchannel"?n:void 0}),this.events.length>=2*f&&(this.events=this.events.slice(f)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:A(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:A(e.timestamp),channel_ref:e.childChannel?u(e.childChannel):null,subchannel_ref:e.childSubchannel?c(e.childSubchannel):null}))}}}t.ChannelzTrace=p;class m{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,n,r;switch(e.kind){case"channel":{let n=null!==(t=this.channelChildren.get(e.id))&&void 0!==t?t:{ref:e,count:0};n.count+=1,this.channelChildren.set(e.id,n);break}case"subchannel":{let t=null!==(n=this.subchannelChildren.get(e.id))&&void 0!==n?n:{ref:e,count:0};t.count+=1,this.subchannelChildren.set(e.id,t);break}case"socket":{let t=null!==(r=this.socketChildren.get(e.id))&&void 0!==r?r:{ref:e,count:0};t.count+=1,this.socketChildren.set(e.id,t)}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t))}}}getChildLists(){let e=[];for(let{ref:t}of this.channelChildren.values())e.push(t);let t=[];for(let{ref:e}of this.subchannelChildren.values())t.push(e);let n=[];for(let{ref:e}of this.socketChildren.values())n.push(e);return{channels:e,subchannels:t,sockets:n}}}t.ChannelzChildrenTracker=m;class g{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}t.ChannelzCallTracker=g;let y=1;function v(){return y++}let b=[],w=[],S=[],T=[];function C(e,t,n){let r=v(),i={id:r,name:e,kind:"channel"};return n&&(b[r]={ref:i,getInfo:t}),i}function E(e,t,n){let r=v(),i={id:r,name:e,kind:"subchannel"};return n&&(w[r]={ref:i,getInfo:t}),i}function x(e,t){let n=v(),r={id:n,kind:"server"};return t&&(S[n]={ref:r,getInfo:e}),r}function _(e,t,n){let r=v(),i={id:r,name:e,kind:"socket"};return n&&(T[r]={ref:i,getInfo:t}),i}function I(e){switch(e.kind){case"channel":delete b[e.id];return;case"subchannel":delete w[e.id];return;case"server":delete S[e.id];return;case"socket":delete T[e.id];return}}function k(e){let t=Number.parseInt(e,16);return[t/256|0,t%256]}function D(e){return""===e?[]:[].concat(...e.split(":").map(e=>k(e)))}function R(e){if((0,r.isIPv4)(e))return Buffer.from(Uint8Array.from(e.split(".").map(e=>Number.parseInt(e))));if(!(0,r.isIPv6)(e))return null;{let t,n;let r=e.indexOf("::");-1===r?(t=e,n=""):(t=e.substring(0,r),n=e.substring(r+2));let i=Buffer.from(D(t)),s=Buffer.from(D(n)),a=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,a,s])}}function N(e){switch(e){case i.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case i.ConnectivityState.IDLE:return{state:"IDLE"};case i.ConnectivityState.READY:return{state:"READY"};case i.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case i.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function A(e){if(!e)return null;let t=e.getTime();return{seconds:t/1e3|0,nanos:t%1e3*1e6}}function O(e){let t=e.getInfo();return{ref:u(e.ref),data:{target:t.target,state:N(t.state),calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:A(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},channel_ref:t.children.channels.map(e=>u(e)),subchannel_ref:t.children.subchannels.map(e=>c(e))}}function M(e,t){let n=Number.parseInt(e.request.channel_id),r=b[n];if(void 0===r){t({code:s.Status.NOT_FOUND,details:"No channel data found for id "+n});return}t(null,{channel:O(r)})}function P(e,t){let n=Number.parseInt(e.request.max_results),r=[],i=Number.parseInt(e.request.start_channel_id);for(;i<b.length;i++){let e=b[i];if(void 0!==e&&(r.push(O(e)),r.length>=n))break}t(null,{channel:r,end:i>=S.length})}function L(e){let t=e.getInfo();return{ref:d(e.ref),data:{calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:A(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},listen_socket:t.listenerChildren.sockets.map(e=>h(e))}}function B(e,t){let n=Number.parseInt(e.request.server_id),r=S[n];if(void 0===r){t({code:s.Status.NOT_FOUND,details:"No server data found for id "+n});return}t(null,{server:L(r)})}function F(e,t){let n=Number.parseInt(e.request.max_results),r=[],i=Number.parseInt(e.request.start_server_id);for(;i<S.length;i++){let e=S[i];if(void 0!==e&&(r.push(L(e)),r.length>=n))break}t(null,{server:r,end:i>=S.length})}function j(e,t){let n=Number.parseInt(e.request.subchannel_id),r=w[n];if(void 0===r){t({code:s.Status.NOT_FOUND,details:"No subchannel data found for id "+n});return}let i=r.getInfo();t(null,{subchannel:{ref:c(r.ref),data:{target:i.target,state:N(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:A(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(e=>h(e))}})}function V(e){var t;return(0,a.isTcpSubchannelAddress)(e)?{address:"tcpip_address",tcpip_address:{ip_address:null!==(t=R(e.host))&&void 0!==t?t:void 0,port:e.port}}:{address:"uds_address",uds_address:{filename:e.path}}}function U(e,t){var n,r,i,a,o;let l=Number.parseInt(e.request.socket_id),u=T[l];if(void 0===u){t({code:s.Status.NOT_FOUND,details:"No socket data found for id "+l});return}let c=u.getInfo(),d=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!==(n=c.security.cipherSuiteStandardName)&&void 0!==n?n:void 0,other_name:null!==(r=c.security.cipherSuiteOtherName)&&void 0!==r?r:void 0,local_certificate:null!==(i=c.security.localCertificate)&&void 0!==i?i:void 0,remote_certificate:null!==(a=c.security.remoteCertificate)&&void 0!==a?a:void 0}}:null;t(null,{socket:{ref:h(u.ref),local:c.localAddress?V(c.localAddress):null,remote:c.remoteAddress?V(c.remoteAddress):null,remote_name:null!==(o=c.remoteName)&&void 0!==o?o:void 0,security:d,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:A(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:A(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:A(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:A(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}}})}function z(e,t){let n=Number.parseInt(e.request.server_id),r=S[n];if(void 0===r){t({code:s.Status.NOT_FOUND,details:"No server data found for id "+n});return}let i=Number.parseInt(e.request.start_socket_id),a=Number.parseInt(e.request.max_results),o=r.getInfo().sessionChildren.sockets.sort((e,t)=>e.id-t.id),l=[],u=0;for(;u<o.length&&(!(o[u].id>=i)||(l.push(h(o[u])),!(l.length>=a)));u++);t(null,{socket_ref:l,end:u>=o.length})}function q(){return{GetChannel:M,GetTopChannels:P,GetServer:B,GetServers:F,GetSubchannel:j,GetSocket:U,GetServerSockets:z}}t.registerChannelzChannel=C,t.registerChannelzSubchannel=E,t.registerChannelzServer=x,t.registerChannelzSocket=_,t.unregisterChannelzRef=I,t.getChannelzHandlers=q;let W=null;function $(){if(W)return W;let e=(0,n(13716).J_)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return W=(0,l.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service}function H(){(0,o.registerAdminService)($,q)}t.getChannelzServiceDefinition=$,t.setup=H},61809:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInterceptingCall=t.InterceptingCall=t.RequesterBuilder=t.ListenerBuilder=t.InterceptorConfigurationError=void 0;let r=n(6281),i=n(41218),s=n(19572),a=n(96027);class o extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,o)}}t.InterceptorConfigurationError=o;class l{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}t.ListenerBuilder=l;class u{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}t.RequesterBuilder=u;let c={onReceiveMetadata:(e,t)=>{t(e)},onReceiveMessage:(e,t)=>{t(e)},onReceiveStatus:(e,t)=>{t(e)}},d={start:(e,t,n)=>{n(e,t)},sendMessage:(e,t)=>{t(e)},halfClose:e=>{e()},cancel:e=>{e()}};class h{constructor(e,t){var n,r,i,s;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:null!==(n=t.start)&&void 0!==n?n:d.start,sendMessage:null!==(r=t.sendMessage)&&void 0!==r?r:d.sendMessage,halfClose:null!==(i=t.halfClose)&&void 0!==i?i:d.halfClose,cancel:null!==(s=t.cancel)&&void 0!==s?s:d.cancel}:this.requester=d}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var n,r,s,a,o,l;let u={onReceiveMetadata:null!==(r=null===(n=null==t?void 0:t.onReceiveMetadata)||void 0===n?void 0:n.bind(t))&&void 0!==r?r:e=>{},onReceiveMessage:null!==(a=null===(s=null==t?void 0:t.onReceiveMessage)||void 0===s?void 0:s.bind(t))&&void 0!==a?a:e=>{},onReceiveStatus:null!==(l=null===(o=null==t?void 0:t.onReceiveStatus)||void 0===o?void 0:o.bind(t))&&void 0!==l?l:e=>{}};this.processingMetadata=!0,this.requester.start(e,u,(e,t)=>{var n,r,s;let a;if(this.processingMetadata=!1,(0,i.isInterceptingListener)(t))a=t;else{let e={onReceiveMetadata:null!==(n=t.onReceiveMetadata)&&void 0!==n?n:c.onReceiveMetadata,onReceiveMessage:null!==(r=t.onReceiveMessage)&&void 0!==r?r:c.onReceiveMessage,onReceiveStatus:null!==(s=t.onReceiveStatus)&&void 0!==s?s:c.onReceiveStatus};a=new i.InterceptingListenerImpl(e,u)}this.nextCall.start(e,a),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,n=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,n),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function f(e,t,n){var r,i;let s=null!==(r=n.deadline)&&void 0!==r?r:1/0,a=n.host,o=null!==(i=n.parent)&&void 0!==i?i:null,l=n.propagate_flags,u=n.credentials,c=e.createCall(t,s,a,o,l);return u&&c.setCredentials(u),c}t.InterceptingCall=h;class p{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let n;try{n=this.methodDefinition.requestSerialize(t)}catch(e){this.call.cancelWithStatus(s.Status.INTERNAL,`Request message serialization failure: ${(0,a.getErrorMessage)(e)}`);return}this.call.sendMessageWithContext(e,n)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let n=null;this.call.start(e,{onReceiveMetadata:e=>{var n;null===(n=null==t?void 0:t.onReceiveMetadata)||void 0===n||n.call(t,e)},onReceiveMessage:e=>{var i;let o;try{o=this.methodDefinition.responseDeserialize(e)}catch(e){n={code:s.Status.INTERNAL,details:`Response message parsing error: ${(0,a.getErrorMessage)(e)}`,metadata:new r.Metadata},this.call.cancelWithStatus(n.code,n.details);return}null===(i=null==t?void 0:t.onReceiveMessage)||void 0===i||i.call(t,o)},onReceiveStatus:e=>{var r,i;n?null===(r=null==t?void 0:t.onReceiveStatus)||void 0===r||r.call(t,n):null===(i=null==t?void 0:t.onReceiveStatus)||void 0===i||i.call(t,e)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class m extends p{constructor(e,t){super(e,t)}start(e,t){var n,r;let i=!1,s={onReceiveMetadata:null!==(r=null===(n=null==t?void 0:t.onReceiveMetadata)||void 0===n?void 0:n.bind(t))&&void 0!==r?r:e=>{},onReceiveMessage:e=>{var n;i=!0,null===(n=null==t?void 0:t.onReceiveMessage)||void 0===n||n.call(t,e)},onReceiveStatus:e=>{var n,r;i||null===(n=null==t?void 0:t.onReceiveMessage)||void 0===n||n.call(t,null),null===(r=null==t?void 0:t.onReceiveStatus)||void 0===r||r.call(t,e)}};super.start(e,s),this.call.startRead()}}class g extends p{}function y(e,t,n){let r=f(e,n.path,t);return n.responseStream?new g(r,n):new m(r,n)}function v(e,t,n,r){if(e.clientInterceptors.length>0&&e.clientInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(e.callInterceptors.length>0&&e.callInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];i=e.callInterceptors.length>0||e.callInterceptorProviders.length>0?[].concat(e.callInterceptors,e.callInterceptorProviders.map(e=>e(t))).filter(e=>e):[].concat(e.clientInterceptors,e.clientInterceptorProviders.map(e=>e(t))).filter(e=>e);let s=Object.assign({},n,{method_definition:t});return i.reduceRight((e,t)=>n=>t(n,e),e=>y(r,e,t))(s)}t.getInterceptingCall=v},91865:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;let r=n(7639),i=n(39452),s=n(72409),a=n(19572),o=n(6281),l=n(61809),u=Symbol(),c=Symbol(),d=Symbol(),h=Symbol();function f(e){return"function"==typeof e}function p(e){return e.stack.split("\n").slice(1).join("\n")}class m{constructor(e,t,n={}){var r,s;if(n=Object.assign({},n),this[c]=null!==(r=n.interceptors)&&void 0!==r?r:[],delete n.interceptors,this[d]=null!==(s=n.interceptor_providers)&&void 0!==s?s:[],delete n.interceptor_providers,this[c].length>0&&this[d].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[h]=n.callInvocationTransformer,delete n.callInvocationTransformer,n.channelOverride)this[u]=n.channelOverride;else if(n.channelFactoryOverride){let r=n.channelFactoryOverride;delete n.channelFactoryOverride,this[u]=r(e,t,n)}else this[u]=new i.ChannelImplementation(e,t,n)}close(){this[u].close()}getChannel(){return this[u]}waitForReady(e,t){let n=r=>{let i;if(r){t(Error("Failed to connect before the deadline"));return}try{i=this[u].getConnectivityState(!0)}catch(e){t(Error("The channel has been closed"));return}if(i===s.ConnectivityState.READY)t();else try{this[u].watchConnectivityState(i,e,n)}catch(e){t(Error("The channel has been closed"))}};setImmediate(n)}checkOptionalUnaryResponseArguments(e,t,n){if(f(e))return{metadata:new o.Metadata,options:{},callback:e};if(f(t))return e instanceof o.Metadata?{metadata:e,options:{},callback:t}:{metadata:new o.Metadata,options:e,callback:t};if(!(e instanceof o.Metadata&&t instanceof Object&&f(n)))throw Error("Incorrect arguments passed");return{metadata:e,options:t,callback:n}}makeUnaryRequest(e,t,n,i,s,o,f){var m,g;let y=this.checkOptionalUnaryResponseArguments(s,o,f),v={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:n},b={argument:i,metadata:y.metadata,call:new r.ClientUnaryCallImpl,channel:this[u],methodDefinition:v,callOptions:y.options,callback:y.callback};this[h]&&(b=this[h](b));let w=b.call,S={clientInterceptors:this[c],clientInterceptorProviders:this[d],callInterceptors:null!==(m=b.callOptions.interceptors)&&void 0!==m?m:[],callInterceptorProviders:null!==(g=b.callOptions.interceptor_providers)&&void 0!==g?g:[]},T=(0,l.getInterceptingCall)(S,b.methodDefinition,b.callOptions,b.channel);w.call=T;let C=null,E=!1,x=Error();return T.start(b.metadata,{onReceiveMetadata:e=>{w.emit("metadata",e)},onReceiveMessage(e){null!==C&&T.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),C=e},onReceiveStatus(e){if(!E){if(E=!0,e.code===a.Status.OK){if(null===C){let t=p(x);b.callback((0,r.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else b.callback(null,C)}else{let t=p(x);b.callback((0,r.callErrorFromStatus)(e,t))}x=null,w.emit("status",e)}}}),T.sendMessage(i),T.halfClose(),w}makeClientStreamRequest(e,t,n,i,s,o){var f,m;let g=this.checkOptionalUnaryResponseArguments(i,s,o),y={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:n},v={metadata:g.metadata,call:new r.ClientWritableStreamImpl(t),channel:this[u],methodDefinition:y,callOptions:g.options,callback:g.callback};this[h]&&(v=this[h](v));let b=v.call,w={clientInterceptors:this[c],clientInterceptorProviders:this[d],callInterceptors:null!==(f=v.callOptions.interceptors)&&void 0!==f?f:[],callInterceptorProviders:null!==(m=v.callOptions.interceptor_providers)&&void 0!==m?m:[]},S=(0,l.getInterceptingCall)(w,v.methodDefinition,v.callOptions,v.channel);b.call=S;let T=null,C=!1,E=Error();return S.start(v.metadata,{onReceiveMetadata:e=>{b.emit("metadata",e)},onReceiveMessage(e){null!==T&&S.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),T=e},onReceiveStatus(e){if(!C){if(C=!0,e.code===a.Status.OK){if(null===T){let t=p(E);v.callback((0,r.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else v.callback(null,T)}else{let t=p(E);v.callback((0,r.callErrorFromStatus)(e,t))}E=null,b.emit("status",e)}}}),b}checkMetadataAndOptions(e,t){let n,r;return e instanceof o.Metadata?(n=e,r=t||{}):(r=e||{},n=new o.Metadata),{metadata:n,options:r}}makeServerStreamRequest(e,t,n,i,s,o){var f,m;let g=this.checkMetadataAndOptions(s,o),y={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:n},v={argument:i,metadata:g.metadata,call:new r.ClientReadableStreamImpl(n),channel:this[u],methodDefinition:y,callOptions:g.options};this[h]&&(v=this[h](v));let b=v.call,w={clientInterceptors:this[c],clientInterceptorProviders:this[d],callInterceptors:null!==(f=v.callOptions.interceptors)&&void 0!==f?f:[],callInterceptorProviders:null!==(m=v.callOptions.interceptor_providers)&&void 0!==m?m:[]},S=(0,l.getInterceptingCall)(w,v.methodDefinition,v.callOptions,v.channel);b.call=S;let T=!1,C=Error();return S.start(v.metadata,{onReceiveMetadata(e){b.emit("metadata",e)},onReceiveMessage(e){b.push(e)},onReceiveStatus(e){if(!T){if(T=!0,b.push(null),e.code!==a.Status.OK){let t=p(C);b.emit("error",(0,r.callErrorFromStatus)(e,t))}C=null,b.emit("status",e)}}}),S.sendMessage(i),S.halfClose(),b}makeBidiStreamRequest(e,t,n,i,s){var o,f;let m=this.checkMetadataAndOptions(i,s),g={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:n},y={metadata:m.metadata,call:new r.ClientDuplexStreamImpl(t,n),channel:this[u],methodDefinition:g,callOptions:m.options};this[h]&&(y=this[h](y));let v=y.call,b={clientInterceptors:this[c],clientInterceptorProviders:this[d],callInterceptors:null!==(o=y.callOptions.interceptors)&&void 0!==o?o:[],callInterceptorProviders:null!==(f=y.callOptions.interceptor_providers)&&void 0!==f?f:[]},w=(0,l.getInterceptingCall)(b,y.methodDefinition,y.callOptions,y.channel);v.call=w;let S=!1,T=Error();return w.start(y.metadata,{onReceiveMetadata(e){v.emit("metadata",e)},onReceiveMessage(e){v.push(e)},onReceiveStatus(e){if(!S){if(S=!0,v.push(null),e.code!==a.Status.OK){let t=p(T);v.emit("error",(0,r.callErrorFromStatus)(e,t))}T=null,v.emit("status",e)}}}),v}}t.Client=m},74334:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompressionAlgorithms=void 0,function(e){e[e.identity=0]="identity",e[e.deflate=1]="deflate",e[e.gzip=2]="gzip"}(n||(t.CompressionAlgorithms=n={}))},16289:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompressionFilterFactory=t.CompressionFilter=void 0;let r=n(71568),i=n(74334),s=n(19572),a=n(53223),o=n(25792),l=e=>"number"==typeof e&&"string"==typeof i.CompressionAlgorithms[e];class u{async writeMessage(e,t){let n=e;t&&(n=await this.compressMessage(n));let r=Buffer.allocUnsafe(n.length+5);return r.writeUInt8(t?1:0,0),r.writeUInt32BE(n.length,1),n.copy(r,5),r}async readMessage(e){let t=1===e.readUInt8(0),n=e.slice(5);return t&&(n=await this.decompressMessage(n)),n}}class c extends u{async compressMessage(e){return e}async writeMessage(e,t){let n=Buffer.allocUnsafe(e.length+5);return n.writeUInt8(0,0),n.writeUInt32BE(e.length,1),e.copy(n,5),n}decompressMessage(e){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class d extends u{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,n)=>{r.deflate(e,(e,r)=>{e?n(e):t(r)})})}decompressMessage(e){return new Promise((t,n)=>{let i=0,a=[],o=r.createInflate();o.on("data",e=>{a.push(e),i+=e.byteLength,-1!==this.maxRecvMessageLength&&i>this.maxRecvMessageLength&&(o.destroy(),n({code:s.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(a))}),o.write(e),o.end()})}}class h extends u{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,n)=>{r.gzip(e,(e,r)=>{e?n(e):t(r)})})}decompressMessage(e){return new Promise((t,n)=>{let i=0,a=[],o=r.createGunzip();o.on("data",e=>{a.push(e),i+=e.byteLength,-1!==this.maxRecvMessageLength&&i>this.maxRecvMessageLength&&(o.destroy(),n({code:s.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(a))}),o.write(e),o.end()})}}class f extends u{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function p(e,t){switch(e){case"identity":return new c;case"deflate":return new d(t);case"gzip":return new h(t);default:return new f(e)}}class m extends a.BaseFilter{constructor(e,t){var n,r;super(),this.sharedFilterConfig=t,this.sendCompression=new c,this.receiveCompression=new c,this.currentCompressionAlgorithm="identity";let a=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!==(n=e["grpc.max_receive_message_length"])&&void 0!==n?n:s.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==a){if(l(a)){let e=i.CompressionAlgorithms[a],n=null===(r=t.serverSupportedEncodingHeader)||void 0===r?void 0:r.split(",");(!n||n.includes(e))&&(this.currentCompressionAlgorithm=e,this.sendCompression=p(this.currentCompressionAlgorithm,-1))}else o.log(s.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${a}`)}}async sendMetadata(e){let t=await e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let e=t[0];"string"==typeof e&&(this.receiveCompression=p(e,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let n=e.get("grpc-accept-encoding")[0];return n&&(this.sharedFilterConfig.serverSupportedEncodingHeader=n,n.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new c,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var t;let n;let r=await e;return n=!(this.sendCompression instanceof c)&&((null!==(t=r.flags)&&void 0!==t?t:0)&2)==0,{message:await this.sendCompression.writeMessage(r.message,n),flags:r.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}}t.CompressionFilter=m;class g{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new m(this.options,this.sharedFilterConfig)}}t.CompressionFilterFactory=g},72409:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectivityState=void 0,function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.READY=2]="READY",e[e.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",e[e.SHUTDOWN=4]="SHUTDOWN"}(n||(t.ConnectivityState=n={}))},19572:(e,t)=>{"use strict";var n,r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=t.Propagate=t.LogVerbosity=t.Status=void 0,function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(n||(t.Status=n={})),function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.ERROR=2]="ERROR",e[e.NONE=3]="NONE"}(r||(t.LogVerbosity=r={})),function(e){e[e.DEADLINE=1]="DEADLINE",e[e.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",e[e.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",e[e.CANCELLATION=8]="CANCELLATION",e[e.DEFAULTS=65535]="DEFAULTS"}(i||(t.Propagate=i={})),t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},55607:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restrictControlPlaneStatusCode=void 0;let r=n(19572),i=[r.Status.OK,r.Status.INVALID_ARGUMENT,r.Status.NOT_FOUND,r.Status.ALREADY_EXISTS,r.Status.FAILED_PRECONDITION,r.Status.ABORTED,r.Status.OUT_OF_RANGE,r.Status.DATA_LOSS];function s(e,t){return i.includes(e)?{code:r.Status.INTERNAL,details:`Invalid status from control plane: ${e} ${r.Status[e]} ${t}`}:{code:e,details:t}}t.restrictControlPlaneStatusCode=s},24771:(e,t)=>{"use strict";function n(...e){let t=1/0;for(let n of e){let e=n instanceof Date?n.getTime():n;e<t&&(t=e)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.deadlineToString=t.getRelativeTimeout=t.getDeadlineTimeoutString=t.minDeadline=void 0,t.minDeadline=n;let r=[["m",1],["S",1e3],["M",6e4],["H",36e5]];function i(e){let t=new Date().getTime();e instanceof Date&&(e=e.getTime());let n=Math.max(e-t,0);for(let[e,t]of r){let r=n/t;if(r<1e8)return String(Math.ceil(r))+e}throw Error("Deadline is too far in the future")}t.getDeadlineTimeoutString=i;let s=2147483647;function a(e){let t=(e instanceof Date?e.getTime():e)-new Date().getTime();return t<0?0:t>s?1/0:t}function o(e){if(e instanceof Date)return e.toISOString();{let t=new Date(e);return Number.isNaN(t.getTime())?""+e:t.toISOString()}}t.getRelativeTimeout=a,t.deadlineToString=o},87974:(e,t)=>{"use strict";function n(e){return{seconds:e/1e3|0,nanos:e%1e3*1e6|0}}function r(e){return 1e3*e.seconds+e.nanos/1e6|0}function i(e){return"number"==typeof e.seconds&&"number"==typeof e.nanos}Object.defineProperty(t,"__esModule",{value:!0}),t.isDuration=t.durationToMs=t.msToDuration=void 0,t.msToDuration=n,t.durationToMs=r,t.isDuration=i},96027:(e,t)=>{"use strict";function n(e){return e instanceof Error?e.message:String(e)}function r(e){return"object"==typeof e&&null!==e&&"code"in e&&"number"==typeof e.code?e.code:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorCode=t.getErrorMessage=void 0,t.getErrorMessage=n,t.getErrorCode=r},38779:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlierDetectionLoadBalancingConfig=t.BaseSubchannelWrapper=t.registerAdminService=t.FilterStackFactory=t.BaseFilter=t.PickResultType=t.QueuePicker=t.UnavailablePicker=t.ChildLoadBalancerHandler=t.subchannelAddressToString=t.validateLoadBalancingConfig=t.getFirstUsableConfig=t.registerLoadBalancerType=t.createChildChannelControlHelper=t.BackoffTimeout=t.durationToMs=t.uriToString=t.createResolver=t.registerResolver=t.log=t.trace=void 0;var r=n(25792);Object.defineProperty(t,"trace",{enumerable:!0,get:function(){return r.trace}}),Object.defineProperty(t,"log",{enumerable:!0,get:function(){return r.log}});var i=n(84063);Object.defineProperty(t,"registerResolver",{enumerable:!0,get:function(){return i.registerResolver}}),Object.defineProperty(t,"createResolver",{enumerable:!0,get:function(){return i.createResolver}});var s=n(55541);Object.defineProperty(t,"uriToString",{enumerable:!0,get:function(){return s.uriToString}});var a=n(87974);Object.defineProperty(t,"durationToMs",{enumerable:!0,get:function(){return a.durationToMs}});var o=n(1742);Object.defineProperty(t,"BackoffTimeout",{enumerable:!0,get:function(){return o.BackoffTimeout}});var l=n(69884);Object.defineProperty(t,"createChildChannelControlHelper",{enumerable:!0,get:function(){return l.createChildChannelControlHelper}}),Object.defineProperty(t,"registerLoadBalancerType",{enumerable:!0,get:function(){return l.registerLoadBalancerType}}),Object.defineProperty(t,"getFirstUsableConfig",{enumerable:!0,get:function(){return l.getFirstUsableConfig}}),Object.defineProperty(t,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return l.validateLoadBalancingConfig}});var u=n(74955);Object.defineProperty(t,"subchannelAddressToString",{enumerable:!0,get:function(){return u.subchannelAddressToString}});var c=n(56372);Object.defineProperty(t,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return c.ChildLoadBalancerHandler}});var d=n(2352);Object.defineProperty(t,"UnavailablePicker",{enumerable:!0,get:function(){return d.UnavailablePicker}}),Object.defineProperty(t,"QueuePicker",{enumerable:!0,get:function(){return d.QueuePicker}}),Object.defineProperty(t,"PickResultType",{enumerable:!0,get:function(){return d.PickResultType}});var h=n(53223);Object.defineProperty(t,"BaseFilter",{enumerable:!0,get:function(){return h.BaseFilter}});var f=n(59386);Object.defineProperty(t,"FilterStackFactory",{enumerable:!0,get:function(){return f.FilterStackFactory}});var p=n(27749);Object.defineProperty(t,"registerAdminService",{enumerable:!0,get:function(){return p.registerAdminService}});var m=n(40487);Object.defineProperty(t,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return m.BaseSubchannelWrapper}});var g=n(7542);Object.defineProperty(t,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return g.OutlierDetectionLoadBalancingConfig}})},59386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterStackFactory=t.FilterStack=void 0;class n{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMessage(t);return t}receiveMessage(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}}t.FilterStack=n;class r{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new r([...this.factories])}createFilter(){return new n(this.factories.map(e=>e.createFilter()))}}t.FilterStackFactory=r},53223:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseFilter=void 0;class n{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}}t.BaseFilter=n},85242:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProxiedConnection=t.mapProxyName=void 0;let r=n(25792),i=n(19572),s=n(84063),a=n(32615),o=n(82452),l=n(25792),u=n(74955),c=n(55541),d=n(17360),h=n(48501),f="proxy";function p(e){l.trace(i.LogVerbosity.DEBUG,f,e)}function m(){let e,t="",n="";if(process.env.grpc_proxy)n="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)n="https_proxy",t=process.env.https_proxy;else{if(!process.env.http_proxy)return{};n="http_proxy",t=process.env.http_proxy}try{e=new d.URL(t)}catch(e){return(0,r.log)(i.LogVerbosity.ERROR,`cannot parse value of "${n}" env var`),{}}if("http:"!==e.protocol)return(0,r.log)(i.LogVerbosity.ERROR,`"${e.protocol}" scheme not supported in proxy URI`),{};let s=null;e.username&&(e.password?((0,r.log)(i.LogVerbosity.INFO,"userinfo found in proxy URI"),s=`${e.username}:${e.password}`):s=e.username);let a=e.hostname,o=e.port;""===o&&(o="80");let l={address:`${a}:${o}`};return s&&(l.creds=s),p("Proxy server "+l.address+" set by environment variable "+n),l}function g(){let e=process.env.no_grpc_proxy,t="no_grpc_proxy";return(e||(e=process.env.no_proxy,t="no_proxy"),e)?(p("No proxy server list set by environment variable "+t),e.split(",")):[]}function y(e,t){var n;let r={target:e,extraOptions:{}};if((null!==(n=t["grpc.enable_http_proxy"])&&void 0!==n?n:1)===0||"unix"===e.scheme)return r;let i=m();if(!i.address)return r;let s=(0,c.splitHostPort)(e.path);if(!s)return r;let a=s.host;for(let t of g())if(t===a)return p("Not using proxy for target in no_proxy list: "+(0,c.uriToString)(e)),r;let o={"grpc.http_connect_target":(0,c.uriToString)(e)};return i.creds&&(o["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:o}}function v(e,t,n){var l;if(!("grpc.http_connect_target"in t))return Promise.resolve({});let d=t["grpc.http_connect_target"],f=(0,c.parseUri)(d);if(null===f)return Promise.resolve({});let m=(0,c.splitHostPort)(f.path);if(null===m)return Promise.resolve({});let g=`${m.host}:${null!==(l=m.port)&&void 0!==l?l:h.DEFAULT_PORT}`,y={method:"CONNECT",path:g},v={Host:g};(0,u.isTcpSubchannelAddress)(e)?(y.host=e.host,y.port=e.port):y.socketPath=e.path,"grpc.http_connect_creds"in t&&(v["Proxy-Authorization"]="Basic "+Buffer.from(t["grpc.http_connect_creds"]).toString("base64")),y.headers=v;let b=(0,u.subchannelAddressToString)(e);return p("Using proxy "+b+" to connect to "+y.path),new Promise((e,t)=>{let l=a.request(y);l.once("connect",(a,u,d)=>{var h;if(l.removeAllListeners(),u.removeAllListeners(),200===a.statusCode){if(p("Successfully connected to "+y.path+" through proxy "+b),"secureContext"in n){let r=(0,s.getDefaultAuthority)(f),i=(0,c.splitHostPort)(r),a=null!==(h=null==i?void 0:i.host)&&void 0!==h?h:r,l=o.connect(Object.assign({host:a,servername:a,socket:u},n),()=>{p("Successfully established a TLS connection to "+y.path+" through proxy "+b),e({socket:l,realTarget:f})});l.on("error",e=>{p("Failed to establish a TLS connection to "+y.path+" through proxy "+b+" with error "+e.message),t()})}else p("Successfully established a plaintext connection to "+y.path+" through proxy "+b),e({socket:u,realTarget:f})}else(0,r.log)(i.LogVerbosity.ERROR,"Failed to connect to "+y.path+" through proxy "+b+" with status "+a.statusCode),t()}),l.once("error",e=>{l.removeAllListeners(),(0,r.log)(i.LogVerbosity.ERROR,"Failed to connect to proxy "+b+" with error "+e.message),t()}),l.end()})}t.mapProxyName=y,t.getProxiedConnection=v},1968:(e,t,n)=>{"use strict";g={value:!0},g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=t.Rz=g=g=g=g=g=g=t.SF=t.K9=void 0;let r=n(45402);g={enumerable:!0,get:function(){return r.CallCredentials}};let i=n(39452);g={enumerable:!0,get:function(){return i.ChannelImplementation}};let s=n(74334);g={enumerable:!0,get:function(){return s.CompressionAlgorithms}};let a=n(72409);g={enumerable:!0,get:function(){return a.ConnectivityState}};let o=n(70499);g={enumerable:!0,get:function(){return o.ChannelCredentials}};let l=n(91865);g={enumerable:!0,get:function(){return l.Client}};let u=n(19572);g={enumerable:!0,get:function(){return u.LogVerbosity}},g={enumerable:!0,get:function(){return u.Status}},g={enumerable:!0,get:function(){return u.Propagate}};let c=n(25792),d=n(54529);Object.defineProperty(t,"Rz",{enumerable:!0,get:function(){return d.loadPackageDefinition}}),g={enumerable:!0,get:function(){return d.makeClientConstructor}},g={enumerable:!0,get:function(){return d.makeClientConstructor}};let h=n(6281);Object.defineProperty(t,"SF",{enumerable:!0,get:function(){return h.Metadata}});let f=n(66418);g={enumerable:!0,get:function(){return f.Server}};let p=n(43783);g={enumerable:!0,get:function(){return p.ServerCredentials}};let m=n(14339);g={enumerable:!0,get:function(){return m.StatusBuilder}},t.K9={combineChannelCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e),combineCallCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e),createInsecure:o.ChannelCredentials.createInsecure,createSsl:o.ChannelCredentials.createSsl,createFromSecureContext:o.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:r.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:r.CallCredentials.createFromGoogleCredential,createEmpty:r.CallCredentials.createEmpty},g=e=>e.close(),g=(e,t,n)=>e.waitForReady(t,n),g=(e,t)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},g=(e,t,n)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},g=e=>{c.setLogger(e)},g=e=>{c.setLoggerVerbosity(e)},g=e=>l.Client.prototype.getChannel.call(e);var g,y=n(61809);g={enumerable:!0,get:function(){return y.ListenerBuilder}},g={enumerable:!0,get:function(){return y.RequesterBuilder}},g={enumerable:!0,get:function(){return y.InterceptingCall}},g={enumerable:!0,get:function(){return y.InterceptorConfigurationError}};var v=n(65962);g={enumerable:!0,get:function(){return v.getChannelzServiceDefinition}},g={enumerable:!0,get:function(){return v.getChannelzHandlers}};var b=n(27749);g={enumerable:!0,get:function(){return b.addAdminServicesToServer}},g=n(38779);let w=n(48501),S=n(47255),T=n(63988),C=n(15102),E=n(14556),x=n(7542),_=n(65962);(()=>{w.setup(),S.setup(),T.setup(),C.setup(),E.setup(),x.setup(),_.setup()})()},29359:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalChannel=void 0;let r=n(70499),i=n(77661),s=n(87328),a=n(2352),o=n(19572),l=n(59386),u=n(16289),c=n(84063),d=n(25792),h=n(85242),f=n(55541),p=n(72409),m=n(65962),g=n(91690),y=n(24771),v=n(80080),b=n(21801),w=n(55607),S=n(25627),T=n(40487),C=2147483647,E=1e3,x=18e5,_=new Map,I=16777216,k=1048576;class D extends T.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(e,n,r,i)=>{t.throttleKeepalive(i)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class R{constructor(e,t,n){var g,y,v,b,T,R,N,A;if(this.credentials=t,this.options=n,this.connectivityState=p.ConnectivityState.IDLE,this.currentPicker=new a.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new m.ChannelzCallTracker,this.childrenTracker=new m.ChannelzChildrenTracker,"string"!=typeof e)throw TypeError("Channel target must be a string");if(!(t instanceof r.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(n&&"object"!=typeof n)throw TypeError("Channel options must be an object");this.originalTarget=e;let O=(0,f.parseUri)(e);if(null===O)throw Error(`Could not parse target name "${e}"`);let M=(0,c.mapUriDefaultScheme)(O);if(null===M)throw Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},C),null===(y=(g=this.callRefTimer).unref)||void 0===y||y.call(g),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new m.ChannelzTrace,this.channelzRef=(0,m.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,c.getDefaultAuthority)(M);let P=(0,h.mapProxyName)(M,n);this.target=P.target,this.options=Object.assign({},this.options,P.extraOptions),this.subchannelPool=(0,s.getSubchannelPool)((null!==(v=n["grpc.use_local_subchannel_pool"])&&void 0!==v?v:0)===0),this.retryBufferTracker=new S.MessageBufferTracker(null!==(b=n["grpc.retry_buffer_size"])&&void 0!==b?b:I,null!==(T=n["grpc.per_rpc_retry_buffer_size"])&&void 0!==T?T:k),this.keepaliveTime=null!==(R=n["grpc.keepalive_time_ms"])&&void 0!==R?R:-1,this.idleTimeoutMs=Math.max(null!==(N=n["grpc.client_idle_timeout_ms"])&&void 0!==N?N:x,E);let L={createSubchannel:(e,t)=>{let n=this.subchannelPool.getOrCreateSubchannel(this.target,e,Object.assign({},this.options,t),this.credentials);n.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",n.getChannelzRef());let r=new D(n,this);return this.wrappedSubchannels.add(r),r},updateState:(e,t)=>{this.currentPicker=t;let n=this.pickQueue.slice();for(let e of(this.pickQueue=[],n.length>0&&this.callRefTimerUnref(),n))e.doPick();this.updateState(e)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.refChild(e)},removeChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.unrefChild(e)}};this.resolvingLoadBalancer=new i.ResolvingLoadBalancer(this.target,L,n,(e,t)=>{e.retryThrottling?_.set(this.getTarget(),new S.RetryThrottler(e.retryThrottling.maxTokens,e.retryThrottling.tokenRatio,_.get(this.getTarget()))):_.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=t,this.currentResolutionError=null,process.nextTick(()=>{let e=this.configSelectionQueue;for(let t of(this.configSelectionQueue=[],e.length>0&&this.callRefTimerUnref(),e))t.getConfig()})},e=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+e.code+' and details "'+e.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,w.restrictControlPlaneStatusCode)(e.code,e.details)),{metadata:e.metadata}));let t=this.configSelectionQueue;for(let n of(this.configSelectionQueue=[],t.length>0&&this.callRefTimerUnref(),t))n.reportResolverError(e)}),this.filterStackFactory=new l.FilterStackFactory([new u.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(n,void 0,2));let B=Error();(0,d.trace)(o.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null===(A=B.stack)||void 0===A?void 0:A.substring(B.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,d.trace)(null!=t?t:o.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,f.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,n,r;(null===(t=(e=this.callRefTimer).hasRef)||void 0===t?void 0:t.call(e))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(r=(n=this.callRefTimer).ref)||void 0===r||r.call(n))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(t=(e=this.callRefTimer).unref)||void 0===t||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(t=>t===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){for(let t of((0,d.trace)(o.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,f.uriToString)(this.target)+" "+p.ConnectivityState[this.connectivityState]+" -> "+p.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+p.ConnectivityState[e]),this.connectivityState=e,this.connectivityStateWatchers.slice()))e!==t.currentState&&(t.timer&&clearTimeout(t.timer),this.removeConnectivityStateWatcher(t),t.callback());e!==p.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime)for(let t of(this.keepaliveTime=e,this.wrappedSubchannels))t.throttleKeepalive(e)}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(p.ConnectivityState.IDLE),this.currentPicker=new a.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,n;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let e=new Date().valueOf()-this.lastActivityTimestamp.valueOf();e>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-e)},e),null===(n=(t=this.idleTimer).unref)||void 0===n||n.call(t)}maybeStartIdleTimer(){this.connectivityState===p.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===o.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,n,r,i){let s=(0,b.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+s+'] method="'+t+'"'),new g.LoadBalancingCall(this,e,t,n,r,i,s)}createRetryingCall(e,t,n,r,i){let s=(0,b.getNextCallNumber)();return this.trace("createRetryingCall ["+s+'] method="'+t+'"'),new S.RetryingCall(this,e,t,n,r,i,s,this.retryBufferTracker,_.get(this.getTarget()))}createInnerCall(e,t,n,r,i){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(e,t,n,r,i):this.createRetryingCall(e,t,n,r,i)}createResolvingCall(e,t,n,r,i){let s=(0,b.getNextCallNumber)();this.trace("createResolvingCall ["+s+'] method="'+e+'", deadline='+(0,y.deadlineToString)(t));let a={deadline:t,flags:null!=i?i:o.Propagate.DEFAULTS,host:null!=n?n:this.defaultAuthority,parentCall:r},l=new v.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),s);return this.onCallStart(),l.addStatusWatcher(e=>{this.onCallEnd(e)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(p.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,m.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,f.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,n){if(this.connectivityState===p.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let r=null;if(t!==1/0){let e=t instanceof Date?t:new Date(t),s=new Date;if(t===-1/0||e<=s){process.nextTick(n,Error("Deadline passed without connectivity state change"));return}r=setTimeout(()=>{this.removeConnectivityStateWatcher(i),n(Error("Deadline passed without connectivity state change"))},e.getTime()-s.getTime())}let i={currentState:e,callback:n,timer:r};this.connectivityStateWatchers.push(i)}getChannelzRef(){return this.channelzRef}createCall(e,t,n,r,i){if("string"!=typeof e)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===p.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(e,t,n,r,i)}}t.InternalChannel=R},56372:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChildLoadBalancerHandler=void 0;let r=n(69884),i=n(72409),s="child_load_balancer_helper";class a{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(e){this.parent=e,this.child=null}createSubchannel(e,t){return this.parent.channelControlHelper.createSubchannel(e,t)}updateState(e,t){var n;if(this.calledByPendingChild()){if(e===i.ConnectivityState.CONNECTING)return;null===(n=this.parent.currentChild)||void 0===n||n.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(e,t)}requestReresolution(){var e;let t=null!==(e=this.parent.pendingChild)&&void 0!==e?e:this.parent.currentChild;this.child===t&&this.parent.channelControlHelper.requestReresolution()}setChild(e){this.child=e}addChannelzChild(e){this.parent.channelControlHelper.addChannelzChild(e)}removeChannelzChild(e){this.parent.channelControlHelper.removeChannelzChild(e)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,n){let i;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let e=new this.ChildPolicyHelper(this),n=(0,r.createLoadBalancer)(t,e);e.setChild(n),null===this.currentChild?(this.currentChild=n,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=n,i=this.pendingChild)}else i=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=t,i.updateAddressList(e,t,n)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return s}}t.ChildLoadBalancerHandler=a},7542:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.OutlierDetectionLoadBalancer=t.OutlierDetectionLoadBalancingConfig=void 0;let i=n(72409),s=n(19572),a=n(87974),o=n(38779),l=n(69884),u=n(56372),c=n(2352),d=n(74955),h=n(40487),f=n(25792),p="outlier_detection";function m(e){f.trace(s.LogVerbosity.DEBUG,p,e)}let g="outlier_detection",y=(null!==(r=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)&&void 0!==r?r:"true")==="true",v={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},b={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function w(e,t,n,r){if(t in e&&typeof e[t]!==n){let i=r?`${r}.${t}`:t;throw Error(`outlier detection config ${i} parse error: expected ${n}, got ${typeof e[t]}`)}}function S(e,t,n){let r=n?`${n}.${t}`:t;if(t in e){if(!(0,a.isDuration)(e[t]))throw Error(`outlier detection config ${r} parse error: expected Duration, got ${typeof e[t]}`);if(!(e[t].seconds>=0&&e[t].seconds<=315576e6&&e[t].nanos>=0&&e[t].nanos<=999999999))throw Error(`outlier detection config ${r} parse error: values out of range for non-negative Duaration`)}}function T(e,t,n){let r=n?`${n}.${t}`:t;if(w(e,t,"number",n),t in e&&!(e[t]>=0&&e[t]<=100))throw Error(`outlier detection config ${r} parse error: value out of range for percentage (0-100)`)}class C{constructor(e,t,n,r,i,s,a){if(this.childPolicy=a,a.length>0&&"pick_first"===a[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=e?e:1e4,this.baseEjectionTimeMs=null!=t?t:3e4,this.maxEjectionTimeMs=null!=n?n:3e5,this.maxEjectionPercent=null!=r?r:10,this.successRateEjection=i?Object.assign(Object.assign({},v),i):null,this.failurePercentageEjection=s?Object.assign(Object.assign({},b),s):null}getLoadBalancerName(){return g}toJsonObject(){return{interval:(0,a.msToDuration)(this.intervalMs),base_ejection_time:(0,a.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,a.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new C(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(S(e,"interval"),S(e,"base_ejection_time"),S(e,"max_ejection_time"),T(e,"max_ejection_percent"),"success_rate_ejection"in e){if("object"!=typeof e.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");w(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),T(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),w(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),w(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if("object"!=typeof e.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");T(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),T(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),w(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),w(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new C(e.interval?(0,a.durationToMs)(e.interval):null,e.base_ejection_time?(0,a.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,a.durationToMs)(e.max_ejection_time):null,null!==(t=e.max_ejection_percent)&&void 0!==t?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(l.validateLoadBalancingConfig))}}t.OutlierDetectionLoadBalancingConfig=C;class E extends h.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((e,t,n,r)=>{if(this.childSubchannelState=n,!this.ejected)for(let e of this.stateListeners)e(this,t,n,r)})}getConnectivityState(){return this.ejected?i.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){for(let e of(this.ejected=!0,this.stateListeners))e(this,this.childSubchannelState,i.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let e of(this.ejected=!1,this.stateListeners))e(this,i.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function x(){return{success:0,failure:0}}class _{constructor(){this.activeBucket=x(),this.inactiveBucket=x()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=x()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class I{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType!==c.PickResultType.COMPLETE)return t;{let e=t.subchannel,n=e.getMapEntry();if(!n)return Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel()});{let r=t.onCallEnded;return this.countCalls&&(r=e=>{var r;e===s.Status.OK?n.counter.addSuccess():n.counter.addFailure(),null===(r=t.onCallEnded)||void 0===r||r.call(t,e)}),Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel(),onCallEnded:r})}}}}class k{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new u.ChildLoadBalancerHandler((0,o.createChildChannelControlHelper)(e,{createSubchannel:(t,n)=>{let r=e.createSubchannel(t,n),i=this.addressMap.get((0,d.subchannelAddressToString)(t)),s=new E(r,i);return(null==i?void 0:i.currentEjectionTimestamp)!==null&&s.eject(),null==i||i.subchannelWrappers.push(s),s},updateState:(t,n)=>{t===i.ConnectivityState.READY?e.updateState(t,new I(n,this.isCountingEnabled())):e.updateState(t,n)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())null!==t.currentEjectionTimestamp&&(e+=1);return 100*e/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;m("Running success rate check");let n=t.request_volume,r=0,i=[];for(let[e,t]of this.addressMap){let s=t.counter.getLastSuccesses(),a=t.counter.getLastFailures();m("Stats for "+e+": successes="+s+" failures="+a+" targetRequestVolume="+n),s+a>=n&&(r+=1,i.push(s/(s+a)))}if(m("Found "+r+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+i+"]"),r<t.minimum_hosts)return;let s=i.reduce((e,t)=>e+t)/i.length,a=0;for(let e of i){let t=e-s;a+=t*t}let o=Math.sqrt(a/i.length),l=s-t.stdev_factor/1e3*o;for(let[r,i]of(m("stdev="+o+" ejectionThreshold="+l),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let s=i.counter.getLastSuccesses(),a=i.counter.getLastFailures();if(s+a<n)continue;let o=s/(s+a);if(m("Checking candidate "+r+" successRate="+o),o<l){let n=100*Math.random();m("Candidate "+r+" randomNumber="+n+" enforcement_percentage="+t.enforcement_percentage),n<t.enforcement_percentage&&(m("Ejecting candidate "+r),this.eject(i,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;m("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let n=0;for(let e of this.addressMap.values())e.counter.getLastSuccesses()+e.counter.getLastFailures()>=t.request_volume&&(n+=1);if(!(n<t.minimum_hosts))for(let[n,r]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let i=r.counter.getLastSuccesses(),s=r.counter.getLastFailures();if(m("Candidate successes="+i+" failures="+s),!(i+s<t.request_volume)&&100*s/(s+i)>t.threshold){let i=100*Math.random();m("Candidate "+n+" randomNumber="+i+" enforcement_percentage="+t.enforcement_percentage),i<t.enforcement_percentage&&(m("Ejecting candidate "+n),this.eject(r,e))}}}eject(e,t){for(let t of(e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1,e.subchannelWrappers))t.eject()}uneject(e){for(let t of(e.currentEjectionTimestamp=null,e.subchannelWrappers))t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,n;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),null===(n=(t=this.ejectionTimer).unref)||void 0===n||n.call(t)}runChecks(){let e=new Date;if(m("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[t,n]of(this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e),this.addressMap.entries()))if(null===n.currentEjectionTimestamp)n.ejectionTimeMultiplier>0&&(n.ejectionTimeMultiplier-=1);else{let e=this.latestConfig.getBaseEjectionTimeMs(),r=this.latestConfig.getMaxEjectionTimeMs(),i=new Date(n.currentEjectionTimestamp.getTime());i.setMilliseconds(i.getMilliseconds()+Math.min(e*n.ejectionTimeMultiplier,Math.max(e,r))),i<new Date&&(m("Unejecting "+t),this.uneject(n))}}updateAddressList(e,t,n){if(!(t instanceof C))return;let r=new Set;for(let t of e)r.add((0,d.subchannelAddressToString)(t));for(let e of r)this.addressMap.has(e)||(m("Adding map entry for "+e),this.addressMap.set(e,{counter:new _,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let e of this.addressMap.keys())r.has(e)||(m("Removing map entry for "+e),this.addressMap.delete(e));let i=(0,l.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,i,n),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig()){if(this.timerStartTime){m("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let e=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(e)}else m("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets()}else for(let e of(m("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(e),e.ejectionTimeMultiplier=0;this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return g}}function D(){y&&(0,o.registerLoadBalancerType)(g,k,C)}t.OutlierDetectionLoadBalancer=k,t.setup=D},15102:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.PickFirstLoadBalancer=t.shuffled=t.PickFirstLoadBalancingConfig=void 0;let r=n(69884),i=n(72409),s=n(2352),a=n(25792),o=n(19572),l="pick_first";function u(e){a.trace(o.LogVerbosity.DEBUG,l,e)}let c="pick_first",d=250;class h{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return c}toJsonObject(){return{[c]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&"boolean"!=typeof e.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new h(!0===e.shuffleAddressList)}}t.PickFirstLoadBalancingConfig=h;class f{constructor(e){this.subchannel=e}pick(e){return{pickResultType:s.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function p(e){let t=e.slice();for(let e=t.length-1;e>1;e--){let n=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}return t}t.shuffled=p;class m{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=i.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(e,t,n,r,i)=>{this.onSubchannelStateUpdate(e,t,n,i)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(i.ConnectivityState.READY,new f(this.currentPick)):0===this.children.length?this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:e}of(this.stickyTransientFailureMode=!0,this.children))e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,n,r){var s;if(null===(s=this.currentPick)||void 0===s?void 0:s.realSubchannelEquals(e)){n!==i.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[t,s]of this.children.entries())if(e.realSubchannelEquals(s.subchannel)){n===i.ConnectivityState.READY&&this.pickSubchannel(s.subchannel),n===i.ConnectivityState.TRANSIENT_FAILURE&&(s.hasReportedTransientFailure=!0,r&&(this.lastError=r),this.maybeEnterStickyTransientFailureMode(),t===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(t+1)),s.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,n]of this.children.entries())if(t>=e){let e=n.subchannel.getConnectivityState();if(e===i.ConnectivityState.IDLE||e===i.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,n;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===i.ConnectivityState.IDLE&&(u("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var t;null===(t=this.children[e])||void 0===t||t.subchannel.startConnecting()})),this.connectionDelayTimeout=null===(n=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},d)).unref)||void 0===n?void 0:n.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(u("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){u(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(e=>({subchannel:this.channelControlHelper.createSubchannel(e,{}),hasReportedTransientFailure:!1}));for(let{subchannel:e}of t)e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef());for(let{subchannel:e}of(this.resetSubchannelList(),this.children=t,this.children))if(e.addConnectivityStateListener(this.subchannelStateListener),e.getConnectivityState()===i.ConnectivityState.READY){this.pickSubchannel(e);return}for(let e of this.children)e.subchannel.getConnectivityState()===i.ConnectivityState.TRANSIENT_FAILURE&&(e.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof h&&(t.getShuffleAddressList()&&(e=p(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===i.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return c}}function g(){(0,r.registerLoadBalancerType)(c,m,h),(0,r.registerDefaultLoadBalancerType)(c)}t.PickFirstLoadBalancer=m,t.setup=g},14556:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.RoundRobinLoadBalancer=void 0;let r=n(69884),i=n(72409),s=n(2352),a=n(74955),o=n(25792),l=n(19572),u="round_robin";function c(e){o.trace(l.LogVerbosity.DEBUG,u,e)}let d="round_robin";class h{getLoadBalancerName(){return d}constructor(){}toJsonObject(){return{[d]:{}}}static createFromJson(e){return new h}}class f{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:s.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class p{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=i.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(e,t,n,r,s)=>{this.calculateAndUpdateState(),(n===i.ConnectivityState.TRANSIENT_FAILURE||n===i.ConnectivityState.IDLE)&&(s&&(this.lastError=s),this.channelControlHelper.requestReresolution(),e.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(i.ConnectivityState.READY)>0){let e=this.subchannels.filter(e=>e.getConnectivityState()===i.ConnectivityState.READY),t=0;null!==this.currentReadyPicker&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(t=0),this.updateState(i.ConnectivityState.READY,new f(e,t))}else this.countSubchannelsWithState(i.ConnectivityState.CONNECTING)>0?this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this)):this.countSubchannelsWithState(i.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this))}updateState(e,t){c(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]),e===i.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){for(let t of(this.resetSubchannelList(),c("Connect to address list "+e.map(e=>(0,a.subchannelAddressToString)(e))),this.subchannels=e.map(e=>this.channelControlHelper.createSubchannel(e,{})),this.subchannels)){t.ref(),t.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(t.getChannelzRef());let e=t.getConnectivityState();(e===i.ConnectivityState.IDLE||e===i.ConnectivityState.TRANSIENT_FAILURE)&&t.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return d}}function m(){(0,r.registerLoadBalancerType)(d,p,h)}t.RoundRobinLoadBalancer=p,t.setup=m},69884:(e,t)=>{"use strict";function n(e,t){var n,r,i,s,a,o,l,u,c,d;return{createSubchannel:null!==(r=null===(n=t.createSubchannel)||void 0===n?void 0:n.bind(t))&&void 0!==r?r:e.createSubchannel.bind(e),updateState:null!==(s=null===(i=t.updateState)||void 0===i?void 0:i.bind(t))&&void 0!==s?s:e.updateState.bind(e),requestReresolution:null!==(o=null===(a=t.requestReresolution)||void 0===a?void 0:a.bind(t))&&void 0!==o?o:e.requestReresolution.bind(e),addChannelzChild:null!==(u=null===(l=t.addChannelzChild)||void 0===l?void 0:l.bind(t))&&void 0!==u?u:e.addChannelzChild.bind(e),removeChannelzChild:null!==(d=null===(c=t.removeChannelzChild)||void 0===c?void 0:c.bind(t))&&void 0!==d?d:e.removeChannelzChild.bind(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.validateLoadBalancingConfig=t.getFirstUsableConfig=t.isLoadBalancerNameRegistered=t.createLoadBalancer=t.registerDefaultLoadBalancerType=t.registerLoadBalancerType=t.createChildChannelControlHelper=void 0,t.createChildChannelControlHelper=n;let r={},i=null;function s(e,t,n){r[e]={LoadBalancer:t,LoadBalancingConfig:n}}function a(e){i=e}function o(e,t){let n=e.getLoadBalancerName();return n in r?new r[n].LoadBalancer(t):null}function l(e){return e in r}function u(e,t=!1){for(let t of e)if(t.getLoadBalancerName() in r)return t;return t&&i?new r[i].LoadBalancingConfig:null}function c(e){if(!(null!==e&&"object"==typeof e))throw Error("Load balancing config must be an object");let t=Object.keys(e);if(1!==t.length)throw Error("Provided load balancing config has multiple conflicting entries");let n=t[0];if(n in r)return r[n].LoadBalancingConfig.createFromJson(e[n]);throw Error(`Unrecognized load balancing config name ${n}`)}t.registerLoadBalancerType=s,t.registerDefaultLoadBalancerType=a,t.createLoadBalancer=o,t.isLoadBalancerNameRegistered=l,t.getFirstUsableConfig=u,t.validateLoadBalancingConfig=c},91690:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadBalancingCall=void 0;let r=n(72409),i=n(19572),s=n(24771),a=n(6281),o=n(2352),l=n(55541),u=n(25792),c=n(55607),d=n(32694),h="load_balancing_call";class f{constructor(e,t,n,r,i,s,a){var o,u;this.channel=e,this.callConfig=t,this.methodName=n,this.host=r,this.credentials=i,this.deadline=s,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let c=this.methodName.split("/"),d="";c.length>=2&&(d=c[1]);let h=null!==(u=null===(o=(0,l.splitHostPort)(this.host))||void 0===o?void 0:o.host)&&void 0!==u?u:"localhost";this.serviceUrl=`https://${h}/${d}`}trace(e){u.trace(i.LogVerbosity.DEBUG,h,"["+this.callNumber+"] "+e)}outputStatus(e,t){var n,r;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let i=Object.assign(Object.assign({},e),{progress:t});null===(n=this.listener)||void 0===n||n.onReceiveStatus(i),null===(r=this.onCallEnded)||void 0===r||r.call(this,i.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let n=this.channel.doPick(this.metadata,this.callConfig.pickInformation),l=n.subchannel?"("+n.subchannel.getChannelzRef().id+") "+n.subchannel.getAddress():""+n.subchannel;switch(this.trace("Pick result: "+o.PickResultType[n.pickResultType]+" subchannel: "+l+" status: "+(null===(e=n.status)||void 0===e?void 0:e.code)+" "+(null===(t=n.status)||void 0===t?void 0:t.details)),n.pickResultType){case o.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(e=>{var t,o,u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let c=this.metadata.clone();if(c.merge(e),c.get("authorization").length>1&&this.outputStatus({code:i.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new a.Metadata},"PROCESSED"),n.subchannel.getConnectivityState()!==r.ConnectivityState.READY){this.trace("Picked subchannel "+l+" has state "+r.ConnectivityState[n.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&c.set("grpc-timeout",(0,s.getDeadlineTimeoutString)(this.deadline));try{this.child=n.subchannel.getRealSubchannel().createCall(c,this.host,this.methodName,{onReceiveMetadata:e=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(e)},onReceiveMessage:e=>{this.trace("Received message"),this.listener.onReceiveMessage(e)},onReceiveStatus:e=>{this.trace("Received status"),e.rstCode===d.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(e,"REFUSED"):this.outputStatus(e,"PROCESSED")}})}catch(e){this.trace("Failed to start call on picked subchannel "+l+" with error "+e.message),this.outputStatus({code:i.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+e.message,metadata:new a.Metadata},"NOT_STARTED");return}null===(o=(t=this.callConfig).onCommitted)||void 0===o||o.call(t),null===(u=n.onCallStarted)||void 0===u||u.call(n),this.onCallEnded=n.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},e=>{let{code:t,details:n}=(0,c.restrictControlPlaneStatusCode)("number"==typeof e.code?e.code:i.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${e.message}`);this.outputStatus({code:t,details:n,metadata:new a.Metadata},"PROCESSED")});break;case o.PickResultType.DROP:let{code:u,details:h}=(0,c.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:u,details:h,metadata:n.status.metadata},"DROP")});break;case o.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:e,details:t}=(0,c.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:e,details:t,metadata:n.status.metadata},"PROCESSED")})}break;case o.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var n;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null===(n=this.child)||void 0===n||n.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new a.Metadata},"PROCESSED")}getPeer(){var e,t;return null!==(t=null===(e=this.child)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}t.LoadBalancingCall=f},25792:(e,t,n)=>{"use strict";var r,i,s,a;Object.defineProperty(t,"__esModule",{value:!0}),t.isTracerEnabled=t.trace=t.log=t.setLoggerVerbosity=t.setLogger=t.getLogger=void 0;let o=n(19572),l=n(35816),u=n(81513).i8,c={error:(e,...t)=>{console.error("E "+e,...t)},info:(e,...t)=>{console.error("I "+e,...t)},debug:(e,...t)=>{console.error("D "+e,...t)}},d=o.LogVerbosity.ERROR;switch((null!==(i=null!==(r=process.env.GRPC_NODE_VERBOSITY)&&void 0!==r?r:process.env.GRPC_VERBOSITY)&&void 0!==i?i:"").toUpperCase()){case"DEBUG":d=o.LogVerbosity.DEBUG;break;case"INFO":d=o.LogVerbosity.INFO;break;case"ERROR":d=o.LogVerbosity.ERROR;break;case"NONE":d=o.LogVerbosity.NONE}let h=()=>c;t.getLogger=h;let f=e=>{c=e};t.setLogger=f;let p=e=>{d=e};t.setLoggerVerbosity=p;let m=(e,...t)=>{let n;if(e>=d){switch(e){case o.LogVerbosity.DEBUG:n=c.debug;break;case o.LogVerbosity.INFO:n=c.info;break;case o.LogVerbosity.ERROR:n=c.error}n||(n=c.error),n&&n.bind(c)(...t)}};t.log=m;let g=null!==(a=null!==(s=process.env.GRPC_NODE_TRACE)&&void 0!==s?s:process.env.GRPC_TRACE)&&void 0!==a?a:"",y=new Set,v=new Set;for(let e of g.split(","))e.startsWith("-")?v.add(e.substring(1)):y.add(e);let b=y.has("all");function w(e,n,r){S(n)&&(0,t.log)(e,new Date().toISOString()+" | v"+u+" "+l.pid+" | "+n+" | "+r)}function S(e){return!v.has(e)&&(b||y.has(e))}t.trace=w,t.isTracerEnabled=S},54529:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPackageDefinition=t.makeClientConstructor=void 0;let r=n(91865),i={unary:r.Client.prototype.makeUnaryRequest,server_stream:r.Client.prototype.makeServerStreamRequest,client_stream:r.Client.prototype.makeClientStreamRequest,bidi:r.Client.prototype.makeBidiStreamRequest};function s(e){return["__proto__","prototype","constructor"].includes(e)}function a(e,t,n){n||(n={});class a extends r.Client{}return Object.keys(e).forEach(t=>{let n;if(s(t))return;let r=e[t];if("string"==typeof t&&"$"===t.charAt(0))throw Error("Method names cannot start with $");n=r.requestStream?r.responseStream?"bidi":"client_stream":r.responseStream?"server_stream":"unary";let l=r.requestSerialize,u=r.responseDeserialize,c=o(i[n],r.path,l,u);a.prototype[t]=c,Object.assign(a.prototype[t],r),r.originalName&&!s(r.originalName)&&(a.prototype[r.originalName]=a.prototype[t])}),a.service=e,a.serviceName=t,a}function o(e,t,n,r){return function(...i){return e.call(this,t,n,r,...i)}}function l(e){return"format"in e}function u(e){let t={};for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n],i=n.split(".");if(i.some(e=>s(e)))continue;let o=i[i.length-1],u=t;for(let e of i.slice(0,-1))u[e]||(u[e]={}),u=u[e];l(r)?u[o]=r:u[o]=a(r,o,{})}return t}t.makeClientConstructor=a,t.loadPackageDefinition=u},6281:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;let r=n(25792),i=n(19572),s=n(96027),a=/^[0-9a-z_.-]+$/,o=/^[ -~]*$/;function l(e){return a.test(e)}function u(e){return o.test(e)}function c(e){return e.endsWith("-bin")}function d(e){return!e.startsWith("grpc-")}function h(e){return e.toLowerCase()}function f(e,t){if(!l(e))throw Error('Metadata key "'+e+'" contains illegal characters');if(null!=t){if(c(e)){if(!Buffer.isBuffer(t))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(t))throw Error("keys that don't end with '-bin' must have String values");if(!u(t))throw Error('Metadata string value "'+t+'" contains illegal characters')}}}class p{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){f(e=h(e),t),this.internalRepr.set(e,[t])}add(e,t){f(e=h(e),t);let n=this.internalRepr.get(e);void 0===n?this.internalRepr.set(e,[t]):n.push(t)}remove(e){e=h(e),this.internalRepr.delete(e)}get(e){return e=h(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,n]of this.internalRepr)if(n.length>0){let r=n[0];e[t]=Buffer.isBuffer(r)?Buffer.from(r):r}return e}clone(){let e=new p(this.options),t=e.internalRepr;for(let[e,n]of this.internalRepr){let r=n.map(e=>Buffer.isBuffer(e)?Buffer.from(e):e);t.set(e,r)}return e}merge(e){for(let[t,n]of e.internalRepr){let e=(this.internalRepr.get(t)||[]).concat(n);this.internalRepr.set(t,e)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,n]of this.internalRepr)e[t]=n.map(m);return e}toJSON(){let e={};for(let[t,n]of this.internalRepr)e[t]=n;return e}static fromHttp2Headers(e){let t=new p;for(let n of Object.keys(e)){if(":"===n.charAt(0))continue;let a=e[n];try{c(n)?Array.isArray(a)?a.forEach(e=>{t.add(n,Buffer.from(e,"base64"))}):void 0!==a&&(d(n)?a.split(",").forEach(e=>{t.add(n,Buffer.from(e.trim(),"base64"))}):t.add(n,Buffer.from(a,"base64"))):Array.isArray(a)?a.forEach(e=>{t.add(n,e)}):void 0!==a&&t.add(n,a)}catch(t){let e=`Failed to add metadata entry ${n}: ${a}. ${(0,s.getErrorMessage)(t)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,r.log)(i.LogVerbosity.ERROR,e)}}return t}}t.Metadata=p;let m=e=>Buffer.isBuffer(e)?e.toString("base64"):e},2352:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.QueuePicker=t.UnavailablePicker=t.PickResultType=void 0;let i=n(6281),s=n(19572);!function(e){e[e.COMPLETE=0]="COMPLETE",e[e.QUEUE=1]="QUEUE",e[e.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",e[e.DROP=3]="DROP"}(r||(t.PickResultType=r={}));class a{constructor(e){this.status=Object.assign({code:s.Status.UNAVAILABLE,details:"No connection established",metadata:new i.Metadata},e)}pick(e){return{pickResultType:r.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}t.UnavailablePicker=a;class o{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:r.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}t.QueuePicker=o},48501:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.DEFAULT_PORT=void 0;let r=n(84063),i=n(80665),s=n(21764),a=n(94298),o=n(19572),l=n(6281),u=n(25792),c=n(19572),d=n(55541),h=n(98216),f=n(1742),p="dns_resolver";function m(e){u.trace(c.LogVerbosity.DEBUG,p,e)}t.DEFAULT_PORT=443;let g=3e4,y=s.promisify(i.resolveTxt),v=s.promisify(i.lookup);function b(...e){let t=[];for(let n=0;n<Math.max.apply(null,e.map(e=>e.length));n++)for(let r of e)n<r.length&&t.push(r[n]);return t}class w{constructor(e,n,r){var i,s,a;this.target=e,this.listener=n,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,m("Resolver constructed for target "+(0,d.uriToString)(e));let u=(0,d.splitHostPort)(e.path);null===u?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,h.isIPv4)(u.host)||(0,h.isIPv6)(u.host)?(this.ipResult=[{host:u.host,port:null!==(i=u.port)&&void 0!==i?i:t.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=u.host,this.port=null!==(s=u.port)&&void 0!==s?s:t.DEFAULT_PORT),this.percentage=100*Math.random(),1===r["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:o.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,d.uriToString)(this.target)}`,metadata:new l.Metadata};let c={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoff=new f.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},c),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!==(a=r["grpc.dns_min_time_between_resolutions_ms"])&&void 0!==a?a:g,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(m("Returning IP address for target "+(0,d.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)m("Failed to parse DNS address "+(0,d.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:o.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,d.uriToString)(this.target)}`,metadata:new l.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;m("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=v(e,{all:!0}),this.pendingLookupPromise.then(e=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let t=e.filter(e=>4===e.family),n=e.filter(e=>6===e.family);this.latestLookupResult=b(n,t).map(e=>({host:e.address,port:+this.port}));let r="["+this.latestLookupResult.map(e=>e.host+":"+e.port).join(",")+"]";if(m("Resolved addresses for target "+(0,d.uriToString)(this.target)+": "+r),0===this.latestLookupResult.length){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},e=>{null!==this.pendingLookupPromise&&(m("Resolution error for target "+(0,d.uriToString)(this.target)+": "+e.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=y(e),this.pendingTxtPromise.then(e=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,a.extractAndSelectServiceConfig)(e,this.percentage)}catch(e){this.latestServiceConfigError={code:o.Status.UNAVAILABLE,details:`Parsing service config failed with error ${e.message}`,metadata:new l.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},e=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null===(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)||void 0===t?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?m('resolution update delayed by "min time between resolutions" rate limit'):m("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}}function S(){(0,r.registerResolver)("dns",w),(0,r.registerDefaultScheme)("dns")}t.setup=S},63988:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;let r=n(98216),i=n(19572),s=n(6281),a=n(84063),o=n(55541),l=n(25792),u="ip_resolver";function c(e){l.trace(i.LogVerbosity.DEBUG,u,e)}let d="ipv4",h="ipv6",f=443;class p{constructor(e,t,n){var a;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,c("Resolver constructed for target "+(0,o.uriToString)(e));let l=[];if(!(e.scheme===d||e.scheme===h)){this.error={code:i.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new s.Metadata};return}for(let t of e.path.split(",")){let n=(0,o.splitHostPort)(t);if(null===n||e.scheme===d&&!(0,r.isIPv4)(n.host)||e.scheme===h&&!(0,r.isIPv6)(n.host)){this.error={code:i.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new s.Metadata};return}l.push({host:n.host,port:null!==(a=n.port)&&void 0!==a?a:f})}this.addresses=l,c("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}}function m(){(0,a.registerResolver)(d,p),(0,a.registerResolver)(h,p)}t.setup=m},47255:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;let r=n(84063);class i{constructor(e,t,n){let r;this.listener=t,this.addresses=[],this.hasReturnedResult=!1,r=""===e.authority?"/"+e.path:e.path,this.addresses=[{path:r}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}}function s(){(0,r.registerResolver)("unix",i)}t.setup=s},84063:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapUriDefaultScheme=t.getDefaultAuthority=t.createResolver=t.registerDefaultScheme=t.registerResolver=void 0;let r=n(55541),i={},s=null;function a(e,t){i[e]=t}function o(e){s=e}function l(e,t,n){if(void 0!==e.scheme&&e.scheme in i)return new i[e.scheme](e,t,n);throw Error(`No resolver could be created for target ${(0,r.uriToString)(e)}`)}function u(e){if(void 0!==e.scheme&&e.scheme in i)return i[e.scheme].getDefaultAuthority(e);throw Error(`Invalid target ${(0,r.uriToString)(e)}`)}function c(e){return void 0!==e.scheme&&e.scheme in i?e:null!==s?{scheme:s,authority:void 0,path:(0,r.uriToString)(e)}:null}t.registerResolver=a,t.registerDefaultScheme=o,t.createResolver=l,t.getDefaultAuthority=u,t.mapUriDefaultScheme=c},80080:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvingCall=void 0;let r=n(19572),i=n(24771),s=n(6281),a=n(25792),o=n(55607),l="resolving_call";class u{constructor(e,t,n,s,a,o){this.channel=e,this.method=t,this.filterStackFactory=s,this.credentials=a,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=n.deadline,this.host=n.host,n.parentCall&&(n.flags&r.Propagate.CANCELLATION&&n.parentCall.on("cancelled",()=>{this.cancelWithStatus(r.Status.CANCELLED,"Cancelled by parent call")}),n.flags&r.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+n.parentCall.getDeadline()),this.deadline=(0,i.minDeadline)(this.deadline,n.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){a.trace(r.LogVerbosity.DEBUG,l,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,i.deadlineToString)(this.deadline));let e=(0,i.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(r.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(e=>e(t)),process.nextTick(()=>{var e;null===(e=this.listener)||void 0===e||e.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw Error("sendMessageonChild called with child not populated");let n=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(t=>{this.writeFilterPending=!1,n.sendMessageWithContext(e,t.message),this.pendingHalfClose&&n.halfClose()},e=>{this.cancelWithStatus(e.code,e.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if("NONE"===e.type){this.channel.queueCallForConfig(this);return}if("ERROR"===e.type){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==r.Status.OK){let{code:e,details:n}=(0,o.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:e,details:n,metadata:new s.Metadata});return}if(t.methodConfig.timeout){let e=new Date;e.setSeconds(e.getSeconds()+t.methodConfig.timeout.seconds),e.setMilliseconds(e.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,i.minDeadline)(this.deadline,e),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(e=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(e,{onReceiveMetadata:e=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(e))},onReceiveMessage:e=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(e).then(e=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(e),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},e=>{this.cancelWithStatus(e.code,e.details)})},onReceiveStatus:e=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=e:this.outputStatus(e)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},e=>{this.outputStatus(e)})}reportResolverError(e){var t;(null===(t=this.metadata)||void 0===t?void 0:t.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var n;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null===(n=this.child)||void 0===n||n.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new s.Metadata})}getPeer(){var e,t;return null!==(t=null===(e=this.child)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}}t.ResolvingCall=u},77661:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvingLoadBalancer=void 0;let r=n(69884),i=n(94298),s=n(72409),a=n(84063),o=n(2352),l=n(1742),u=n(19572),c=n(6281),d=n(25792),h=n(19572),f=n(55541),p=n(56372),m="resolving_load_balancer";function g(e){d.trace(h.LogVerbosity.DEBUG,m,e)}let y=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function v(e,t,n,r){for(let i of n.name)switch(r){case"EMPTY":if(!i.service&&!i.method)return!0;break;case"SERVICE":if(i.service===e&&!i.method)return!0;break;case"SERVICE_AND_METHOD":if(i.service===e&&i.method===t)return!0}return!1}function b(e,t,n,r){for(let i of n)if(v(e,t,i,r))return i;return null}function w(e){return function(t,n){var r,i;let s=t.split("/").filter(e=>e.length>0),a=null!==(r=s[0])&&void 0!==r?r:"",o=null!==(i=s[1])&&void 0!==i?i:"";if(e&&e.methodConfig)for(let t of y){let n=b(a,o,e.methodConfig,t);if(n)return{methodConfig:n,pickInformation:{},status:u.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:u.Status.OK,dynamicFilterFactories:[]}}}class S{constructor(e,t,n,d,h){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=d,this.onFailedResolution=h,this.latestChildState=s.ConnectivityState.IDLE,this.latestChildPicker=new o.QueuePicker(this),this.currentState=s.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,n["grpc.service_config"]?this.defaultServiceConfig=(0,i.validateServiceConfig)(JSON.parse(n["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(s.ConnectivityState.IDLE,new o.QueuePicker(this)),this.childLoadBalancer=new p.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(g("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(e,t)=>{this.latestChildState=e,this.latestChildPicker=t,this.updateState(e,t)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,a.createResolver)(e,{onSuccessfulResolution:(e,t,n,i,s)=>{var a;this.backoffTimeout.stop(),this.backoffTimeout.reset();let o=null;null===t?null===n?(this.previousServiceConfig=null,o=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(n):o=this.previousServiceConfig:(o=t,this.previousServiceConfig=t);let l=null!==(a=null==o?void 0:o.loadBalancingConfig)&&void 0!==a?a:[],d=(0,r.getFirstUsableConfig)(l,!0);if(null===d){this.handleResolutionFailure({code:u.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new c.Metadata});return}this.childLoadBalancer.updateAddressList(e,d,s);let h=null!=o?o:this.defaultServiceConfig;this.onSuccessfulResolution(h,null!=i?i:w(h))},onError:e=>{this.handleResolutionFailure(e)}},n);let f={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new l.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},f),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===s.ConnectivityState.IDLE&&this.updateState(s.ConnectivityState.CONNECTING,new o.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){g((0,f.uriToString)(this.target)+" "+s.ConnectivityState[this.currentState]+" -> "+s.ConnectivityState[e]),e===s.ConnectivityState.IDLE&&(t=new o.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===s.ConnectivityState.IDLE&&(this.updateState(s.ConnectivityState.TRANSIENT_FAILURE,new o.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===s.ConnectivityState.IDLE||this.currentState===s.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=s.ConnectivityState.IDLE,this.latestChildPicker=new o.QueuePicker(this),this.currentState=s.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}t.ResolvingLoadBalancer=S},25627:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryingCall=t.MessageBufferTracker=t.RetryThrottler=void 0;let r=n(19572),i=n(6281),s=n(25792),a="retrying_call";class o{constructor(e,t,n){this.maxTokens=e,this.tokenRatio=t,n?this.tokens=n.tokens*(e/n.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}t.RetryThrottler=o;class l{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var n;let r=null!==(n=this.allocatedPerCall.get(t))&&void 0!==n?n:0;return!(this.limitPerCall-r<e)&&!(this.totalLimit-this.totalAllocated<e)&&(this.allocatedPerCall.set(t,r+e),this.totalAllocated+=e,!0)}free(e,t){var n;if(this.totalAllocated<e)throw Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let r=null!==(n=this.allocatedPerCall.get(t))&&void 0!==n?n:0;if(r<e)throw Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${r}`);this.allocatedPerCall.set(t,r-e)}freeAll(e){var t;let n=null!==(t=this.allocatedPerCall.get(e))&&void 0!==t?t:0;if(this.totalAllocated<n)throw Error(`Invalid buffer allocation state: call ${e} allocated ${n} > total allocated ${this.totalAllocated}`);this.totalAllocated-=n,this.allocatedPerCall.delete(e)}}t.MessageBufferTracker=l;let u="grpc-previous-rpc-attempts";class c{constructor(e,t,n,r,i,s,a,o,l){if(this.channel=e,this.callConfig=t,this.methodName=n,this.host=r,this.credentials=i,this.deadline=s,this.callNumber=a,this.bufferTracker=o,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let e=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(e.initialBackoff.substring(0,e.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){s.trace(r.LogVerbosity.DEBUG,a,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;null===(t=this.listener)||void 0===t||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){for(let{call:n}of(this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new i.Metadata}),this.underlyingCalls))n.cancelWithStatus(e,t)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return null!==(t=this.writeBuffer[e-this.writeBufferOffset])&&void 0!==t?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let e=this.getBufferEntry(t);e.allocated&&this.bufferTracker.free(e.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[e].state){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&"COMPLETED"!==this.underlyingCalls[t].state&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(r.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let e=-1,t=-1;for(let[n,r]of this.underlyingCalls.entries())"ACTIVE"===r.state&&r.nextMessageToSend>e&&(e=r.nextMessageToSend,t=n);-1===t?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(e=>e===t||e.toString().toLowerCase()===r.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=null===(e=this.callConfig)||void 0===e?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let n=Math.random()*this.nextRetryBackoffSec*1e3,r=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,r),n}maybeRetryCall(e,t){let n;if("RETRY"!==this.state){t(!1);return}let r=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(r.maxAttempts,5)){t(!1);return}if(null===e)n=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else n=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var e,n;if("RETRY"!==this.state){t(!1);return}(null===(n=null===(e=this.retryThrottler)||void 0===e?void 0:e.canRetryCall())||void 0===n||n)&&(t(!0),this.attempts+=1,this.startNewAttempt())},n)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)(null==t?void 0:t.state)==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,n){var r,i,s;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList(null!==(r=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)&&void 0!==r?r:[],e.code)){let r;if(null===(i=this.retryThrottler)||void 0===i||i.addCallFailed(),null===n)r=0;else if(n<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else r=n;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(t),this.reportStatus(e))},r)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?(null===(s=this.retryThrottler)||void 0===s||s.addCallFailed(),this.maybeRetryCall(n,n=>{n||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e))}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(0===t.length)return null;try{return parseInt(t[0])}catch(e){return -1}}handleChildStatus(e,t){var n;if("COMPLETED"===this.underlyingCalls[t].state)return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===r.Status.OK){null===(n=this.retryThrottler)||void 0===n||n.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if("COMMITTED"===this.state){this.reportStatus(e);return}let i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,i):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,i)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,n;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let r=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(r.maxAttempts,5))return;let i=null!==(e=r.hedgingDelay)&&void 0!==e?e:"0s",s=Number(i.substring(0,i.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*s),null===(n=(t=this.hedgingTimer).unref)||void 0===n||n.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let n=this.attempts-1,r=this.initialMetadata.clone();n>0&&r.set(u,`${n}`);let i=!1;e.start(r,{onReceiveMetadata:r=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),i=!0,n>0&&r.set(u,`${n}`),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMetadata(r)},onReceiveMessage:n=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMessage(n)},onReceiveStatus:r=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!i&&n>0&&r.metadata.set(u,`${n}`),this.handleChildStatus(r,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,n;let r=this.underlyingCalls[e],i=r.nextMessageToSend;null===(n=(t=this.getBufferEntry(i)).callback)||void 0===n||n.call(t),this.clearSentMessages(),r.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if("COMPLETED"!==t.state&&this.getBufferEntry(t.nextMessageToSend)){let n=this.getBufferEntry(t.nextMessageToSend);switch(n.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:t=>{this.handleChildWriteCompleted(e)}},n.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose()}}}sendMessageWithContext(e,t){var n;this.trace("write() called with message of length "+t.length);let r={message:t,flags:e.flags},i=this.getNextBufferIndex(),s={entryType:"MESSAGE",message:r,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(s),s.allocated)for(let[r,s]of(null===(n=e.callback)||void 0===n||n.call(e),this.underlyingCalls.entries()))"ACTIVE"===s.state&&s.nextMessageToSend===i&&s.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(r)}},t);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let n=this.underlyingCalls[this.committedCallIndex];s.callback=e.callback,"ACTIVE"===n.state&&n.nextMessageToSend===i&&n.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){for(let e of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==e?void 0:e.state)==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();for(let t of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==t?void 0:t.state)==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}t.RetryingCall=c},92025:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2ServerCallStream=t.ServerDuplexStreamImpl=t.ServerWritableStreamImpl=t.ServerReadableStreamImpl=t.ServerUnaryCallImpl=void 0;let r=n(17702),i=n(32694),s=n(76162),a=n(71568),o=n(19572),l=n(6281),u=n(80615),c=n(25792),d=n(96027),h="server_call";function f(e){c.trace(o.LogVerbosity.DEBUG,h,e)}let p="grpc-message",m="grpc-status",g="grpc-timeout",y=/(\d{1,8})\s*([HMSmun])/,v={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},b={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},w={[i.constants.HTTP2_HEADER_STATUS]:i.constants.HTTP_STATUS_OK,[i.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},S={waitForTrailers:!0};class T extends r.EventEmitter{constructor(e,t,n){super(),this.call=e,this.metadata=t,this.request=n,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}t.ServerUnaryCallImpl=T;class C extends s.Readable{constructor(e,t,n,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=n,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,r)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}t.ServerReadableStreamImpl=C;class E extends s.Writable{constructor(e,t,n,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=n,this.request=r,this.cancelled=!1,this.trailingMetadata=new l.Metadata,this.call.setupSurfaceCall(this),this.on("error",e=>{this.call.sendError(e),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,n){try{let t=this.call.serializeMessage(e);if(!this.call.write(t)){this.call.once("drain",n);return}}catch(e){this.emit("error",{details:(0,d.getErrorMessage)(e),code:o.Status.INTERNAL})}n()}_final(e){this.call.sendStatus({code:o.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}}t.ServerWritableStreamImpl=E;class x extends s.Duplex{constructor(e,t,n,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=n,this.deserialize=r,this.cancelled=!1,this.trailingMetadata=new l.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i),this.on("error",e=>{this.call.sendError(e),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}}t.ServerDuplexStreamImpl=x,x.prototype._read=C.prototype._read,x.prototype._write=E.prototype._write,x.prototype._final=E.prototype._final;class _ extends r.EventEmitter{constructor(e,t,n){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=o.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=o.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",e=>{}),this.stream.once("close",()=>{var e;f("Request to method "+(null===(e=this.handler)||void 0===e?void 0:e.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:o.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in n&&(this.maxSendMessageSize=n["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in n&&(this.maxReceiveMessageSize=n["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let n=e.subarray(5);if("identity"===t)return n;if("deflate"!==t&&"gzip"!==t)return Promise.reject({code:o.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`});{let e;return e="deflate"===t?a.createInflate():a.createGunzip(),new Promise((t,r)=>{let i=0,s=[];e.on("data",t=>{s.push(t),i+=t.byteLength,-1!==this.maxReceiveMessageSize&&i>this.maxReceiveMessageSize&&(e.destroy(),r({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),e.on("end",()=>{t(Buffer.concat(s))}),e.write(n),e.end()})}}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,n=Object.assign(Object.assign(Object.assign({},w),b),t);this.stream.respond(n,S)}receiveMetadata(e){let t=l.Metadata.fromHttp2Headers(e);c.isTracerEnabled(h)&&f("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let n=t.get(g);if(n.length>0){let e=n[0].toString().match(y);if(null===e){let e=Error("Invalid deadline");return e.code=o.Status.OUT_OF_RANGE,this.sendError(e),t}let r=+e[1]*v[e[2]]|0,i=new Date;this.deadline=i.setMilliseconds(i.getMilliseconds()+r),this.deadlineTimer=setTimeout(I,r,this),t.remove(g)}return t.remove(i.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(i.constants.HTTP2_HEADER_TE),t.remove(i.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,n)=>{let{stream:r}=this,i=0,s=this,a=[],l=this.maxReceiveMessageSize;function u(e){if(i+=e.byteLength,-1!==l&&i>l){r.removeListener("data",u),r.removeListener("end",c),r.removeListener("error",c),n({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${i} vs. ${l})`});return}a.push(e)}function c(l){if(r.removeListener("data",u),r.removeListener("end",c),r.removeListener("error",c),void 0!==l){n({code:o.Status.INTERNAL,details:l.message});return}if(0===i){n({code:o.Status.INTERNAL,details:"received empty unary message"});return}s.emit("receiveMessage");let d=Buffer.concat(a,i),h=1===d.readUInt8(0)?e:"identity",f=s.getDecompressedMessage(d,h);if(Buffer.isBuffer(f)){t(s.deserializeMessageWithInternalError(f));return}f.then(e=>t(s.deserializeMessageWithInternalError(e)),t=>n(t.code?t:{code:o.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}this.stream.on("data",u),this.stream.on("end",c),this.stream.on("error",c)})}async deserializeMessageWithInternalError(e){try{return this.deserializeMessage(e)}catch(e){throw{details:(0,d.getErrorMessage)(e),code:o.Status.INTERNAL}}}serializeMessage(e){let t=this.handler.serialize(e),n=t.byteLength,r=Buffer.allocUnsafe(n+5);return r.writeUInt8(0,0),r.writeUInt32BE(n,1),t.copy(r,5),r}deserializeMessage(e){return this.handler.deserialize(e)}async sendUnaryMessage(e,t,n,r){if(!this.checkCancelled()){if(void 0===n&&(n=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&n&&(e.metadata=n),this.sendError(e);return}try{let e=this.serializeMessage(t);this.write(e),this.sendStatus({code:o.Status.OK,details:"OK",metadata:n})}catch(e){this.sendError({details:(0,d.getErrorMessage)(e),code:o.Status.INTERNAL})}}}sendStatus(e){var t,n;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===o.Status.OK),!this.checkCancelled()){if(f("Request to method "+(null===(t=this.handler)||void 0===t?void 0:t.path)+" ended with status code: "+o.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var t;let n=Object.assign({[m]:e.code,[p]:encodeURI(e.details)},null===(t=e.metadata)||void 0===t?void 0:t.toHttp2Headers());this.stream.sendTrailers(n),this.statusSent=!0}),this.stream.end());else{let t=Object.assign(Object.assign({[m]:e.code,[p]:encodeURI(e.details)},w),null===(n=e.metadata)||void 0===n?void 0:n.toHttp2Headers());this.stream.respond(t,{endStream:!0}),this.statusSent=!0}}}sendError(e){let t={code:o.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&void 0!==e.metadata?e.metadata:null};"code"in e&&"number"==typeof e.code&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&"string"==typeof e.details&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(-1!==this.maxSendMessageSize&&e.length>this.maxSendMessageSize){this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let n=new u.StreamDecoder(this.maxReceiveMessageSize),r=!1,i=!1,s=!1,a=async()=>{s||!r||i||(s=!0,await this.pushOrBufferMessage(e,null))};this.stream.on("data",async r=>{let s;try{s=n.write(r)}catch(e){this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:e.message});return}for(let n of(i=!0,this.stream.pause(),s)){let r;this.emit("receiveMessage");let i=1===n.readUInt8(0)?t:"identity";try{r=await this.getDecompressedMessage(n,i)}catch(e){this.sendError(e);return}if(!r)return;await this.pushOrBufferMessage(e,r)}i=!1,this.stream.resume(),await a()}),this.stream.once("end",async()=>{r=!0,await a()})}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),n=e.push(t);if(null===t||!1===n){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(e,t){this.isPushPending?this.bufferedMessages.push(t):await this.pushMessage(e,t)}async pushMessage(e,t){if(null===t){f("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}f("Received message of length "+t.length),this.isPushPending=!0;try{let n=await this.deserializeMessage(t);this.canPush?e.push(n)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(n)}catch(n){this.bufferedMessages.length=0;let t=(0,d.getErrorCode)(n);(null===t||t<o.Status.OK||t>o.Status.UNAUTHENTICATED)&&(t=o.Status.INTERNAL),e.emit("error",{details:(0,d.getErrorMessage)(n),code:t})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(e,this.bufferedMessages.shift())}getPeer(){var e;let t=null===(e=this.stream.session)||void 0===e?void 0:e.socket;return null!=t&&t.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function I(e){let t=Error("Deadline exceeded");t.code=o.Status.DEADLINE_EXCEEDED,e.sendError(t),e.cancelled=!0,e.emit("cancelled","deadline")}t.Http2ServerCallStream=_},43783:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerCredentials=void 0;let r=n(80606);class i{static createInsecure(){return new s}static createSsl(e,t,n=!1){if(null!==e&&!Buffer.isBuffer(e))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof n)throw TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let e=0;e<t.length;e++){let n=t[e];if(null===n||"object"!=typeof n)throw TypeError(`keyCertPair[${e}] must be an object`);if(!Buffer.isBuffer(n.private_key))throw TypeError(`keyCertPair[${e}].private_key must be a Buffer`);if(!Buffer.isBuffer(n.cert_chain))throw TypeError(`keyCertPair[${e}].cert_chain must be a Buffer`);i.push(n.cert_chain),s.push(n.private_key)}return new a({ca:e||(0,r.getDefaultRootsData)()||void 0,cert:i,key:s,requestCert:n,ciphers:r.CIPHER_SUITES})}}t.ServerCredentials=i;class s extends i{_isSecure(){return!1}_getSettings(){return null}}class a extends i{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}},66418:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Server=void 0;let r=n(32694),i=n(19572),s=n(92025),a=n(43783),o=n(84063),l=n(25792),u=n(74955),c=n(55541),d=n(65962),h=2147483647,f=2147483647,p=2e4,{HTTP2_HEADER_PATH:m}=r.constants,g="server";function y(){}function v(e){return{code:i.Status.UNIMPLEMENTED,details:`The server does not implement the method ${e}`}}function b(e,t){let n=v(t);switch(e){case"unary":return(e,t)=>{t(n,null)};case"clientStream":return(e,t)=>{t(n,null)};case"serverStream":return e=>{e.emit("error",n)};case"bidi":return e=>{e.emit("error",n)};default:throw Error(`Invalid handlerType ${e}`)}}class w{constructor(e){var t,n,r,i;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new d.ChannelzTrace,this.callTracker=new d.ChannelzCallTracker,this.listenerChildrenTracker=new d.ChannelzChildrenTracker,this.sessionChildrenTracker=new d.ChannelzChildrenTracker,this.options=null!=e?e:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,d.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!==(t=this.options["grpc.max_connection_age_ms"])&&void 0!==t?t:h,this.maxConnectionAgeGraceMs=null!==(n=this.options["grpc.max_connection_age_grace_ms"])&&void 0!==n?n:h,this.keepaliveTimeMs=null!==(r=this.options["grpc.keepalive_time_ms"])&&void 0!==r?r:f,this.keepaliveTimeoutMs=null!==(i=this.options["grpc.keepalive_timeout_ms"])&&void 0!==i?i:p,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,n,r;let i;let s=this.sessions.get(e),a=e.socket,o=a.remoteAddress?(0,u.stringToSubchannelAddress)(a.remoteAddress,a.remotePort):null,l=a.localAddress?(0,u.stringToSubchannelAddress)(a.localAddress,a.localPort):null;if(e.encrypted){let e=a,n=e.getCipher(),r=e.getCertificate(),s=e.getPeerCertificate();i={cipherSuiteStandardName:null!==(t=n.standardName)&&void 0!==t?t:null,cipherSuiteOtherName:n.standardName?null:n.name,localCertificate:r&&"raw"in r?r.raw:null,remoteCertificate:s&&"raw"in s?s.raw:null}}else i=null;return{remoteAddress:o,localAddress:l,security:i,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(n=e.state.localWindowSize)&&void 0!==n?n:null,remoteFlowControlWindow:null!==(r=e.state.remoteWindowSize)&&void 0!==r?r:null}}}trace(e){l.trace(i.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+e)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(e,t){if(null===e||"object"!=typeof e||null===t||"object"!=typeof t)throw Error("addService() requires two objects as arguments");let n=Object.keys(e);if(0===n.length)throw Error("Cannot add an empty service to a server");n.forEach(n=>{let r,i;let s=e[n];r=s.requestStream?s.responseStream?"bidi":"clientStream":s.responseStream?"serverStream":"unary";let a=t[n];if(void 0===a&&"string"==typeof s.originalName&&(a=t[s.originalName]),i=void 0!==a?a.bind(t):b(r,n),!1===this.register(s.path,i,s.responseSerialize,s.requestDeserialize,r))throw Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(null===e||"object"!=typeof e)throw Error("removeService() requires object as argument");Object.keys(e).forEach(t=>{let n=e[t];this.unregister(n.path)})}bind(e,t){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,n){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof e)throw TypeError("port must be a string");if(null===t||!(t instanceof a.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof n)throw TypeError("callback must be a function");let s=(0,c.parseUri)(e);if(null===s)throw Error(`Could not parse port "${e}"`);let h=(0,o.mapUriDefaultScheme)(s);if(null===h)throw Error(`Could not get a default scheme for port "${e}"`);let f={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?f.maxSessionMemory=this.options["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(f.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let p=(e,t)=>{process.nextTick(()=>n(e,t))},m=()=>{let e;if(t._isSecure()){let n=Object.assign(f,t._getSettings());n.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(e=r.createSecureServer(n)).on("secureConnection",e=>{e.on("error",e=>{this.trace("An incoming TLS connection closed with error: "+e.message)})})}else e=r.createServer(f);return e.setTimeout(0,y),this._setupHandlers(e),e},g=(e,t,n)=>0===e.length?Promise.resolve({port:t,count:n}):Promise.all(e.map(e=>{let n;this.trace("Attempting to bind "+(0,u.subchannelAddressToString)(e)),n=(0,u.isTcpSubchannelAddress)(e)?{host:e.host,port:t}:e;let r=m();return new Promise((i,s)=>{let a=t=>{this.trace("Failed to bind "+(0,u.subchannelAddressToString)(e)+" with error "+t.message),i(t)};r.once("error",a),r.listen(n,()=>{let e;if(this.shutdown){r.close(),i(Error("bindAsync failed because server is shutdown"));return}let n=r.address();e="string"==typeof n?{path:n}:{host:n.address,port:n.port};let s=(0,d.registerChannelzSocket)((0,u.subchannelAddressToString)(e),()=>({localAddress:e,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(s),this.http2ServerList.push({server:r,channelzRef:s}),this.trace("Successfully bound "+(0,u.subchannelAddressToString)(e)),i("port"in e?e.port:t),r.removeListener("error",a)})})})).then(e=>{let r=0;for(let n of e)if("number"==typeof n&&(r+=1,n!==t))throw Error("Invalid state: multiple port numbers added from single address");return{port:t,count:r+n}}),v=e=>{if(0===e.length)return Promise.resolve({port:0,count:0});let t=e[0],n=m();return new Promise((r,i)=>{let s=n=>{this.trace("Failed to bind "+(0,u.subchannelAddressToString)(t)+" with error "+n.message),r(v(e.slice(1)))};n.once("error",s),n.listen(t,()=>{if(this.shutdown){n.close(),r({port:0,count:0});return}let t=n.address(),i={host:t.address,port:t.port},a=(0,d.registerChannelzSocket)((0,u.subchannelAddressToString)(i),()=>({localAddress:i,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(a),this.http2ServerList.push({server:n,channelzRef:a}),this.trace("Successfully bound "+(0,u.subchannelAddressToString)(i)),r(g(e.slice(1),t.port,1)),n.removeListener("error",s)})})},b={onSuccessfulResolution:(t,n,r)=>{let s;if(b.onSuccessfulResolution=()=>{},this.shutdown&&p(Error("bindAsync failed because server is shutdown"),0),0===t.length){p(Error(`No addresses resolved for port ${e}`),0);return}(s=(0,u.isTcpSubchannelAddress)(t[0])?0===t[0].port?v(t):g(t,t[0].port,0):g(t,1,0)).then(e=>{if(0===e.count){let e=`No address added out of total ${t.length} resolved`;l.log(i.LogVerbosity.ERROR,e),p(Error(e),0)}else e.count<t.length&&l.log(i.LogVerbosity.INFO,`WARNING Only ${e.count} addresses added out of total ${t.length} resolved`),p(null,e.port)},e=>{let n=`No address added out of total ${t.length} resolved`;l.log(i.LogVerbosity.ERROR,n),p(Error(n),0)})},onError:e=>{p(Error(e.details),0)}};(0,o.createResolver)(h,b,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,d.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(r.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,d.unregisterChannelzRef)(this.channelzRef)}register(e,t,n,r,i){return!this.handlers.has(e)&&(this.handlers.set(e,{func:t,serialize:n,deserialize:r,type:i,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:e})=>!0!==e.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=t=>{this.channelzEnabled&&(0,d.unregisterChannelzRef)(this.channelzRef),e(t)},n=0;function r(){0==--n&&t()}for(let{server:e,channelzRef:t}of(this.started=!1,this.shutdown=!0,this.http2ServerList))e.listening&&(n++,e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,d.unregisterChannelzRef)(t)),r()}));this.sessions.forEach((e,t)=>{t.closed||(n+=1,t.close(r))}),0===n&&t()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let n=t[r.constants.HTTP2_HEADER_CONTENT_TYPE];return!!("string"==typeof n&&n.startsWith("application/grpc"))||(e.respond({[r.constants.HTTP2_HEADER_STATUS]:r.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return void 0===t?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,n=null){let r=new s.Http2ServerCallStream(t,null,this.options);void 0===e.code&&(e.code=i.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==n||n.streamTracker.addCallFailed()),r.sendError(e)}_channelzHandler(e,t){let n=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),null==n||n.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),null==n||n.streamTracker.addCallFailed();return}let r=t[m],a=this._retrieveHandler(r);if(!a){this._respondWithError(v(r),e,n);return}let o=new s.Http2ServerCallStream(e,a,this.options);o.once("callEnd",e=>{e===i.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),n&&(o.once("streamEnd",e=>{e?n.streamTracker.addCallSucceeded():n.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{n.messagesSent+=1,n.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{n.messagesReceived+=1,n.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,a,t)||(this.callTracker.addCallFailed(),null==n||n.streamTracker.addCallFailed(),o.sendError({code:i.Status.INTERNAL,details:`Unknown handler type: ${a.type}`}))}_streamHandler(e,t){if(!0!==this._verifyContentType(e,t))return;let n=t[m],r=this._retrieveHandler(n);if(!r){this._respondWithError(v(n),e,null);return}let a=new s.Http2ServerCallStream(e,r,this.options);this._runHandlerForCall(a,r,t)||a.sendError({code:i.Status.INTERNAL,details:`Unknown handler type: ${r.type}`})}_runHandlerForCall(e,t,n){var r;let i=e.receiveMetadata(n),s=null!==(r=i.get("grpc-encoding")[0])&&void 0!==r?r:"identity";i.remove("grpc-encoding");let{type:a}=t;if("unary"===a)S(e,t,i,s);else if("clientStream"===a)T(e,t,i,s);else if("serverStream"===a)C(e,t,i,s);else{if("bidi"!==a)return!1;E(e,t,i,s)}return!0}_setupHandlers(e){if(null===e)return;let t=e.address(),n="null";t&&(n="string"==typeof t?t:t.address+":"+t.port),this.serverAddressString=n;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",e=>{var t,n,i,s,a;if(!this.started){e.destroy();return}let o=(0,d.registerChannelzSocket)(null!==(t=e.socket.remoteAddress)&&void 0!==t?t:"unknown",this.getChannelzSessionInfoGetter(e),this.channelzEnabled),l={ref:o,streamTracker:new d.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(e,l);let u=e.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+u),this.sessionChildrenTracker.refChild(o));let c=null,f=null,p=!1;if(this.maxConnectionAgeMs!==h){let t=this.maxConnectionAgeMs/10,s=Math.random()*t*2-t;c=null===(i=(n=setTimeout(()=>{var t,n;p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+u);try{e.goaway(r.constants.NGHTTP2_NO_ERROR,2147483647,Buffer.from("max_age"))}catch(t){e.destroy();return}e.close(),this.maxConnectionAgeGraceMs!==h&&(f=null===(n=(t=setTimeout(()=>{e.destroy()},this.maxConnectionAgeGraceMs)).unref)||void 0===n?void 0:n.call(t))},this.maxConnectionAgeMs+s)).unref)||void 0===i?void 0:i.call(n)}let m=null===(a=(s=setInterval(()=>{var t,n;let r=null===(n=(t=setTimeout(()=>{p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+u),e.close()},this.keepaliveTimeoutMs)).unref)||void 0===n?void 0:n.call(t);try{e.ping((e,t,n)=>{clearTimeout(r)})}catch(t){e.destroy()}},this.keepaliveTimeMs)).unref)||void 0===a?void 0:a.call(s);e.on("close",()=>{this.channelzEnabled&&(p||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+u),this.sessionChildrenTracker.unrefChild(o),(0,d.unregisterChannelzRef)(o)),c&&clearTimeout(c),f&&clearTimeout(f),m&&clearTimeout(m),this.sessions.delete(e)})})}}async function S(e,t,n,r){try{let i=await e.receiveUnaryMessage(r);if(void 0===i||e.cancelled)return;let a=new s.ServerUnaryCallImpl(e,n,i);t.func(a,(t,n,r,i)=>{e.sendUnaryMessage(t,n,r,i)})}catch(t){e.sendError(t)}}function T(e,t,n,r){let i=new s.ServerReadableStreamImpl(e,n,t.deserialize,r);function a(t,n,r,s){i.destroy(),e.sendUnaryMessage(t,n,r,s)}e.cancelled||(i.on("error",a),t.func(i,a))}async function C(e,t,n,r){try{let i=await e.receiveUnaryMessage(r);if(void 0===i||e.cancelled)return;let a=new s.ServerWritableStreamImpl(e,n,t.serialize,i);t.func(a)}catch(t){e.sendError(t)}}function E(e,t,n,r){let i=new s.ServerDuplexStreamImpl(e,n,t.serialize,t.deserialize,r);e.cancelled||t.func(i)}t.Server=w},94298:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractAndSelectServiceConfig=t.validateServiceConfig=t.validateRetryThrottling=void 0;let r=n(19801),i=n(19572),s=n(69884),a=/^\d+(\.\d{1,9})?s$/,o="node";function l(e){if("service"in e&&""!==e.service){if("string"!=typeof e.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof e.service}`);if(!("method"in e)||""===e.method)return{service:e.service};if("string"!=typeof e.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof e.service}`);return{service:e.service,method:e.method}}if("method"in e&&void 0!==e.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function u(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in e)||"string"!=typeof e.initialBackoff||!a.test(e.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in e)||"string"!=typeof e.maxBackoff||!a.test(e.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in e)||"number"!=typeof e.backoffMultiplier||e.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in e&&Array.isArray(e.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===e.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let t of e.retryableStatusCodes)if("number"==typeof t){if(!Object.values(i.Status).includes(t))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof t){if(!Object.values(i.Status).includes(t.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:e.maxAttempts,initialBackoff:e.initialBackoff,maxBackoff:e.maxBackoff,backoffMultiplier:e.backoffMultiplier,retryableStatusCodes:e.retryableStatusCodes}}function c(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in e&&("string"!=typeof e.hedgingDelay||!a.test(e.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in e&&Array.isArray(e.nonFatalStatusCodes))for(let t of e.nonFatalStatusCodes)if("number"==typeof t){if(!Object.values(i.Status).includes(t))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof t){if(!Object.values(i.Status).includes(t.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let t={maxAttempts:e.maxAttempts};return e.hedgingDelay&&(t.hedgingDelay=e.hedgingDelay),e.nonFatalStatusCodes&&(t.nonFatalStatusCodes=e.nonFatalStatusCodes),t}function d(e){var t;let n={name:[]};if(!("name"in e)||!Array.isArray(e.name))throw Error("Invalid method config: invalid name array");for(let t of e.name)n.name.push(l(t));if("waitForReady"in e){if("boolean"!=typeof e.waitForReady)throw Error("Invalid method config: invalid waitForReady");n.waitForReady=e.waitForReady}if("timeout"in e){if("object"==typeof e.timeout){if(!("seconds"in e.timeout)||"number"!=typeof e.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in e.timeout)||"number"!=typeof e.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");n.timeout=e.timeout}else if("string"==typeof e.timeout&&a.test(e.timeout)){let r=e.timeout.substring(0,e.timeout.length-1).split(".");n.timeout={seconds:0|r[0],nanos:(null!==(t=r[1])&&void 0!==t?t:0)|0}}else throw Error("Invalid method config: invalid timeout")}if("maxRequestBytes"in e){if("number"!=typeof e.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");n.maxRequestBytes=e.maxRequestBytes}if("maxResponseBytes"in e){if("number"!=typeof e.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");n.maxResponseBytes=e.maxResponseBytes}if("retryPolicy"in e){if("hedgingPolicy"in e)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");n.retryPolicy=u(e.retryPolicy)}else"hedgingPolicy"in e&&(n.hedgingPolicy=c(e.hedgingPolicy));return n}function h(e){if(!("maxTokens"in e)||"number"!=typeof e.maxTokens||e.maxTokens<=0||e.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in e)||"number"!=typeof e.tokenRatio||e.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+e.maxTokens.toFixed(3),tokenRatio:+e.tokenRatio.toFixed(3)}}function f(e){let t={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in e){if("string"==typeof e.loadBalancingPolicy)t.loadBalancingPolicy=e.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy")}if("loadBalancingConfig"in e){if(Array.isArray(e.loadBalancingConfig))for(let n of e.loadBalancingConfig)t.loadBalancingConfig.push((0,s.validateLoadBalancingConfig)(n));else throw Error("Invalid service config: invalid loadBalancingConfig")}if("methodConfig"in e&&Array.isArray(e.methodConfig))for(let n of e.methodConfig)t.methodConfig.push(d(n));"retryThrottling"in e&&(t.retryThrottling=h(e.retryThrottling));let n=[];for(let e of t.methodConfig)for(let t of e.name){for(let e of n)if(t.service===e.service&&t.method===e.method)throw Error(`Invalid service config: duplicate name ${t.service}/${t.method}`);n.push(t)}return t}function p(e){if(!("serviceConfig"in e))throw Error("Invalid service config choice: missing service config");let t={serviceConfig:f(e.serviceConfig)};if("clientLanguage"in e){if(Array.isArray(e.clientLanguage))for(let n of(t.clientLanguage=[],e.clientLanguage))if("string"==typeof n)t.clientLanguage.push(n);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage")}if("clientHostname"in e){if(Array.isArray(e.clientHostname))for(let n of(t.clientHostname=[],e.clientHostname))if("string"==typeof n)t.clientHostname.push(n);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname")}if("percentage"in e){if("number"==typeof e.percentage&&0<=e.percentage&&e.percentage<=100)t.percentage=e.percentage;else throw Error("Invalid service config choice: invalid percentage")}let n=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let t in e)if(!n.includes(t))throw Error(`Invalid service config choice: unexpected field ${t}`);return t}function m(e,t){if(!Array.isArray(e))throw Error("Invalid service config list");for(let n of e){let e=p(n);if("number"!=typeof e.percentage||!(t>e.percentage)){if(Array.isArray(e.clientHostname)){let t=!1;for(let n of e.clientHostname)n===r.hostname()&&(t=!0);if(!t)continue}if(Array.isArray(e.clientLanguage)){let t=!1;for(let n of e.clientLanguage)n===o&&(t=!0);if(!t)continue}return e.serviceConfig}}throw Error("No matching service config found")}function g(e,t){for(let n of e)if(n.length>0&&n[0].startsWith("grpc_config="))return m(JSON.parse(n.join("").substring(12)),t);return null}t.validateRetryThrottling=h,t.validateServiceConfig=f,t.extractAndSelectServiceConfig=g},14339:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBuilder=void 0;class n{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return null!==this.code&&(e.code=this.code),null!==this.details&&(e.details=this.details),null!==this.metadata&&(e.metadata=this.metadata),e}}t.StatusBuilder=n},80615:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.StreamDecoder=void 0,function(e){e[e.NO_DATA=0]="NO_DATA",e[e.READING_SIZE=1]="READING_SIZE",e[e.READING_MESSAGE=2]="READING_MESSAGE"}(n||(n={}));class r{constructor(e){this.maxReadMessageLength=e,this.readState=n.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t,r=0,i=[];for(;r<e.length;)switch(this.readState){case n.NO_DATA:this.readCompressFlag=e.slice(r,r+1),r+=1,this.readState=n.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case n.READING_SIZE:if(t=Math.min(e.length-r,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,r,r+t),this.readSizeRemaining-=t,r+=t,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=n.READING_MESSAGE;else{let e=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=n.NO_DATA,i.push(e)}}break;case n.READING_MESSAGE:if(t=Math.min(e.length-r,this.readMessageRemaining),this.readPartialMessage.push(e.slice(r,r+t)),this.readMessageRemaining-=t,r+=t,0===this.readMessageRemaining){let e=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),t=Buffer.concat(e,this.readMessageSize+5);this.readState=n.NO_DATA,i.push(t)}break;default:throw Error("Unexpected read state")}return i}}t.StreamDecoder=r},74955:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToSubchannelAddress=t.subchannelAddressToString=t.subchannelAddressEqual=t.isTcpSubchannelAddress=void 0;let r=n(98216);function i(e){return"port"in e}function s(e,t){return!e&&!t||!!e&&!!t&&(i(e)?i(t)&&e.host===t.host&&e.port===t.port:!i(t)&&e.path===t.path)}function a(e){return i(e)?e.host+":"+e.port:e.path}t.isTcpSubchannelAddress=i,t.subchannelAddressEqual=s,t.subchannelAddressToString=a;let o=443;function l(e,t){return(0,r.isIP)(e)?{host:e,port:null!=t?t:o}:{path:e}}t.stringToSubchannelAddress=l},74354:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2SubchannelCall=void 0;let r=n(32694),i=n(19801),s=n(19572),a=n(6281),o=n(80615),l=n(25792),u=n(19572),c="subchannel_call";function d(e){for(let[t,n]of Object.entries(i.constants.errno))if(n===e)return t;return"Unknown system error "+e}class h{constructor(e,t,n,i,l){var u;this.http2Stream=e,this.callEventTracker=t,this.listener=n,this.transport=i,this.callId=l,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=s.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let c=null!==(u=i.getOptions()["grpc.max_receive_message_length"])&&void 0!==u?u:s.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new o.StreamDecoder(c),e.on("response",(e,t)=>{let n="";for(let t of Object.keys(e))n+="		"+t+": "+e[t]+"\n";switch(this.trace("Received server headers:\n"+n),e[":status"]){case 400:this.mappedStatusCode=s.Status.INTERNAL;break;case 401:this.mappedStatusCode=s.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=s.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=s.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=s.Status.UNAVAILABLE;break;default:this.mappedStatusCode=s.Status.UNKNOWN}if(t&r.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(e);else{let t;try{t=a.Metadata.fromHttp2Headers(e)}catch(e){this.endCall({code:s.Status.UNKNOWN,details:e.message,metadata:new a.Metadata});return}this.listener.onReceiveMetadata(t)}}),e.on("trailers",e=>{this.handleTrailers(e)}),e.on("data",e=>{let t;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+e.length);try{t=this.decoder.write(e)}catch(e){this.cancelWithStatus(s.Status.RESOURCE_EXHAUSTED,e.message);return}for(let e of t)this.trace("parsed message of length "+e.length),this.callEventTracker.addMessageReceived(),this.tryPush(e)}}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var t;let n;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),(null===(t=this.finalStatus)||void 0===t?void 0:t.code)===s.Status.OK)return;let i="";switch(e.rstCode){case r.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;n=s.Status.INTERNAL,i=`Received RST_STREAM with code ${e.rstCode}`;break;case r.constants.NGHTTP2_REFUSED_STREAM:n=s.Status.UNAVAILABLE,i="Stream refused by server";break;case r.constants.NGHTTP2_CANCEL:n=s.Status.CANCELLED,i="Call cancelled";break;case r.constants.NGHTTP2_ENHANCE_YOUR_CALM:n=s.Status.RESOURCE_EXHAUSTED,i="Bandwidth exhausted or memory limit exceeded";break;case r.constants.NGHTTP2_INADEQUATE_SECURITY:n=s.Status.PERMISSION_DENIED,i="Protocol not secure enough";break;case r.constants.NGHTTP2_INTERNAL_ERROR:n=s.Status.INTERNAL,null===this.internalError?i=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(n=s.Status.UNAVAILABLE,i=this.internalError.message):i=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:n=s.Status.INTERNAL,i=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:n,details:i,metadata:new a.Metadata,rstCode:e.rstCode})})}),e.on("error",e=>{"ERR_HTTP2_STREAM_ERROR"!==e.code&&(this.trace("Node error event: message="+e.message+" code="+e.code+" errno="+d(e.errno)+" syscall="+e.syscall),this.internalError=e),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:s.Status.UNAVAILABLE,details:"Connection dropped",metadata:new a.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){l.trace(u.LogVerbosity.DEBUG,c,"["+this.callId+"] "+e)}endCall(e){(null===this.finalStatus||this.finalStatus.code===s.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===s.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){let t;this.callEventTracker.onStreamEnd(!0);let n="";for(let t of Object.keys(e))n+="		"+t+": "+e[t]+"\n";this.trace("Received server trailers:\n"+n);try{t=a.Metadata.fromHttp2Headers(e)}catch(e){t=new a.Metadata}let r=t.getMap(),i=this.mappedStatusCode;if(i===s.Status.UNKNOWN&&"string"==typeof r["grpc-status"]){let e=Number(r["grpc-status"]);e in s.Status&&(i=e,this.trace("received status code "+e+" from server")),t.remove("grpc-status")}let o="";if("string"==typeof r["grpc-message"]){try{o=decodeURI(r["grpc-message"])}catch(e){o=r["grpc-message"]}t.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let l={code:i,details:o,metadata:t};this.endCall(l)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;t=(null===(e=this.finalStatus)||void 0===e?void 0:e.code)===s.Status.OK?r.constants.NGHTTP2_NO_ERROR:r.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new a.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==s.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let n=t=>{process.nextTick(()=>{var n;let r=s.Status.UNAVAILABLE;(null==t?void 0:t.code)==="ERR_STREAM_WRITE_AFTER_END"&&(r=s.Status.INTERNAL),t&&this.cancelWithStatus(r,`Write error: ${t.message}`),null===(n=e.callback)||void 0===n||n.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,n)}catch(e){this.endCall({code:s.Status.UNAVAILABLE,details:`Write failed with error ${e.message}`,metadata:new a.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}t.Http2SubchannelCall=h},40487:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseSubchannelWrapper=void 0;class n{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}}t.BaseSubchannelWrapper=n},87328:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSubchannelPool=t.SubchannelPool=void 0;let r=n(89455),i=n(20389),s=n(74955),a=n(55541),o=n(56983),l=1e4;class u{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let n=this.pool[t].filter(e=>!e.subchannel.unrefIfOneRef());n.length>0&&(e=!1),this.pool[t]=n}e&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},l),null===(t=(e=this.cleanupTimer).unref)||void 0===t||t.call(e))}getOrCreateSubchannel(e,t,n,l){this.ensureCleanupTask();let u=(0,a.uriToString)(e);if(u in this.pool){for(let e of this.pool[u])if((0,s.subchannelAddressEqual)(t,e.subchannelAddress)&&(0,r.channelOptionsEqual)(n,e.channelArguments)&&l._equals(e.channelCredentials))return e.subchannel}let c=new i.Subchannel(e,t,n,l,new o.Http2SubchannelConnector(e));return u in this.pool||(this.pool[u]=[]),this.pool[u].push({subchannelAddress:t,channelArguments:n,channelCredentials:l,subchannel:c}),c.ref(),c}}t.SubchannelPool=u;let c=new u;function d(e){return e?c:new u}t.getSubchannelPool=d},20389:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Subchannel=void 0;let r=n(72409),i=n(1742),s=n(25792),a=n(19572),o=n(55541),l=n(74955),u=n(65962),c="subchannel",d=2147483647;class h{constructor(e,t,n,s,a){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=n,this.credentials=s,this.connector=a,this.connectivityState=r.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new u.ChannelzCallTracker,this.childrenTracker=new u.ChannelzChildrenTracker,this.streamTracker=new u.ChannelzCallTracker;let c={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new i.BackoffTimeout(()=>{this.handleBackoffTimer()},c),this.backoffTimeout.unref(),this.subchannelAddressString=(0,l.subchannelAddressToString)(t),this.keepaliveTime=null!==(o=n["grpc.keepalive_time_ms"])&&void 0!==o?o:-1,0===n["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new u.ChannelzTrace,this.channelzRef=(0,u.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(n,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){s.trace(a.LogVerbosity.DEBUG,c,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){s.trace(a.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([r.ConnectivityState.TRANSIENT_FAILURE],r.ConnectivityState.CONNECTING):this.transitionToState([r.ConnectivityState.TRANSIENT_FAILURE],r.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,d);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(e=>{this.transitionToState([r.ConnectivityState.CONNECTING],r.ConnectivityState.READY)?(this.transport=e,this.channelzEnabled&&this.childrenTracker.refChild(e.getChannelzRef()),e.addDisconnectListener(e=>{this.transitionToState([r.ConnectivityState.READY],r.ConnectivityState.IDLE),e&&this.keepaliveTime>0&&(this.keepaliveTime*=2,s.log(a.LogVerbosity.ERROR,`Connection to ${(0,o.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):e.shutdown()},e=>{this.transitionToState([r.ConnectivityState.CONNECTING],r.ConnectivityState.TRANSIENT_FAILURE,`${e}`)})}transitionToState(e,t,n){var i,s;if(-1===e.indexOf(this.connectivityState))return!1;this.trace(r.ConnectivityState[this.connectivityState]+" -> "+r.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+r.ConnectivityState[t]);let a=this.connectivityState;switch(this.connectivityState=t,t){case r.ConnectivityState.READY:this.stopBackoff();break;case r.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case r.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(i=this.transport)||void 0===i||i.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case r.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(s=this.transport)||void 0===s||s.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let e of this.stateListeners)e(this,a,t,this.keepaliveTime,n);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,u.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([r.ConnectivityState.CONNECTING,r.ConnectivityState.READY],r.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(e,t,n,r){let i;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),i={onCallEnd:e=>{e.code===a.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):i={},this.transport.createCall(e,t,n,r,i)}startConnecting(){process.nextTick(()=>{this.transitionToState([r.ConnectivityState.IDLE],r.ConnectivityState.CONNECTING)||this.connectivityState!==r.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([r.ConnectivityState.TRANSIENT_FAILURE],r.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}}t.Subchannel=h},80606:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultRootsData=t.CIPHER_SUITES=void 0;let r=n(92048);t.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let i=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,s=null;function a(){return i?(null===s&&(s=r.readFileSync(i)),s):null}t.getDefaultRootsData=a},56983:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2SubchannelConnector=void 0;let r=n(32694),i=n(82452),s=n(65962),a=n(19572),o=n(85242),l=n(25792),u=n(84063),c=n(74955),d=n(55541),h=n(98216),f=n(74354),p=n(21801),m="transport",g="transport_flowctrl",y=n(81513).i8,{HTTP2_HEADER_AUTHORITY:v,HTTP2_HEADER_CONTENT_TYPE:b,HTTP2_HEADER_METHOD:w,HTTP2_HEADER_PATH:S,HTTP2_HEADER_TE:T,HTTP2_HEADER_USER_AGENT:C}=r.constants,E=2e4,x=Buffer.from("too_many_pings","ascii");class _{constructor(e,t,n,i){this.session=e,this.options=n,this.remoteName=i,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=E,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new s.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,c.subchannelAddressToString)(t),0===n["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,s.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[n["grpc.primary_user_agent"],`grpc-node-js/${y}`,n["grpc.secondary_user_agent"]].filter(e=>e).join(" "),"grpc.keepalive_time_ms"in n&&(this.keepaliveTimeMs=n["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in n&&(this.keepaliveTimeoutMs=n["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in n?this.keepaliveWithoutCalls=1===n["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(e,t,n)=>{let i=!1;e===r.constants.NGHTTP2_ENHANCE_YOUR_CALM&&n&&n.equals(x)&&(i=!0),this.trace("connection closed by GOAWAY with code "+e+" and data "+(null==n?void 0:n.toString())),this.reportDisconnectToOwner(i)}),e.once("error",e=>{this.trace("connection closed with error "+e.message)}),l.isTracerEnabled(m)&&(e.on("remoteSettings",t=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))}),e.on("localSettings",t=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,n;let r;let i=this.session.socket,s=i.remoteAddress?(0,c.stringToSubchannelAddress)(i.remoteAddress,i.remotePort):null,a=i.localAddress?(0,c.stringToSubchannelAddress)(i.localAddress,i.localPort):null;if(this.session.encrypted){let t=i,n=t.getCipher(),s=t.getCertificate(),a=t.getPeerCertificate();r={cipherSuiteStandardName:null!==(e=n.standardName)&&void 0!==e?e:null,cipherSuiteOtherName:n.standardName?null:n.name,localCertificate:s&&"raw"in s?s.raw:null,remoteCertificate:a&&"raw"in a?a.raw:null}}else r=null;return{remoteAddress:s,localAddress:a,security:r,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(t=this.session.state.localWindowSize)&&void 0!==t?t:null,remoteFlowControlWindow:null!==(n=this.session.state.remoteWindowSize)&&void 0!==n?n:null}}trace(e){l.trace(a.LogVerbosity.DEBUG,m,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){l.trace(a.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){l.trace(a.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){l.trace(a.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null===(t=(e=this.keepaliveTimeoutId).unref)||void 0===t||t.call(e));try{this.session.ping((e,t,n)=>{e&&(this.keepaliveTrace("Ping failed with error "+e.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(e){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null===(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)||void 0===t?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),0===this.activeCalls.size&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),1!==this.activeCalls.size||(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,n,r,i){let s,a,o;let l=e.toHttp2Headers();l[v]=t,l[C]=this.userAgent,l[b]="application/grpc",l[w]="POST",l[S]=n,l[T]="trailers";try{s=this.session.request(l)}catch(e){throw this.handleDisconnect(),e}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),a={addMessageSent:()=>{var e;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null===(e=i.addMessageSent)||void 0===e||e.call(i)},addMessageReceived:()=>{var e;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null===(e=i.addMessageReceived)||void 0===e||e.call(i)},onCallEnd:e=>{var t;null===(t=i.onCallEnd)||void 0===t||t.call(i,e),this.removeActiveCall(o)},onStreamEnd:e=>{var t;e?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null===(t=i.onStreamEnd)||void 0===t||t.call(i,e)}}):a={addMessageSent:()=>{var e;null===(e=i.addMessageSent)||void 0===e||e.call(i)},addMessageReceived:()=>{var e;null===(e=i.addMessageReceived)||void 0===e||e.call(i)},onCallEnd:e=>{var t;null===(t=i.onCallEnd)||void 0===t||t.call(i,e),this.removeActiveCall(o)},onStreamEnd:e=>{var t;null===(t=i.onStreamEnd)||void 0===t||t.call(i,e)}},o=new f.Http2SubchannelCall(s,a,r,this,(0,p.getNextCallNumber)()),this.addActiveCall(o),o}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,s.unregisterChannelzRef)(this.channelzRef)}}class I{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){l.trace(a.LogVerbosity.DEBUG,m,(0,d.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,n,s){return this.isShutdown?Promise.reject():new Promise((a,o)=>{var l,f,p;let m;s.realTarget?(m=(0,d.uriToString)(s.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,d.uriToString)(s.realTarget))):(m=null,this.trace("creating HTTP/2 session to "+(0,c.subchannelAddressToString)(e)));let g=(0,u.getDefaultAuthority)(null!==(l=s.realTarget)&&void 0!==l?l:this.channelTarget),y=t._getConnectionOptions()||{};y.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in n?y.maxSessionMemory=n["grpc-node.max_session_memory"]:y.maxSessionMemory=Number.MAX_SAFE_INTEGER;let v="http://";if("secureContext"in y){if(v="https://",n["grpc.ssl_target_name_override"]){let e=n["grpc.ssl_target_name_override"];y.checkServerIdentity=(t,n)=>(0,i.checkServerIdentity)(e,n),y.servername=e}else{let e=null!==(p=null===(f=(0,d.splitHostPort)(g))||void 0===f?void 0:f.host)&&void 0!==p?p:"localhost";y.servername=e}s.socket&&(y.createConnection=(e,t)=>s.socket)}else y.createConnection=(t,n)=>s.socket?s.socket:h.connect(e);y=Object.assign(Object.assign(Object.assign({},y),e),{enableTrace:1===n["grpc-node.tls_enable_trace"]});let b=r.connect(v+g,y);this.session=b;let w="Failed to connect";b.unref(),b.once("connect",()=>{b.removeAllListeners(),a(new _(b,e,n,m)),this.session=null}),b.once("close",()=>{this.session=null,setImmediate(()=>{o(`${w} (${new Date().toISOString()})`)})}),b.once("error",e=>{w=e.message,this.trace("connection failed with error "+w)})})}connect(e,t,n){var r,s;if(this.isShutdown)return Promise.reject();let a=t._getConnectionOptions()||{};if("secureContext"in a){if(a.ALPNProtocols=["h2"],n["grpc.ssl_target_name_override"]){let e=n["grpc.ssl_target_name_override"];a.checkServerIdentity=(t,n)=>(0,i.checkServerIdentity)(e,n),a.servername=e}else if("grpc.http_connect_target"in n){let e=(0,u.getDefaultAuthority)(null!==(r=(0,d.parseUri)(n["grpc.http_connect_target"]))&&void 0!==r?r:{path:"localhost"}),t=(0,d.splitHostPort)(e);a.servername=null!==(s=null==t?void 0:t.host)&&void 0!==s?s:e}n["grpc-node.tls_enable_trace"]&&(a.enableTrace=!0)}return(0,o.getProxiedConnection)(e,n,a).then(r=>this.createSession(e,t,n,r))}shutdown(){var e;this.isShutdown=!0,null===(e=this.session)||void 0===e||e.close(),this.session=null}}t.Http2SubchannelConnector=I},55541:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uriToString=t.splitHostPort=t.parseUri=void 0;let n=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function r(e){let t=n.exec(e);return null===t?null:{scheme:t[1],authority:t[2],path:t[3]}}t.parseUri=r;let i=/^\d+$/;function s(e){if(e.startsWith("[")){let t=e.indexOf("]");if(-1===t)return null;let n=e.substring(1,t);if(-1===n.indexOf(":"))return null;if(!(e.length>t+1))return{host:n};if(":"!==e[t+1])return null;{let r=e.substring(t+2);return i.test(r)?{host:n,port:+r}:null}}{let t=e.split(":");return 2!==t.length?{host:e}:i.test(t[1])?{host:t[0],port:+t[1]}:null}}function a(e){let t="";return void 0!==e.scheme&&(t+=e.scheme+":"),void 0!==e.authority&&(t+="//"+e.authority+"/"),t+=e.path}t.splitHostPort=s,t.uriToString=a},13716:(e,t,n)=>{"use strict";var r,i;r={value:!0},r=r=t.im=t.J_=r=t.Cp=r=r=void 0;let s=n(89739),a=n(11101),o=n(92607),l=n(68720);r=n(90029),r=function(e){return"@type"in e&&"string"==typeof e["@type"]},function(e){e.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",e.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",e.IDEMPOTENT="IDEMPOTENT"}(i=t.Cp||(t.Cp={}));let u={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function c(e,t){return""===e?t:e+"."+t}function d(e){return e instanceof a.Service||e instanceof a.Type||e instanceof a.Enum}function h(e){return e instanceof a.Namespace||e instanceof a.Root}function f(e,t){let n=c(t,e.name);return d(e)?[[n,e]]:h(e)&&void 0!==e.nested?Object.keys(e.nested).map(t=>f(e.nested[t],n)).reduce((e,t)=>e.concat(t),[]):[]}function p(e,t){return function(n){return e.toObject(e.decode(n),t)}}function m(e){return function(t){if(Array.isArray(t))throw Error(`Failed to serialize message: expected object with ${e.name} structure, got array instead`);let n=e.fromObject(t);return e.encode(n).finish()}}function g(e){return(e||[]).reduce((e,t)=>{for(let[n,r]of Object.entries(t))"uninterpreted_option"===n?e.uninterpreted_option.push(t.uninterpreted_option):e[n]=r;return e},{deprecated:!1,idempotency_level:i.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function y(e,t,n,r){let i=e.resolvedRequestType,a=e.resolvedResponseType;return{path:"/"+t+"/"+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestSerialize:m(i),requestDeserialize:p(i,n),responseSerialize:m(a),responseDeserialize:p(a,n),originalName:s(e.name),requestType:b(i,r),responseType:b(a,r),options:g(e.parsedOptions)}}function v(e,t,n,r){let i={};for(let s of e.methodsArray)i[s.name]=y(s,t,n,r);return i}function b(e,t){let n=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:n.$type.toObject(n,u),fileDescriptorProtos:t}}function w(e,t){let n=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:n.$type.toObject(n,u),fileDescriptorProtos:t}}function S(e,t,n,r){if(e instanceof a.Service)return v(e,t,n,r);if(e instanceof a.Type)return b(e,r);if(e instanceof a.Enum)return w(e,r);throw Error("Type mismatch in reflection object handling")}function T(e,t){let n={};e.resolveAll();let r=e.toDescriptor("proto3").file.map(e=>Buffer.from(o.FileDescriptorProto.encode(e).finish()));for(let[i,s]of f(e,""))n[i]=S(s,i,t,r);return n}function C(e,t){t=t||{};let n=a.Root.fromDescriptor(e);return n.resolveAll(),T(n,t)}function E(e,t){return T((0,l.loadProtosWithOptionsSync)(e,t),t)}function x(e,t){t=t||{};let n=a.Root.fromJSON(e);return n.resolveAll(),T(n,t)}r=function(e,t){return(0,l.loadProtosWithOptions)(e,t).then(e=>T(e,t))},t.J_=E,t.im=x,r=function(e,t){return C(o.FileDescriptorSet.decode(e),t)},r=function(e,t){return C(o.FileDescriptorSet.fromObject(e),t)},(0,l.addCommonProtos)()},68720:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addCommonProtos=t.loadProtosWithOptionsSync=t.loadProtosWithOptions=void 0;let r=n(92048),i=n(55315),s=n(11101);function a(e,t){let n=e.resolvePath;e.resolvePath=(e,s)=>{if(i.isAbsolute(s))return s;for(let e of t){let t=i.join(e,s);try{return r.accessSync(t,r.constants.R_OK),t}catch(e){continue}}return process.emitWarning(`${s} not found in any of the include paths ${t}`),n(e,s)}}async function o(e,t){let n=new s.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));a(n,t.includeDirs)}let r=await n.load(e,t);return r.resolveAll(),r}function l(e,t){let n=new s.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))throw Error("The includeDirs option must be an array");a(n,t.includeDirs)}let r=n.loadSync(e,t);return r.resolveAll(),r}function u(){let e=n(56541),t=n(89987),r=n(57674),i=n(73795);s.common("api",e.nested.google.nested.protobuf.nested),s.common("descriptor",t.nested.google.nested.protobuf.nested),s.common("source_context",r.nested.google.nested.protobuf.nested),s.common("type",i.nested.google.nested.protobuf.nested)}t.loadProtosWithOptions=o,t.loadProtosWithOptionsSync=l,t.addCommonProtos=u},61417:e=>{"use strict";function t(e,t){for(var n=Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise(function(i,a){n[r]=function(e){if(s){if(s=!1,e)a(e);else{for(var t=Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}}};try{e.apply(t||null,n)}catch(e){s&&(s=!1,a(e))}})}e.exports=t},75386:(e,t)=>{"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=Array(64),i=Array(123),s=0;s<64;)i[r[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;n.encode=function(e,t,n){for(var i,s=null,a=[],o=0,l=0;t<n;){var u=e[t++];switch(l){case 0:a[o++]=r[u>>2],i=(3&u)<<4,l=1;break;case 1:a[o++]=r[i|u>>4],i=(15&u)<<2,l=2;break;case 2:a[o++]=r[i|u>>6],a[o++]=r[63&u],l=0}o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0)}return(l&&(a[o++]=r[i],a[o++]=61,1===l&&(a[o++]=61)),s)?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};var a="invalid encoding";n.decode=function(e,t,n){for(var r,s=n,o=0,l=0;l<e.length;){var u=e.charCodeAt(l++);if(61===u&&o>1)break;if(void 0===(u=i[u]))throw Error(a);switch(o){case 0:r=u,o=1;break;case 1:t[n++]=r<<2|(48&u)>>4,r=u,o=2;break;case 2:t[n++]=(15&r)<<4|(60&u)>>2,r=u,o=3;break;case 3:t[n++]=(3&r)<<6|u,o=0}}if(1===o)throw Error(a);return n-s},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},696:e=>{"use strict";function t(e,n){"string"==typeof e&&(n=e,e=void 0);var r=[];function i(e){if("string"!=typeof e){var n=s();if(t.verbose&&console.log("codegen: "+n),n="return "+n,e){for(var a=Object.keys(e),o=Array(a.length+1),l=Array(a.length),u=0;u<a.length;)o[u]=a[u],l[u]=e[a[u++]];return o[u]=n,Function.apply(null,o).apply(null,l)}return Function(n)()}for(var c=Array(arguments.length-1),d=0;d<c.length;)c[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,function(e,t){var n=c[d++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"}),d!==c.length)throw Error("parameter count mismatch");return r.push(e),i}function s(t){return"function "+(t||n||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return i.toString=s,i}e.exports=t,t.verbose=!1},33478:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},37828:(e,t,n)=>{"use strict";e.exports=s;var r=n(61417),i=n(71374)("fs");function s(e,t,n){return("function"==typeof t?(n=t,t={}):t||(t={}),n)?!t.xhr&&i&&i.readFile?i.readFile(e,function(r,i){return r&&"undefined"!=typeof XMLHttpRequest?s.xhr(e,t,n):r?n(r):n(null,t.binary?i:i.toString("utf8"))}):s.xhr(e,t,n):r(s,this,e,t)}s.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return n(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var i=0;i<r.responseText.length;++i)e.push(255&r.responseText.charCodeAt(i))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},65256:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function s(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function o(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:s,e.writeFloatBE=r?s:i,e.readFloatLE=r?a:o,e.readFloatBE=r?o:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var s=Math.floor(Math.log(t)/Math.LN2),a=8388607&Math.round(t*Math.pow(2,-s)*8388608);e((i<<31|s+127<<23|a)>>>0,n,r)}}function a(e,t,n){var r=e(t,n),i=(r>>31)*2+1,s=r>>>23&255,a=8388607&r;return 255===s?a?NaN:1/0*i:0===s?1401298464324817e-60*i*a:i*Math.pow(2,s-150)*(a+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=a.bind(null,i),e.readFloatBE=a.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function s(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function o(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:s,e.writeDoubleBE=r?s:i,e.readDoubleLE=r?a:o,e.readDoubleBE=r?o:a}():function(){function t(e,t,n,r,i,s){var a,o=r<0?1:0;if(o&&(r=-r),0===r)e(0,i,s+t),e(1/r>0?0:2147483648,i,s+n);else if(isNaN(r))e(0,i,s+t),e(2146959360,i,s+n);else if(r>17976931348623157e292)e(0,i,s+t),e((o<<31|2146435072)>>>0,i,s+n);else if(r<22250738585072014e-324)e((a=r/5e-324)>>>0,i,s+t),e((o<<31|a/4294967296)>>>0,i,s+n);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(a=r*Math.pow(2,-l))>>>0,i,s+t),e((o<<31|l+1023<<20|1048576*a&1048575)>>>0,i,s+n)}}function a(e,t,n,r,i){var s=e(r,i+t),a=e(r,i+n),o=(a>>31)*2+1,l=a>>>20&2047,u=4294967296*(1048575&a)+s;return 2047===l?u?NaN:1/0*o:0===l?5e-324*o*u:o*Math.pow(2,l-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=a.bind(null,i,0,4),e.readDoubleBE=a.bind(null,s,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},71374:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},62727:(e,t)=>{"use strict";var n=t,r=n.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},i=n.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=r(e),i="";n&&(i=t.shift()+"/");for(var s=0;s<t.length;)".."===t[s]?s>0&&".."!==t[s-1]?t.splice(--s,2):n?t.splice(s,1):++s:"."===t[s]?t.splice(s,1):++s;return i+t.join("/")};n.resolve=function(e,t,n){return(n||(t=i(t)),r(t))?t:(n||(e=i(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?i(e+"/"+t):t)}},26733:e=>{"use strict";function t(e,t,n){var r=n||8192,i=r>>>1,s=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(s=e(r),a=0);var o=t.call(s,a,a+=n);return 7&a&&(a=(7|a)+1),o}}e.exports=t},93670:(e,t)=>{"use strict";var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:(64512&n)==55296&&(64512&e.charCodeAt(r+1))==56320?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,s=[],a=0;t<n;)(r=e[t++])<128?s[a++]=r:r>191&&r<224?s[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[a++]=55296+(r>>10),s[a++]=56320+(1023&r)):s[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))},n.write=function(e,t,n){for(var r,i,s=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:((64512&r)==55296&&(64512&(i=e.charCodeAt(a+1)))==56320?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128):t[n++]=r>>12|224,t[n++]=r>>6&63|128),t[n++]=63&r|128);return n-s}},89739:e=>{var t=1/0,n="[object Symbol]",r=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,i=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s="\ud800-\udfff",a="\\u0300-\\u036f\\ufe20-\\ufe23",o="\\u20d0-\\u20f0",l="\\u2700-\\u27bf",u="a-z\\xdf-\\xf6\\xf8-\\xff",c="A-Z\\xc0-\\xd6\\xd8-\\xde",d="\\ufe0e\\ufe0f",h="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",f="[']",p="["+s+"]",m="["+h+"]",g="["+a+o+"]",y="\\d+",v="["+l+"]",b="["+u+"]",w="[^"+s+h+y+l+u+c+"]",S="\ud83c[\udffb-\udfff]",T="[^"+s+"]",C="(?:\ud83c[\udde6-\uddff]){2}",E="[\ud800-\udbff][\udc00-\udfff]",x="["+c+"]",_="\\u200d",I="(?:"+b+"|"+w+")",k="(?:"+x+"|"+w+")",D="(?:"+f+"(?:d|ll|m|re|s|t|ve))?",R="(?:"+f+"(?:D|LL|M|RE|S|T|VE))?",N="(?:"+g+"|"+S+")?",A="["+d+"]?",O="(?:"+_+"(?:"+[T,C,E].join("|")+")"+A+N+")*",M=A+N+O,P="(?:"+[v,C,E].join("|")+")"+M,L="(?:"+[T+g+"?",g,C,E,p].join("|")+")",B=RegExp(f,"g"),F=RegExp(g,"g"),j=RegExp(S+"(?="+S+")|"+L+M,"g"),V=RegExp([x+"?"+b+"+"+D+"(?="+[m,x,"$"].join("|")+")",k+"+"+R+"(?="+[m,x+I,"$"].join("|")+")",x+"?"+I+"+"+D,x+"+"+R,y,P].join("|"),"g"),U=RegExp("["+_+s+a+o+d+"]"),z=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,q={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},W="object"==typeof global&&global&&global.Object===Object&&global,$="object"==typeof self&&self&&self.Object===Object&&self,H=W||$||Function("return this")();function G(e,t,n,r){var i=-1,s=e?e.length:0;for(r&&s&&(n=e[++i]);++i<s;)n=t(n,e[i],i,e);return n}function K(e){return e.split("")}function Q(e){return e.match(r)||[]}var Y=function(e){return function(t){return null==e?void 0:e[t]}}(q);function J(e){return U.test(e)}function X(e){return z.test(e)}function Z(e){return J(e)?ee(e):K(e)}function ee(e){return e.match(j)||[]}function et(e){return e.match(V)||[]}var en=Object.prototype.toString,er=H.Symbol,ei=er?er.prototype:void 0,es=ei?ei.toString:void 0;function ea(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(i);++r<i;)s[r]=e[r+t];return s}function eo(e){if("string"==typeof e)return e;if(ed(e))return es?es.call(e):"";var n=e+"";return"0"==n&&1/e==-t?"-0":n}function el(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:ea(e,t,n)}function eu(e){return function(t){var n=J(t=eh(t))?Z(t):void 0,r=n?n[0]:t.charAt(0),i=n?el(n,1).join(""):t.slice(1);return r[e]()+i}}function ec(e){return!!e&&"object"==typeof e}function ed(e){return"symbol"==typeof e||ec(e)&&en.call(e)==n}function eh(e){return null==e?"":eo(e)}var ef=function(e){return function(t){return G(ey(em(t).replace(B,"")),e,"")}}(function(e,t,n){return t=t.toLowerCase(),e+(n?ep(t):t)});function ep(e){return eg(eh(e).toLowerCase())}function em(e){return(e=eh(e))&&e.replace(i,Y).replace(F,"")}var eg=eu("toUpperCase");function ey(e,t,n){return(e=eh(e),void 0===(t=n?void 0:t))?X(e)?et(e):Q(e):e.match(t)||[]}e.exports=ef},69374:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{DOMAttributeNames:function(){return r},default:function(){return a},isEqualNode:function(){return s}});let r={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"};function i(e){let{type:t,props:n}=e,i=document.createElement(t);for(let e in n){if(!n.hasOwnProperty(e)||"children"===e||"dangerouslySetInnerHTML"===e||void 0===n[e])continue;let s=r[e]||e.toLowerCase();"script"===t&&("async"===s||"defer"===s||"noModule"===s)?i[s]=!!n[e]:i.setAttribute(s,n[e])}let{children:s,dangerouslySetInnerHTML:a}=n;return a?i.innerHTML=a.__html||"":s&&(i.textContent="string"==typeof s?s:Array.isArray(s)?s.join(""):""),i}function s(e,t){if(e instanceof HTMLElement&&t instanceof HTMLElement){let n=t.getAttribute("nonce");if(n&&!e.getAttribute("nonce")){let r=t.cloneNode(!0);return r.setAttribute("nonce",""),r.nonce=n,n===e.nonce&&e.isEqualNode(r)}}return e.isEqualNode(t)}function a(){return{mountedInstances:new Set,updateHead:e=>{let t={};e.forEach(e=>{if("link"===e.type&&e.props["data-optimized-fonts"]){if(document.querySelector('style[data-href="'+e.props["data-href"]+'"]'))return;e.props.href=e.props["data-href"],e.props["data-href"]=void 0}let n=t[e.type]||[];n.push(e),t[e.type]=n});let r=t.title?t.title[0]:null,i="";if(r){let{children:e}=r.props;i="string"==typeof e?e:Array.isArray(e)?e.join(""):""}i!==document.title&&(document.title=i),["meta","base","link","style","script"].forEach(e=>{n(e,t[e]||[])})}}}n=(e,t)=>{let n=document.getElementsByTagName("head")[0],r=n.querySelector("meta[name=next-head-count]"),a=Number(r.content),o=[];for(let t=0,n=r.previousElementSibling;t<a;t++,n=(null==n?void 0:n.previousElementSibling)||null){var l;(null==n?void 0:null==(l=n.tagName)?void 0:l.toLowerCase())===e&&o.push(n)}let u=t.map(i).filter(e=>{for(let t=0,n=o.length;t<n;t++)if(s(o[t],e))return o.splice(t,1),!1;return!0});o.forEach(e=>{var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),u.forEach(e=>n.insertBefore(e,r)),r.content=(a-o.length+u.length).toString()},("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},10956:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{cancelIdleCallback:function(){return r},requestIdleCallback:function(){return n}});let n="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},r="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},44064:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{default:function(){return S},handleClientScriptLoad:function(){return g},initScriptLoader:function(){return b}});let r=n(91174),i=n(58374),s=n(10326),a=r._(n(60962)),o=i._(n(17577)),l=n(81157),u=n(69374),c=n(10956),d=new Map,h=new Set,f=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"],p=e=>{if(a.default.preinit){e.forEach(e=>{a.default.preinit(e,{as:"style"})});return}},m=e=>{let{src:t,id:n,onLoad:r=()=>{},onReady:i=null,dangerouslySetInnerHTML:s,children:a="",strategy:o="afterInteractive",onError:l,stylesheets:c}=e,m=n||t;if(m&&h.has(m))return;if(d.has(t)){h.add(m),d.get(t).then(r,l);return}let g=()=>{i&&i(),h.add(m)},y=document.createElement("script"),v=new Promise((e,t)=>{y.addEventListener("load",function(t){e(),r&&r.call(this,t),g()}),y.addEventListener("error",function(e){t(e)})}).catch(function(e){l&&l(e)});for(let[n,r]of(s?(y.innerHTML=s.__html||"",g()):a?(y.textContent="string"==typeof a?a:Array.isArray(a)?a.join(""):"",g()):t&&(y.src=t,d.set(t,v)),Object.entries(e))){if(void 0===r||f.includes(n))continue;let e=u.DOMAttributeNames[n]||n.toLowerCase();y.setAttribute(e,r)}"worker"===o&&y.setAttribute("type","text/partytown"),y.setAttribute("data-nscript",o),c&&p(c),document.body.appendChild(y)};function g(e){let{strategy:t="afterInteractive"}=e;"lazyOnload"===t?window.addEventListener("load",()=>{(0,c.requestIdleCallback)(()=>m(e))}):m(e)}function y(e){"complete"===document.readyState?(0,c.requestIdleCallback)(()=>m(e)):window.addEventListener("load",()=>{(0,c.requestIdleCallback)(()=>m(e))})}function v(){[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(e=>{let t=e.id||e.getAttribute("src");h.add(t)})}function b(e){e.forEach(g),v()}function w(e){let{id:t,src:n="",onLoad:r=()=>{},onReady:i=null,strategy:u="afterInteractive",onError:c,stylesheets:d,...f}=e,{updateScripts:p,scripts:g,getIsSsr:v,appDir:b,nonce:w}=(0,o.useContext)(l.HeadManagerContext),S=(0,o.useRef)(!1);(0,o.useEffect)(()=>{let e=t||n;S.current||(i&&e&&h.has(e)&&i(),S.current=!0)},[i,t,n]);let T=(0,o.useRef)(!1);if((0,o.useEffect)(()=>{T.current||("afterInteractive"===u?m(e):"lazyOnload"===u&&y(e),T.current=!0)},[e,u]),("beforeInteractive"===u||"worker"===u)&&(p?(g[u]=(g[u]||[]).concat([{id:t,src:n,onLoad:r,onReady:i,onError:c,...f}]),p(g)):v&&v()?h.add(t||n):v&&!v()&&m(e)),b){if(d&&d.forEach(e=>{a.default.preinit(e,{as:"style"})}),"beforeInteractive"===u)return n?(a.default.preload(n,f.integrity?{as:"script",integrity:f.integrity,nonce:w,crossOrigin:f.crossOrigin}:{as:"script",nonce:w,crossOrigin:f.crossOrigin}),(0,s.jsx)("script",{nonce:w,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([n,{...f,id:t}])+")"}})):(f.dangerouslySetInnerHTML&&(f.children=f.dangerouslySetInnerHTML.__html,delete f.dangerouslySetInnerHTML),(0,s.jsx)("script",{nonce:w,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([0,{...f,id:t}])+")"}}));"afterInteractive"===u&&n&&a.default.preload(n,f.integrity?{as:"script",integrity:f.integrity,nonce:w,crossOrigin:f.crossOrigin}:{as:"script",nonce:w,crossOrigin:f.crossOrigin})}return null}Object.defineProperty(w,"__nextScript",{value:!0});let S=w;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},81157:(e,t,n)=>{"use strict";e.exports=n(81616).vendored.contexts.HeadManagerContext},92607:(e,t,n)=>{"use strict";var r=n(11101);e.exports=t=r.descriptor=r.Root.fromJSON(n(89987)).lookup(".google.protobuf");var i=r.Namespace,s=r.Root,a=r.Enum,o=r.Type,l=r.Field,u=r.MapField,c=r.OneOf,d=r.Service,h=r.Method;function f(e,n,r){var u=t.FileDescriptorProto.create({name:e.filename||(e.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});r&&(u.syntax=r),e instanceof s||(u.package=e.fullName.substring(1));for(var c,h=0;h<e.nestedArray.length;++h)(c=e._nestedArray[h])instanceof o?u.messageType.push(c.toDescriptor(r)):c instanceof a?u.enumType.push(c.toDescriptor()):c instanceof l?u.extension.push(c.toDescriptor(r)):c instanceof d?u.service.push(c.toDescriptor()):c instanceof i&&f(c,n,r);u.options=E(e.options,t.FileOptions),u.messageType.length+u.enumType.length+u.extension.length+u.service.length&&n.push(u)}s.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.FileDescriptorSet.decode(e));var n=new s;if(e.file)for(var r,i,u,c=0;c<e.file.length;++c){if(i=n,(r=e.file[c]).package&&r.package.length&&(i=n.define(r.package)),r.name&&r.name.length&&n.files.push(i.filename=r.name),r.messageType)for(u=0;u<r.messageType.length;++u)i.add(o.fromDescriptor(r.messageType[u],r.syntax));if(r.enumType)for(u=0;u<r.enumType.length;++u)i.add(a.fromDescriptor(r.enumType[u]));if(r.extension)for(u=0;u<r.extension.length;++u)i.add(l.fromDescriptor(r.extension[u]));if(r.service)for(u=0;u<r.service.length;++u)i.add(d.fromDescriptor(r.service[u]));var h=C(r.options,t.FileOptions);if(h){var f=Object.keys(h);for(u=0;u<f.length;++u)i.setOption(f[u],h[f[u]])}}return n},s.prototype.toDescriptor=function(e){var n=t.FileDescriptorSet.create();return f(this,n.file,e),n};var p=0;o.fromDescriptor=function(e,n){"number"==typeof e.length&&(e=t.DescriptorProto.decode(e));var r,i=new o(e.name.length?e.name:"Type"+p++,C(e.options,t.MessageOptions));if(e.oneofDecl)for(r=0;r<e.oneofDecl.length;++r)i.add(c.fromDescriptor(e.oneofDecl[r]));if(e.field)for(r=0;r<e.field.length;++r){var s=l.fromDescriptor(e.field[r],n);i.add(s),e.field[r].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[r].oneofIndex].add(s)}if(e.extension)for(r=0;r<e.extension.length;++r)i.add(l.fromDescriptor(e.extension[r],n));if(e.nestedType)for(r=0;r<e.nestedType.length;++r)i.add(o.fromDescriptor(e.nestedType[r],n)),e.nestedType[r].options&&e.nestedType[r].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(r=0;r<e.enumType.length;++r)i.add(a.fromDescriptor(e.enumType[r]));if(e.extensionRange&&e.extensionRange.length)for(r=0,i.extensions=[];r<e.extensionRange.length;++r)i.extensions.push([e.extensionRange[r].start,e.extensionRange[r].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(r=0;r<e.reservedRange.length;++r)i.reserved.push([e.reservedRange[r].start,e.reservedRange[r].end]);if(e.reservedName)for(r=0;r<e.reservedName.length;++r)i.reserved.push(e.reservedName[r])}return i},o.prototype.toDescriptor=function(e){var n,r,i=t.DescriptorProto.create({name:this.name});for(r=0;r<this.fieldsArray.length;++r)if(i.field.push(n=this._fieldsArray[r].toDescriptor(e)),this._fieldsArray[r]instanceof u){var s=T(this._fieldsArray[r].keyType,this._fieldsArray[r].resolvedKeyType),c=T(this._fieldsArray[r].type,this._fieldsArray[r].resolvedType),d=11===c||14===c?this._fieldsArray[r].resolvedType&&x(this.parent,this._fieldsArray[r].resolvedType)||this._fieldsArray[r].type:void 0;i.nestedType.push(t.DescriptorProto.create({name:n.typeName,field:[t.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),t.FieldDescriptorProto.create({name:"value",number:2,label:1,type:c,typeName:d})],options:t.MessageOptions.create({mapEntry:!0})}))}for(r=0;r<this.oneofsArray.length;++r)i.oneofDecl.push(this._oneofsArray[r].toDescriptor());for(r=0;r<this.nestedArray.length;++r)this._nestedArray[r]instanceof l?i.field.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof o?i.nestedType.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof a&&i.enumType.push(this._nestedArray[r].toDescriptor());if(this.extensions)for(r=0;r<this.extensions.length;++r)i.extensionRange.push(t.DescriptorProto.ExtensionRange.create({start:this.extensions[r][0],end:this.extensions[r][1]}));if(this.reserved)for(r=0;r<this.reserved.length;++r)"string"==typeof this.reserved[r]?i.reservedName.push(this.reserved[r]):i.reservedRange.push(t.DescriptorProto.ReservedRange.create({start:this.reserved[r][0],end:this.reserved[r][1]}));return i.options=E(this.options,t.MessageOptions),i};var m=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function(e,n){if("number"==typeof e.length&&(e=t.DescriptorProto.decode(e)),"number"!=typeof e.number)throw Error("missing field id");switch(r=e.typeName&&e.typeName.length?e.typeName:w(e.type),e.label){case 1:i=void 0;break;case 2:i="required";break;case 3:i="repeated";break;default:throw Error("illegal label: "+e.label)}var r,i,s=e.extendee;void 0!==e.extendee&&(s=s.length?s:void 0);var a=new l(e.name.length?e.name:"field"+e.number,e.number,r,i,s);if(a.options=C(e.options,t.FieldOptions),e.defaultValue&&e.defaultValue.length){var o=e.defaultValue;switch(o){case"true":case"TRUE":o=!0;break;case"false":case"FALSE":o=!1;break;default:m.exec(o)&&(o=parseInt(o))}a.setOption("default",o)}return S(e.type)&&("proto3"===n?e.options&&!e.options.packed&&a.setOption("packed",!1):e.options&&e.options.packed||a.setOption("packed",!1)),a},l.prototype.toDescriptor=function(e){var n=t.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)n.type=11,n.typeName=r.util.ucFirst(this.name),n.label=3;else{switch(n.type=T(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:n.typeName=this.resolvedType?x(this.parent,this.resolvedType):this.type}switch(this.rule){case"repeated":n.label=3;break;case"required":n.label=2;break;default:n.label=1}}if(n.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(n.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(n.options=E(this.options,t.FieldOptions),null!=this.options.default&&(n.defaultValue=String(this.options.default))),"proto3"===e?this.packed||((n.options||(n.options=t.FieldOptions.create())).packed=!1):this.packed&&((n.options||(n.options=t.FieldOptions.create())).packed=!0),n};var g=0;a.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.EnumDescriptorProto.decode(e));var n={};if(e.value)for(var r=0;r<e.value.length;++r){var i=e.value[r].name,s=e.value[r].number||0;n[i&&i.length?i:"NAME"+s]=s}return new a(e.name&&e.name.length?e.name:"Enum"+g++,n,C(e.options,t.EnumOptions))},a.prototype.toDescriptor=function(){for(var e=[],n=0,r=Object.keys(this.values);n<r.length;++n)e.push(t.EnumValueDescriptorProto.create({name:r[n],number:this.values[r[n]]}));return t.EnumDescriptorProto.create({name:this.name,value:e,options:E(this.options,t.EnumOptions)})};var y=0;c.fromDescriptor=function(e){return"number"==typeof e.length&&(e=t.OneofDescriptorProto.decode(e)),new c(e.name&&e.name.length?e.name:"oneof"+y++)},c.prototype.toDescriptor=function(){return t.OneofDescriptorProto.create({name:this.name})};var v=0;d.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.ServiceDescriptorProto.decode(e));var n=new d(e.name&&e.name.length?e.name:"Service"+v++,C(e.options,t.ServiceOptions));if(e.method)for(var r=0;r<e.method.length;++r)n.add(h.fromDescriptor(e.method[r]));return n},d.prototype.toDescriptor=function(){for(var e=[],n=0;n<this.methodsArray.length;++n)e.push(this._methodsArray[n].toDescriptor());return t.ServiceDescriptorProto.create({name:this.name,method:e,options:E(this.options,t.ServiceOptions)})};var b=0;function w(e){switch(e){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+e)}function S(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function T(e,t){switch(e){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(t instanceof a)return 14;if(t instanceof o)return t.group?10:11;throw Error("illegal type: "+e)}function C(e,t){if(e){for(var n,i,s,o=[],l=0;l<t.fieldsArray.length;++l)"uninterpretedOption"!==(i=(n=t._fieldsArray[l]).name)&&e.hasOwnProperty(i)&&(s=e[i],n.resolvedType instanceof a&&"number"==typeof s&&void 0!==n.resolvedType.valuesById[s]&&(s=n.resolvedType.valuesById[s]),o.push(_(i),s));return o.length?r.util.toObject(o):void 0}}function E(e,t){if(e){for(var n,i,s=[],a=0,o=Object.keys(e);a<o.length;++a)if(i=e[n=o[a]],"default"!==n){var l=t.fields[n];(l||(l=t.fields[n=r.util.camelCase(n)]))&&s.push(n,i)}return s.length?t.fromObject(r.util.toObject(s)):void 0}}function x(e,t){var n=e.fullName.split("."),r=t.fullName.split("."),a=0,o=0,l=r.length-1;if(!(e instanceof s)&&t instanceof i)for(;a<n.length&&o<l&&n[a]===r[o];){var u=t.lookup(n[a++],!0);if(null!==u&&u!==t)break;++o}else for(;a<n.length&&o<l&&n[a]===r[o];++a,++o);return r.slice(o).join(".")}function _(e){return e.substring(0,1)+e.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}h.fromDescriptor=function(e){return"number"==typeof e.length&&(e=t.MethodDescriptorProto.decode(e)),new h(e.name&&e.name.length?e.name:"Method"+b++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,C(e.options,t.MethodOptions))},h.prototype.toDescriptor=function(){return t.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:E(this.options,t.MethodOptions)})}},11101:(e,t,n)=>{"use strict";e.exports=n(28582)},23980:e=>{"use strict";e.exports=r;var t,n=/\/|\./;function r(e,t){n.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),r[e]=t}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),r("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),r("timestamp",{Timestamp:t}),r("empty",{Empty:{fields:{}}}),r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),r.get=function(e){return r[e]||null}},85711:(e,t,n)=>{"use strict";var r=t,i=n(71114),s=n(84615);function a(e,t,n,r){var s=!1;if(t.resolvedType){if(t.resolvedType instanceof i){e("switch(d%s){",r);for(var a=t.resolvedType.values,o=Object.keys(a),l=0;l<o.length;++l)a[o[l]]!==t.typeDefault||s||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),t.repeated||e("break"),s=!0),e("case%j:",o[l])("case %i:",a[o[l]])("m%s=%j",r,a[o[l]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r)}else{var u=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":u=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,u)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,u?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function o(e,t,n,r){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,n,r,r,n,r,r):e("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var s=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":s=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,s?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,n=s.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var o=t[r].resolve(),l=s.safeProp(o.name);o.map?(n("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",o.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),a(n,o,r,l+"[ks[i]]")("}")("}")):o.repeated?(n("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",o.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),a(n,o,r,l+"[i]")("}")("}")):(o.resolvedType instanceof i||n("if(d%s!=null){",l),a(n,o,r,l),o.resolvedType instanceof i||n("}"))}return n("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()("return {}");for(var n=s.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],a=[],l=[],u=0;u<t.length;++u)t[u].partOf||(t[u].resolve().repeated?r:t[u].map?a:l).push(t[u]);if(r.length){for(n("if(o.arrays||o.defaults){"),u=0;u<r.length;++u)n("d%s=[]",s.safeProp(r[u].name));n("}")}if(a.length){for(n("if(o.objects||o.defaults){"),u=0;u<a.length;++u)n("d%s={}",s.safeProp(a[u].name));n("}")}if(l.length){for(n("if(o.defaults){"),u=0;u<l.length;++u){var c=l[u],d=s.safeProp(c.name);if(c.resolvedType instanceof i)n("d%s=o.enums===String?%j:%j",d,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var h="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else n("d%s=%j",d,c.typeDefault)}n("}")}var f=!1;for(u=0;u<t.length;++u){var c=t[u],p=e._fieldsArray.indexOf(c),d=s.safeProp(c.name);c.map?(f||(f=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),o(n,c,p,d+"[ks2[j]]")("}")):c.repeated?(n("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),o(n,c,p,d+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",d,c.name),o(n,c,p,d),c.partOf&&n("if(o.oneofs)")("d%s=%j",s.safeProp(c.partOf.name),c.name)),n("}")}return n("return d")}},31526:(e,t,n)=>{"use strict";e.exports=o;var r=n(71114),i=n(76160),s=n(84615);function a(e){return"missing required '"+e.name+"'"}function o(e){var t=s.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter(function(e){return e.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var n=0;n<e.fieldsArray.length;++n){var o=e._fieldsArray[n].resolve(),l=o.resolvedType instanceof r?"int32":o.type,u="m"+s.safeProp(o.name);t("case %i: {",o.id),o.map?(t("if(%s===util.emptyObject)",u)("%s={}",u)("var c2 = r.uint32()+r.pos"),void 0!==i.defaults[o.keyType]?t("k=%j",i.defaults[o.keyType]):t("k=null"),void 0!==i.defaults[l]?t("value=%j",i.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",o.keyType)("case 2:"),void 0===i.basic[l]?t("value=types[%i].decode(r,r.uint32())",n):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),t(void 0!==i.long[o.keyType]?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",u)):o.repeated?(t("if(!(%s&&%s.length))",u,u)("%s=[]",u),void 0!==i.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",u,l)("}else"),void 0===i.basic[l]?t(o.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",u,n):t("%s.push(r.%s())",u,l)):void 0===i.basic[l]?t(o.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",u,n):t("%s=r.%s()",u,l),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var c=e._fieldsArray[n];c.required&&t("if(!m.hasOwnProperty(%j))",c.name)("throw util.ProtocolError(%j,{instance:m})",a(c))}return t("return m")}},38455:(e,t,n)=>{"use strict";e.exports=o;var r=n(71114),i=n(76160),s=n(84615);function a(e,t,n,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(t.id<<3|2)>>>0)}function o(e){for(var t,n,o=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),l=e.fieldsArray.slice().sort(s.compareFieldsById),t=0;t<l.length;++t){var u=l[t].resolve(),c=e._fieldsArray.indexOf(u),d=u.resolvedType instanceof r?"int32":u.type,h=i.basic[d];n="m"+s.safeProp(u.name),u.map?(o("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,u.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(u.id<<3|2)>>>0,8|i.mapKey[u.keyType],u.keyType),void 0===h?o("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",c,n):o(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,n),o("}")("}")):u.repeated?(o("if(%s!=null&&%s.length){",n,n),u.packed&&void 0!==i.packed[d]?o("w.uint32(%i).fork()",(u.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",d,n)("w.ldelim()"):(o("for(var i=0;i<%s.length;++i)",n),void 0===h?a(o,u,c,n+"[i]"):o("w.uint32(%i).%s(%s[i])",(u.id<<3|h)>>>0,d,n)),o("}")):(u.optional&&o("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,u.name),void 0===h?a(o,u,c,n):o("w.uint32(%i).%s(%s)",(u.id<<3|h)>>>0,d,n))}return o("return w")}},71114:(e,t,n)=>{"use strict";e.exports=a;var r=n(3514);((a.prototype=Object.create(r.prototype)).constructor=a).className="Enum";var i=n(4943),s=n(84615);function a(e,t,n,i,s,a){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=s||{},this.valuesOptions=a,this.reserved=void 0,t)for(var o=Object.keys(t),l=0;l<o.length;++l)"number"==typeof t[o[l]]&&(this.valuesById[this.values[o[l]]=t[o[l]]]=o[l])}a.fromJSON=function(e,t){var n=new a(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,n,r){if(!s.isString(e))throw TypeError("name must be a string");if(!s.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=n||null,this},a.prototype.remove=function(e){if(!s.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},a.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},37510:(e,t,n)=>{"use strict";e.exports=u;var r,i=n(3514);((u.prototype=Object.create(i.prototype)).constructor=u).className="Field";var s=n(71114),a=n(76160),o=n(84615),l=/^required|optional|repeated$/;function u(e,t,n,r,s,u,c){if(o.isObject(r)?(c=s,u=r,r=s=void 0):o.isObject(s)&&(c=u,u=s,s=void 0),i.call(this,e,u),!o.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!o.isString(n))throw TypeError("type must be a string");if(void 0!==r&&!l.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==s&&!o.isString(s))throw TypeError("extend must be a string");"proto3_optional"===r&&(r="optional"),this.rule=r&&"optional"!==r?r:void 0,this.type=n,this.id=t,this.extend=s||void 0,this.required="required"===r,this.optional=!this.required,this.repeated="repeated"===r,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!o.Long&&void 0!==a.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=c}u.fromJSON=function(e,t){return new u(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(u.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),u.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),i.prototype.setOption.call(this,e,t,n)},u.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return o.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},u.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof r?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof s&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof s)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=o.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;o.base64.test(this.typeDefault)?o.base64.decode(this.typeDefault,e=o.newBuffer(o.base64.length(this.typeDefault)),0):o.utf8.write(this.typeDefault,e=o.newBuffer(o.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=o.emptyObject:this.repeated?this.defaultValue=o.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof r&&(this.parent.ctor.prototype[this.name]=this.defaultValue),i.prototype.resolve.call(this)},u.d=function(e,t,n,r){return"function"==typeof t?t=o.decorateType(t).name:t&&"object"==typeof t&&(t=o.decorateEnum(t).name),function(i,s){o.decorateType(i.constructor).add(new u(s,e,t,n,{default:r}))}},u._configure=function(e){r=e}},34630:(e,t,n)=>{"use strict";var r=e.exports=n(38690);function i(e,t,n){return"function"==typeof t?(n=t,t=new r.Root):t||(t=new r.Root),t.load(e,n)}function s(e,t){return t||(t=new r.Root),t.loadSync(e)}r.build="light",r.load=i,r.loadSync=s,r.encoder=n(38455),r.decoder=n(31526),r.verifier=n(91506),r.converter=n(85711),r.ReflectionObject=n(3514),r.Namespace=n(4943),r.Root=n(54343),r.Enum=n(71114),r.Type=n(3839),r.Field=n(37510),r.OneOf=n(92695),r.MapField=n(79538),r.Service=n(31631),r.Method=n(26539),r.Message=n(92936),r.wrappers=n(39579),r.types=n(76160),r.util=n(84615),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},38690:(e,t,n)=>{"use strict";var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(98458),r.BufferWriter=n(68386),r.Reader=n(42279),r.BufferReader=n(80424),r.util=n(90745),r.rpc=n(84774),r.roots=n(59694),r.configure=i,i()},28582:(e,t,n)=>{"use strict";var r=e.exports=n(34630);r.build="full",r.tokenize=n(99867),r.parse=n(16614),r.common=n(23980),r.Root._configure(r.Type,r.parse,r.common)},79538:(e,t,n)=>{"use strict";e.exports=a;var r=n(37510);((a.prototype=Object.create(r.prototype)).constructor=a).className="MapField";var i=n(76160),s=n(84615);function a(e,t,n,i,a,o){if(r.call(this,e,t,i,void 0,void 0,a,o),!s.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},a.d=function(e,t,n){return"function"==typeof n?n=s.decorateType(n).name:n&&"object"==typeof n&&(n=s.decorateEnum(n).name),function(r,i){s.decorateType(r.constructor).add(new a(i,e,t,n))}}},92936:(e,t,n)=>{"use strict";e.exports=i;var r=n(90745);function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},26539:(e,t,n)=>{"use strict";e.exports=s;var r=n(3514);((s.prototype=Object.create(r.prototype)).constructor=s).className="Method";var i=n(84615);function s(e,t,n,s,a,o,l,u,c){if(i.isObject(a)?(l=a,a=o=void 0):i.isObject(o)&&(l=o,o=void 0),!(void 0===t||i.isString(t)))throw TypeError("type must be a string");if(!i.isString(n))throw TypeError("requestType must be a string");if(!i.isString(s))throw TypeError("responseType must be a string");r.call(this,e,l),this.type=t||"rpc",this.requestType=n,this.requestStream=!!a||void 0,this.responseType=s,this.responseStream=!!o||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=u,this.parsedOptions=c}s.fromJSON=function(e,t){return new s(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},s.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return i.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},s.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},4943:(e,t,n)=>{"use strict";e.exports=d;var r,i,s,a=n(3514);((d.prototype=Object.create(a.prototype)).constructor=d).className="Namespace";var o=n(37510),l=n(84615),u=n(92695);function c(e,t){if(e&&e.length){for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}}function d(e,t){a.call(this,e,t),this.nested=void 0,this._nestedArray=null}function h(e){return e._nestedArray=null,e}d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=c,d.isReservedId=function(e,t){if(e){for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0}return!1},d.isReservedName=function(e,t){if(e){for(var n=0;n<e.length;++n)if(e[n]===t)return!0}return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),d.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",c(this.nestedArray,e)])},d.prototype.addJSON=function(e){var t=this;if(e)for(var n,a=Object.keys(e),l=0;l<a.length;++l)n=e[a[l]],t.add((void 0!==n.fields?r.fromJSON:void 0!==n.values?s.fromJSON:void 0!==n.methods?i.fromJSON:void 0!==n.id?o.fromJSON:d.fromJSON)(a[l],n));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof s)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof o&&void 0!==e.extend||e instanceof r||e instanceof u||e instanceof s||e instanceof i||e instanceof d))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(t instanceof d&&e instanceof d&&!(t instanceof r||t instanceof i)){for(var n=t.nestedArray,a=0;a<n.length;++a)e.add(n[a]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),h(this)},d.prototype.remove=function(e){if(!(e instanceof a))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),h(this)},d.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof d))throw Error("path conflicts with non-namespace objects")}else n.add(n=new d(r))}return t&&n.addJSON(t),n},d.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this.resolve()},d.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof d&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof d&&(r=this._nestedArray[i].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},d.prototype.lookupType=function(e){var t=this.lookup(e,[r]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[r,s]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(e,t,n){r=e,i=t,s=n}},3514:(e,t,n)=>{"use strict";e.exports=s,s.className="ReflectionObject";var r,i=n(84615);function s(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(s.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),s.prototype.toJSON=function(){throw Error()},s.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},s.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},s.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},s.prototype.getOption=function(e){if(this.options)return this.options[e]},s.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},s.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var s=r.find(function(t){return Object.prototype.hasOwnProperty.call(t,e)});if(s){var a=s[e];i.setProperty(a,n,t)}else(s={})[e]=i.setProperty({},n,t),r.push(s)}else{var o={};o[e]=t,r.push(o)}return this},s.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},s.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},s._configure=function(e){r=e}},92695:(e,t,n)=>{"use strict";e.exports=a;var r=n(3514);((a.prototype=Object.create(r.prototype)).constructor=a).className="OneOf";var i=n(37510),s=n(84615);function a(e,t,n,i){if(Array.isArray(t)||(n=t,t=void 0),r.call(this,e,n),!(void 0===t||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function o(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,o(this),this},a.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=this,n=0;n<this.oneof.length;++n){var i=e.get(this.oneof[n]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}o(this)},a.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},a.d=function(){for(var e=Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){s.decorateType(t.constructor).add(new a(n,e)),Object.defineProperty(t,n,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},16614:(e,t,n)=>{"use strict";e.exports=E,E.filename=null,E.defaults={keepCase:!1};var r=n(99867),i=n(54343),s=n(3839),a=n(37510),o=n(79538),l=n(92695),u=n(71114),c=n(31631),d=n(26539),h=n(76160),f=n(84615),p=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,v=/^0[0-7]+$/,b=/^-?0[0-7]+$/,w=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,T=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,C=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function E(e,t,n){t instanceof i||(n=t,t=new i),n||(n=E.defaults);var x,_,I,k,D,R=n.preferTrailingComment||!1,N=r(e,n.alternateCommentMode||!1),A=N.next,O=N.push,M=N.peek,P=N.skip,L=N.cmnt,B=!0,F=!1,j=t,V=n.keepCase?function(e){return e}:f.camelCase;function U(e,t,n){var r=E.filename;return n||(E.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(r?r+", ":"")+"line "+N.line+")")}function z(){var e,t=[];do{if('"'!==(e=A())&&"'"!==e)throw U(e);t.push(A()),P(e),e=M()}while('"'===e||"'"===e);return t.join("")}function q(e){var t=A();switch(t){case"'":case'"':return O(t),z();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return $(t,!0)}catch(n){if(e&&T.test(t))return t;throw U(t,"value")}}function W(e,t){do t&&('"'===(n=M())||"'"===n)?e.push(z()):e.push([r=H(A()),P("to",!0)?H(A()):r]);while(P(",",!0));var n,r,i={options:void 0};i.setOption=function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t},J(i,function(e){if("option"===e)es(i,e),P(";");else throw U(e)},function(){eu(i)})}function $(e,t){var n=1;switch("-"===e.charAt(0)&&(n=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return 1/0*n;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return n*parseInt(e,10);if(g.test(e))return n*parseInt(e,16);if(v.test(e))return n*parseInt(e,8);if(w.test(e))return n*parseFloat(e);throw U(e,"number",t)}function H(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw U(e,"id");if(m.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw U(e,"id")}function G(){if(void 0!==_)throw U("package");if(_=A(),!T.test(_))throw U(_,"name");j=j.define(_),P(";")}function K(){var e,t=M();switch(t){case"weak":e=k||(k=[]),A();break;case"public":A();default:e=I||(I=[])}t=z(),P(";"),e.push(t)}function Q(){if(P("="),!(F="proto3"===(D=z()))&&"proto2"!==D)throw U(D,"syntax");t.setOption("syntax",D),P(";")}function Y(e,t){switch(t){case"option":return es(e,t),P(";"),!0;case"message":return X(e,t),!0;case"enum":return er(e,t),!0;case"service":return ec(e,t),!0;case"extend":return eh(e,t),!0}return!1}function J(e,t,n){var r,i=N.line;if(e&&("string"!=typeof e.comment&&(e.comment=L()),e.filename=E.filename),P("{",!0)){for(;"}"!==(r=A());)t(r);P(";",!0)}else n&&n(),P(";"),e&&("string"!=typeof e.comment||R)&&(e.comment=L(i)||e.comment)}function X(e,t){if(!S.test(t=A()))throw U(t,"type name");var n=new s(t);J(n,function(e){if(!Y(n,e))switch(e){case"map":et(n,e);break;case"required":case"repeated":Z(n,e);break;case"optional":F?Z(n,"proto3_optional"):Z(n,"optional");break;case"oneof":en(n,e);break;case"extensions":W(n.extensions||(n.extensions=[]));break;case"reserved":W(n.reserved||(n.reserved=[]),!0);break;default:if(!F||!T.test(e))throw U(e);O(e),Z(n,"optional")}}),e.add(n)}function Z(e,t,n){var r=A();if("group"===r){ee(e,t);return}for(;r.endsWith(".")||M().startsWith(".");)r+=A();if(!T.test(r))throw U(r,"type");var i=A();if(!S.test(i))throw U(i,"name");i=V(i),P("=");var s=new a(i,H(A()),r,t,n);if(J(s,function(e){if("option"===e)es(s,e),P(";");else throw U(e)},function(){eu(s)}),"proto3_optional"===t){var o=new l("_"+i);s.setOption("proto3_optional",!0),o.add(s),e.add(o)}else e.add(s);!F&&s.repeated&&(void 0!==h.packed[r]||void 0===h.basic[r])&&s.setOption("packed",!1,!0)}function ee(e,t){var n=A();if(!S.test(n))throw U(n,"name");var r=f.lcFirst(n);n===r&&(n=f.ucFirst(n)),P("=");var i=H(A()),o=new s(n);o.group=!0;var l=new a(r,i,n,t);l.filename=E.filename,J(o,function(e){switch(e){case"option":es(o,e),P(";");break;case"required":case"repeated":Z(o,e);break;case"optional":F?Z(o,"proto3_optional"):Z(o,"optional");break;case"message":X(o,e);break;case"enum":er(o,e);break;default:throw U(e)}}),e.add(o).add(l)}function et(e){P("<");var t=A();if(void 0===h.mapKey[t])throw U(t,"type");P(",");var n=A();if(!T.test(n))throw U(n,"type");P(">");var r=A();if(!S.test(r))throw U(r,"name");P("=");var i=new o(V(r),H(A()),t,n);J(i,function(e){if("option"===e)es(i,e),P(";");else throw U(e)},function(){eu(i)}),e.add(i)}function en(e,t){if(!S.test(t=A()))throw U(t,"name");var n=new l(V(t));J(n,function(e){"option"===e?(es(n,e),P(";")):(O(e),Z(n,"optional"))}),e.add(n)}function er(e,t){if(!S.test(t=A()))throw U(t,"name");var n=new u(t);J(n,function(e){switch(e){case"option":es(n,e),P(";");break;case"reserved":W(n.reserved||(n.reserved=[]),!0);break;default:ei(n,e)}}),e.add(n)}function ei(e,t){if(!S.test(t))throw U(t,"name");P("=");var n=H(A(),!0),r={options:void 0};r.setOption=function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t},J(r,function(e){if("option"===e)es(r,e),P(";");else throw U(e)},function(){eu(r)}),e.add(t,n,r.comment,r.options)}function es(e,t){var n,r=P("(",!0);if(!T.test(t=A()))throw U(t,"name");var i=t,s=i;r&&(P(")"),s=i="("+i+")",t=M(),C.test(t)&&(n=t.slice(1),i+=t,A())),P("=");var a=ea(e,i);el(e,s,a,n)}function ea(e,t){if(P("{",!0)){for(var n={};!P("}",!0);){if(!S.test(x=A()))throw U(x,"name");if(null===x)throw U(x,"end of input");var r,i,s=x;if(P(":",!0),"{"===M())r=ea(e,t+"."+x);else if("["===M()){if(r=[],P("[",!0)){do i=q(!0),r.push(i);while(P(",",!0));P("]"),void 0!==i&&eo(e,t+"."+x,i)}}else r=q(!0),eo(e,t+"."+x,r);var a=n[s];a&&(r=[].concat(a).concat(r)),n[s]=r,P(",",!0),P(";",!0)}return n}var o=q(!0);return eo(e,t,o),o}function eo(e,t,n){e.setOption&&e.setOption(t,n)}function el(e,t,n,r){e.setParsedOption&&e.setParsedOption(t,n,r)}function eu(e){if(P("[",!0)){do es(e,"option");while(P(",",!0));P("]")}return e}function ec(e,t){if(!S.test(t=A()))throw U(t,"service name");var n=new c(t);J(n,function(e){if(!Y(n,e)){if("rpc"===e)ed(n,e);else throw U(e)}}),e.add(n)}function ed(e,t){var n=L(),r=t;if(!S.test(t=A()))throw U(t,"name");var i,s,a,o,l=t;if(P("("),P("stream",!0)&&(s=!0),!T.test(t=A())||(i=t,P(")"),P("returns"),P("("),P("stream",!0)&&(o=!0),!T.test(t=A())))throw U(t);a=t,P(")");var u=new d(l,r,i,a,s,o);u.comment=n,J(u,function(e){if("option"===e)es(u,e),P(";");else throw U(e)}),e.add(u)}function eh(e,t){if(!T.test(t=A()))throw U(t,"reference");var n=t;J(null,function(t){switch(t){case"required":case"repeated":Z(e,t,n);break;case"optional":F?Z(e,"proto3_optional",n):Z(e,"optional",n);break;default:if(!F||!T.test(t))throw U(t);O(t),Z(e,"optional",n)}})}for(;null!==(x=A());)switch(x){case"package":if(!B)throw U(x);G();break;case"import":if(!B)throw U(x);K();break;case"syntax":if(!B)throw U(x);Q();break;case"option":es(j,x),P(";");break;default:if(Y(j,x)){B=!1;continue}throw U(x)}return E.filename=null,{package:_,imports:I,weakImports:k,syntax:D,root:t}}},42279:(e,t,n)=>{"use strict";e.exports=l;var r,i=n(90745),s=i.LongBits,a=i.utf8;function o(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},c=function(){return i.Buffer?function(e){return(l.create=function(e){return i.Buffer.isBuffer(e)?new r(e):u(e)})(e)}:u};function d(){var e=new s(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw o(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw o(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw o(this,8);return new s(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}l.create=c(),l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,l.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return e}}(),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return h(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|h(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw o(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var r=i.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw o(this,e);this.pos+=e}else do if(this.pos>=this.len)throw o(this);while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){r=e,l.create=c(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},80424:(e,t,n)=>{"use strict";e.exports=s;var r=n(42279);(s.prototype=Object.create(r.prototype)).constructor=s;var i=n(90745);function s(e){r.call(this,e)}s._configure=function(){i.Buffer&&(s.prototype._slice=i.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},54343:(e,t,n)=>{"use strict";e.exports=d;var r,i,s,a=n(4943);((d.prototype=Object.create(a.prototype)).constructor=d).className="Root";var o=n(37510),l=n(71114),u=n(92695),c=n(84615);function d(e){a.call(this,"",e),this.deferred=[],this.files=[]}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=c.path.resolve,d.prototype.fetch=c.fetch,d.prototype.load=function e(t,n,r){"function"==typeof n&&(r=n,n=void 0);var a=this;if(!r)return c.asPromise(e,a,t,n);var o=r===h;function l(e,t){if(r){if(o)throw e;var n=r;r=null,n(e,t)}}function u(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in s)return n}return null}function d(e,t){try{if(c.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),c.isString(t)){i.filename=e;var r,s=i(t,a,n),d=0;if(s.imports)for(;d<s.imports.length;++d)(r=u(s.imports[d])||a.resolvePath(e,s.imports[d]))&&f(r);if(s.weakImports)for(d=0;d<s.weakImports.length;++d)(r=u(s.weakImports[d])||a.resolvePath(e,s.weakImports[d]))&&f(r,!0)}else a.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}o||p||l(null,a)}function f(e,t){if(e=u(e)||e,!(a.files.indexOf(e)>-1)){if(a.files.push(e),e in s){o?d(e,s[e]):(++p,setTimeout(function(){--p,d(e,s[e])}));return}if(o){var n;try{n=c.fs.readFileSync(e).toString("utf8")}catch(e){t||l(e);return}d(e,n)}else++p,a.fetch(e,function(n,i){if(--p,r){if(n){t?p||l(null,a):l(n);return}d(e,i)}})}}var p=0;c.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=a.resolvePath("",t[g]))&&f(m);if(o)return a;p||l(null,a)},d.prototype.loadSync=function(e,t){if(!c.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return a.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new o(t.fullName,t.id,t.type,t.rule,void 0,t.options);return!!n.get(r.name)||(r.declaringField=t,t.extensionField=r,n.add(r),!0)}return!1}d.prototype._handleAdd=function(e){if(e instanceof o)void 0===e.extend||e.extensionField||p(this,e)||this.deferred.push(e);else if(e instanceof l)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof u)){if(e instanceof r)for(var t=0;t<this.deferred.length;)p(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);f.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof o){if(void 0!==e.extend){if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}}else if(e instanceof l)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof a){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);f.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,n){r=e,i=t,s=n}},59694:e=>{"use strict";e.exports={}},84774:(e,t,n)=>{"use strict";t.Service=n(83829)},83829:(e,t,n)=>{"use strict";e.exports=i;var r=n(90745);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!n}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,s,a){if(!s)throw TypeError("request must be specified");var o=this;if(!a)return r.asPromise(e,o,t,n,i,s);if(!o.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return o.rpcImpl(t,n[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(e,n){if(e)return o.emit("error",e,t),a(e);if(null===n){o.end(!0);return}if(!(n instanceof i))try{n=i[o.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return o.emit("error",e,t),a(e)}return o.emit("data",n,t),a(null,n)})}catch(e){o.emit("error",e,t),setTimeout(function(){a(e)},0);return}},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},31631:(e,t,n)=>{"use strict";e.exports=o;var r=n(4943);((o.prototype=Object.create(r.prototype)).constructor=o).className="Service";var i=n(26539),s=n(84615),a=n(84774);function o(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}o.fromJSON=function(e,t){var n=new o(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),s=0;s<r.length;++s)n.add(i.fromJSON(r[s],t.methods[r[s]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},o.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&!!e.keepComments;return s.toObject(["options",t&&t.options||void 0,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(o.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),o.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},o.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},o.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,l(this)):r.prototype.add.call(this,e)},o.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return r.prototype.remove.call(this,e)},o.prototype.create=function(e,t,n){for(var r,i=new a.Service(e,t,n),o=0;o<this.methodsArray.length;++o){var l=s.lcFirst((r=this._methodsArray[o]).resolve().name).replace(/[^$\w_]/g,"");i[l]=s.codegen(["r","c"],s.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return i}},99867:e=>{"use strict";e.exports=d;var t=/[\s{}=;:[\],'"()<>]/g,n=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,r=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,i=/^ *[*/]+ */,s=/^\s*\*?\/*/,a=/\n/g,o=/\s/,l=/\\(.?)/g,u={0:"\0",r:"\r",n:"\n",t:"	"};function c(e){return e.replace(l,function(e,t){switch(t){case"\\":case"":return t;default:return u[t]||""}})}function d(e,l){e=e.toString();var u=0,d=e.length,h=1,f=0,p={},m=[],g=null;function y(e){return Error("illegal "+e+" (line "+h+")")}function v(){var t="'"===g?r:n;t.lastIndex=u-1;var i=t.exec(e);if(!i)throw y("string");return u=t.lastIndex,E(g),g=null,c(i[1])}function b(t){return e.charAt(t)}function w(t,n,r){var o,u,c={type:e.charAt(t++),lineEmpty:!1,leading:r},d=t-(o=l?2:3);do if(--d<0||"\n"===(u=e.charAt(d))){c.lineEmpty=!0;break}while(" "===u||"	"===u);for(var m=e.substring(t,n).split(a),g=0;g<m.length;++g)m[g]=m[g].replace(l?s:i,"").trim();c.text=m.join("\n").trim(),p[h]=c,f=h}function S(t){var n=T(t),r=e.substring(t,n);return/^\s*\/\//.test(r)}function T(e){for(var t=e;t<d&&"\n"!==b(t);)t++;return t}function C(){if(m.length>0)return m.shift();if(g)return v();var n,r,i,s,a,c=0===u;do{if(u===d)return null;for(n=!1;o.test(i=b(u));)if("\n"===i&&(c=!0,++h),++u===d)return null;if("/"===b(u)){if(++u===d)throw y("comment");if("/"===b(u)){if(l){if(s=u,a=!1,S(u-1)){a=!0;do if((u=T(u))===d||(u++,!c))break;while(S(u))}else u=Math.min(d,T(u)+1);a&&(w(s,u,c),c=!0),h++,n=!0}else{for(a="/"===b(s=u+1);"\n"!==b(++u);)if(u===d)return null;++u,a&&(w(s,u-1,c),c=!0),++h,n=!0}}else{if("*"!==(i=b(u)))return"/";s=u+1,a=l||"*"===b(s);do{if("\n"===i&&++h,++u===d)throw y("comment");r=i,i=b(u)}while("*"!==r||"/"!==i);++u,a&&(w(s,u-2,c),c=!0),n=!0}}}while(n);var f=u;if(t.lastIndex=0,!t.test(b(f++)))for(;f<d&&!t.test(b(f));)++f;var p=e.substring(u,u=f);return('"'===p||"'"===p)&&(g=p),p}function E(e){m.push(e)}function x(){if(!m.length){var e=C();if(null===e)return null;E(e)}return m[0]}function _(e,t){var n=x();if(n===e)return C(),!0;if(!t)throw y("token '"+n+"', '"+e+"' expected");return!1}function I(e){var t,n=null;return void 0===e?(t=p[h-1],delete p[h-1],t&&(l||"*"===t.type||t.lineEmpty)&&(n=t.leading?t.text:null)):(f<e&&x(),t=p[e],delete p[e],t&&!t.lineEmpty&&(l||"/"===t.type)&&(n=t.leading?null:t.text)),n}return Object.defineProperty({next:C,peek:x,push:E,skip:_,cmnt:I},"line",{get:function(){return h}})}d.unescape=c},3839:(e,t,n)=>{"use strict";e.exports=v;var r=n(4943);((v.prototype=Object.create(r.prototype)).constructor=v).className="Type";var i=n(71114),s=n(92695),a=n(37510),o=n(79538),l=n(31631),u=n(92936),c=n(42279),d=n(98458),h=n(84615),f=n(38455),p=n(31526),m=n(91506),g=n(85711),y=n(39579);function v(e,t){r.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof u||((e.prototype=new u).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,u,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:h.oneOfGetter(this._oneofsArray[n].oneof),set:h.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,r)}}}),v.generateConstructor=function(e){for(var t,n=h.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?n("this%s={}",h.safeProp(t.name)):t.repeated&&n("this%s=[]",h.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},v.fromJSON=function(e,t){var n=new v(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var u=Object.keys(t.fields),c=0;c<u.length;++c)n.add((void 0!==t.fields[u[c]].keyType?o.fromJSON:a.fromJSON)(u[c],t.fields[u[c]]));if(t.oneofs)for(u=Object.keys(t.oneofs),c=0;c<u.length;++c)n.add(s.fromJSON(u[c],t.oneofs[u[c]]));if(t.nested)for(u=Object.keys(t.nested),c=0;c<u.length;++c){var d=t.nested[u[c]];n.add((void 0!==d.id?a.fromJSON:void 0!==d.fields?v.fromJSON:void 0!==d.values?i.fromJSON:void 0!==d.methods?l.fromJSON:r.fromJSON)(u[c],d))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},v.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&!!e.keepComments;return h.toObject(["options",t&&t.options||void 0,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter(function(e){return!e.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},v.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return r.prototype.resolveAll.call(this)},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):r.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return r.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=f(this)({Writer:d,types:t,util:h}),this.decode=p(this)({Reader:c,types:t,util:h}),this.verify=m(this)({types:t,util:h}),this.fromObject=g.fromObject(this)({types:t,util:h}),this.toObject=g.toObject(this)({types:t,util:h});var r=y[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(i),i.toObject=this.toObject,this.toObject=r.toObject.bind(i)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof c||(e=c.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){h.decorateType(t,e)}}},76160:(e,t,n)=>{"use strict";var r=t,i=n(84615),s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var n=0,r={};for(t|=0;n<e.length;)r[s[n+t]]=e[n++];return r}r.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),r.long=a([0,0,0,1,1],7),r.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},84615:(e,t,n)=>{"use strict";var r,i,s=e.exports=n(90745),a=n(59694);s.codegen=n(696),s.fetch=n(37828),s.path=n(62727),s.fs=s.inquire("fs"),s.toArray=function(e){if(e){for(var t=Object.keys(e),n=Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},s.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],i=e[n++];void 0!==i&&(t[r]=i)}return t};var o=/\\/g,l=/"/g;s.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},s.safeProp=function(e){return!/^[$\w_]+$/.test(e)||s.isReserved(e)?'["'+e.replace(o,"\\\\").replace(l,'\\"')+'"]':"."+e},s.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var u=/_([a-z])/g;s.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(u,function(e,t){return t.toUpperCase()})},s.compareFieldsById=function(e,t){return e.id-t.id},s.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(s.decorateRoot.remove(e.$type),e.$type.name=t,s.decorateRoot.add(e.$type)),e.$type;r||(r=n(3839));var i=new r(t||e.name);return s.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var c=0;s.decorateEnum=function(e){if(e.$type)return e.$type;i||(i=n(71114));var t=new i("Enum"+c++,e);return s.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},s.setProperty=function(e,t,n){function r(e,t,n){var i=t.shift();if("__proto__"===i||"prototype"===i)return e;if(t.length>0)e[i]=r(e[i]||{},t,n);else{var s=e[i];s&&(n=[].concat(s).concat(n)),e[i]=n}return e}if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return r(e,t=t.split("."),n)},Object.defineProperty(s,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(n(54343)))}})},33674:(e,t,n)=>{"use strict";e.exports=i;var r=n(90745);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=i.zero=new i(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):s},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var o=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?s:new i((o.call(e,0)|o.call(e,1)<<8|o.call(e,2)<<16|o.call(e,3)<<24)>>>0,(o.call(e,4)|o.call(e,5)<<8|o.call(e,6)<<16|o.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},90745:function(e,t,n){"use strict";var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function s(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:Error().stack||""}),n&&i(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=n(61417),r.base64=n(75386),r.EventEmitter=n(33478),r.float=n(65256),r.inquire=n(71374),r.utf8=n(93670),r.pool=n(26733),r.LongBits=n(33674),r.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),r.global=r.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!!(null!=n&&e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(!!t)},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=s,r.ProtocolError=s("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;if(!e){r._Buffer_from=r._Buffer_allocUnsafe=null;return}r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}}},91506:(e,t,n)=>{"use strict";e.exports=l;var r=n(71114),i=n(84615);function s(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,n,i){if(t.resolvedType){if(t.resolvedType instanceof r){e("switch(%s){",i)("default:")("return%j",s(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),o=0;o<a.length;++o)e("case %i:",t.resolvedType.values[a[o]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,i)("if(e)")("return%j+e",t.name+".")("}")}else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",s(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",s(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",s(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",s(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",s(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",s(t,"buffer"))}return e}function o(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",s(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",s(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",s(t,"boolean key"))}return e}function l(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n=e.oneofsArray,r={};n.length&&t("var p={}");for(var l=0;l<e.fieldsArray.length;++l){var u=e._fieldsArray[l].resolve(),c="m"+i.safeProp(u.name);if(u.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",c,u.name),u.map)t("if(!util.isObject(%s))",c)("return%j",s(u,"object"))("var k=Object.keys(%s)",c)("for(var i=0;i<k.length;++i){"),o(t,u,"k[i]"),a(t,u,l,c+"[k[i]]")("}");else if(u.repeated)t("if(!Array.isArray(%s))",c)("return%j",s(u,"array"))("for(var i=0;i<%s.length;++i){",c),a(t,u,l,c+"[i]")("}");else{if(u.partOf){var d=i.safeProp(u.partOf.name);1===r[u.partOf.name]&&t("if(p%s===1)",d)("return%j",u.partOf.name+": multiple values"),r[u.partOf.name]=1,t("p%s=1",d)}a(t,u,l,c)}u.optional&&t("}")}return t("return null")}},39579:(e,t,n)=>{"use strict";var r=t,i=n(92936);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),n=this.lookup(t);if(n){var r="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return -1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="type.googleapis.com/",r="",s="";if(t&&t.json&&e.type_url&&e.value){s=e.type_url.substring(e.type_url.lastIndexOf("/")+1),r=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var a=this.lookup(s);a&&(e=a.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var o=e.$type.toObject(e,t),l="."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName;return""===r&&(r=n),s=r+l,o["@type"]=s,o}return this.toObject(e,t)}}},98458:(e,t,n)=>{"use strict";e.exports=d;var r,i=n(90745),s=i.LongBits,a=i.base64,o=i.utf8;function l(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}var h=function(){return i.Buffer?function(){return(d.create=function(){return new r})()}:function(){return new d}};function f(e,t,n){t[n]=255&e}function p(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function m(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=h(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new l(e,t,n),this.len+=t,this},m.prototype=Object.create(l.prototype),m.prototype.fn=p,d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new m((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(g,10,s.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=s.from(e);return this._push(g,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(g,t.length(),t)},d.prototype.bool=function(e){return this._push(f,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=s.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var v=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var n=d.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(v,t,e)},d.prototype.string=function(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(f,1,0)},d.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){r=e,d.create=h(),r._configure()}},68386:(e,t,n)=>{"use strict";e.exports=s;var r=n(98458);(s.prototype=Object.create(r.prototype)).constructor=s;var i=n(90745);function s(){r.call(this)}function a(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}s._configure=function(){s.alloc=i._Buffer_allocUnsafe,s.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},s.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},s._configure()},11506:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s,metadata:()=>i});var r=n(19510);n(67272);let i={title:"Katy Silva Nail Designer",description:"Agendamento de servi\xe7os",icons:{icon:"/favicon.ico"}};function s({children:e}){return r.jsx("html",{lang:"pt-BR",children:r.jsx("body",{children:e})})}},90908:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r=(0,n(68570).createProxy)(String.raw`C:\Users\04jee\meu-salao-de-beleza\app\page.tsx#default`)},67272:()=>{},90029:(e,t)=>{var n,r=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}function i(e){var t=Math.clz32(e&-e);return e?31-t:t}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var s={},a={};function o(e,t){var n,r,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(r=a[e]))?r:(n=u(e,0,!0),i&&(a[e]=n),n):(e|=0,(i=-128<=e&&e<128)&&(r=s[e]))?r:(n=u(e,e<0?-1:0,!1),i&&(s[e]=n),n)}function l(e,t){if(isNaN(e))return t?v:y;if(t){if(e<0)return v;if(e>=p)return C}else{if(e<=-m)return E;if(e+1>=m)return T}return e<0?l(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=l,n.fromBits=u;var c=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?v:y;if((n=n||10)<2||36<n)throw RangeError("radix");if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return d(e.substring(1),t,n).neg();for(var r,i=l(c(n,8)),s=y,a=0;a<e.length;a+=8){var o=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+o),n);if(o<8){var h=l(c(n,o));s=s.mul(h).add(l(u))}else s=(s=s.mul(i)).add(l(u))}return s.unsigned=t,s}function h(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?d(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=d,n.fromValue=h;var f=4294967296,p=18446744073709552e3,m=0x7fffffffffffffff,g=o(16777216),y=o(0);n.ZERO=y;var v=o(0,!0);n.UZERO=v;var b=o(1);n.ONE=b;var w=o(1,!0);n.UONE=w;var S=o(-1);n.NEG_ONE=S;var T=u(-1,2147483647,!1);n.MAX_VALUE=T;var C=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=C;var E=u(0,-2147483648,!1);n.MIN_VALUE=E;var x=n.prototype;x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},x.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(E))return"-"+this.neg().toString(e);var t=l(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}for(var i=l(c(e,6),this.unsigned),s=this,a="";;){var o=s.div(i),u=(s.sub(o.mul(i)).toInt()>>>0).toString(e);if((s=o).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},x.isZero=function(){return 0===this.high&&0===this.low},x.eqz=x.isZero,x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return(1&this.low)==1},x.isEven=function(){return(1&this.low)==0},x.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},x.eq=x.equals,x.notEquals=function(e){return!this.eq(e)},x.neq=x.notEquals,x.ne=x.notEquals,x.lessThan=function(e){return 0>this.comp(e)},x.lt=x.lessThan,x.lessThanOrEqual=function(e){return 0>=this.comp(e)},x.lte=x.lessThanOrEqual,x.le=x.lessThanOrEqual,x.greaterThan=function(e){return this.comp(e)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(e){return this.comp(e)>=0},x.gte=x.greaterThanOrEqual,x.ge=x.greaterThanOrEqual,x.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(b)},x.neg=x.negate,x.add=function(e){r(e)||(e=h(e));var t,n,i=this.high>>>16,s=65535&this.high,a=this.low>>>16,o=65535&this.low,l=e.high>>>16,c=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,m=0;return t=0+((n=0+(o+f))>>>16),n&=65535,t+=a+d,m+=t>>>16,t&=65535,m+=s+c,p+=m>>>16,m&=65535,p+=i+l,u(t<<16|n,(p&=65535)<<16|m,this.unsigned)},x.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},x.sub=x.subtract,x.multiply=function(e){if(this.isZero())return this;if(r(e)||(e=h(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?v:y;if(this.eq(E))return e.isOdd()?E:y;if(e.eq(E))return this.isOdd()?E:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return l(this.toNumber()*e.toNumber(),this.unsigned);var n,i,s=this.high>>>16,a=65535&this.high,o=this.low>>>16,c=65535&this.low,d=e.high>>>16,f=65535&e.high,p=e.low>>>16,m=65535&e.low,b=0,w=0;return n=0+((i=0+c*m)>>>16),i&=65535,n+=o*m,w+=n>>>16,n&=65535,n+=c*p,w+=n>>>16,n&=65535,w+=a*m,b+=w>>>16,w&=65535,w+=o*p,b+=w>>>16,w&=65535,w+=c*f,b+=w>>>16,w&=65535,b+=s*m+a*p+o*f+c*d,u(n<<16|i,(b&=65535)<<16|w,this.unsigned)},x.mul=x.multiply,x.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");if(t){var n,i,s;return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?v:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return w;s=v}else{if(this.eq(E))return e.eq(b)||e.eq(S)?E:e.eq(E)?b:(n=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?b:S:(i=this.sub(e.mul(n)),s=n.add(i.div(e)));if(e.eq(E))return this.unsigned?v:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=y}for(i=this;i.gte(e);){for(var a=Math.ceil(Math.log(n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())))/Math.LN2),o=a<=48?1:c(2,a-48),d=l(n),f=d.mul(e);f.isNegative()||f.gt(i);)n-=o,f=(d=l(n,this.unsigned)).mul(e);d.isZero()&&(d=b),s=s.add(d),i=i.sub(f)}return s},x.div=x.divide,x.modulo=function(e){return(r(e)||(e=h(e)),t)?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},x.mod=x.modulo,x.rem=x.modulo,x.not=function(){return u(~this.low,~this.high,this.unsigned)},x.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},x.clz=x.countLeadingZeros,x.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},x.ctz=x.countTrailingZeros,x.and=function(e){return r(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},x.or=function(e){return r(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},x.xor=function(e){return r(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},x.shiftLeft=function(e){return(r(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(e){return(r(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(e){return(r(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):32===e?u(this.high,0,this.unsigned):u(this.high>>>e-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.shr_u=x.shiftRightUnsigned,x.rotateLeft=function(e){var t;return(r(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?u(this.high,this.low,this.unsigned):e<32?(t=32-e,u(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,u(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},x.rotl=x.rotateLeft,x.rotateRight=function(e){var t;return(r(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?u(this.high,this.low,this.unsigned):e<32?(t=32-e,u(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,u(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},x.rotr=x.rotateRight,x.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},x.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},x.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var _=n;return e.default=_,"default"in e?e.default:e}({});void 0!==(n=(function(){return r}).apply(t,[]))&&(e.exports=n)},81513:e=>{"use strict";e.exports={i8:"1.9.15"}},56541:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},89987:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"FileDescriptorSet":{"fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}}},"FileDescriptorProto":{"fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10,"options":{"packed":false}},"weakDependency":{"rule":"repeated","type":"int32","id":11,"options":{"packed":false}},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12}}},"DescriptorProto":{"fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"FieldDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REQUIRED":2,"LABEL_REPEATED":3}}}},"OneofDescriptorProto":{"fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3}}},"EnumValueDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[38,38]],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[8,8]]},"FieldOptions":{"fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}}}},"OneofOptions":{"fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumValueOptions":{"fields":{"deprecated":{"type":"bool","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"UninterpretedOption":{"fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"SourceCodeInfo":{"fields":{"location":{"rule":"repeated","type":"Location","id":1}},"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"span":{"rule":"repeated","type":"int32","id":2},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4}}}}}}}}}}}')},57674:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},73795:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')}};var __webpack_require__=require("../webpack-runtime.js");__webpack_require__.C(exports);var __webpack_exec__=e=>__webpack_require__(__webpack_require__.s=e),__webpack_exports__=__webpack_require__.X(0,[276,471,981],()=>__webpack_exec__(49114));module.exports=__webpack_exports__})();